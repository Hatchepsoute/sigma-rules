# CVE-2025-64671 ‚Äì Ex√©cution de commandes suspectes lanc√©es par un IDE (R√®gle Sigma)

## Statut
- **Exp√©rimental**
- D√©tection √† forte valeur SOC

---

## Pr√©sentation

Cette r√®gle d√©tecte **l‚Äôex√©cution de commandes suspectes lanc√©es par un environnement de d√©veloppement int√©gr√© (IDE)** tel que **IntelliJ IDEA, PyCharm, WebStorm ou VS Code**.

Elle est align√©e avec **CVE-2025-64671 (CWE-77 ‚Äì Injection de commandes)**, o√π des **m√©tadonn√©es ou noms de fichiers malveillants** peuvent d√©clencher une **ex√©cution silencieuse de commandes via des plugins IDE**, entra√Ænant une **RCE locale**.

Cette r√®gle vise √† offrir aux SOC une **visibilit√© sur les postes d√©veloppeurs**, souvent peu surveill√©s mais critiques.

---

## Contexte de menace

Les IDE modernes utilisent :
- Des plugins tiers
- L‚Äôindexation automatique des projets
- L‚Äôanalyse de noms de fichiers et m√©tadonn√©es

Dans le cadre de **CVE-2025-64671**, un attaquant peut :
1. Publier un d√©p√¥t ou projet malveillant
2. Injecter des noms de fichiers pi√©g√©s
3. Inciter un d√©veloppeur √† ouvrir le projet
4. D√©clencher une **injection de commandes**
5. Ex√©cuter du code √† l‚Äôinsu de l‚Äôutilisateur

üëâ Les **postes d√©veloppeurs deviennent alors des cibles critiques**.

---

## Ce que d√©tecte la r√®gle

### Processus parent (IDE)
La r√®gle surveille les cha√Ænes d‚Äôex√©cution o√π le **processus parent est un IDE**, notamment :
- `idea64.exe` (IntelliJ IDEA)
- `pycharm64.exe`
- `webstorm64.exe`
- `code.exe` (VS Code)

### Processus enfant (Shell)
Elle d√©tecte les **interpr√©teurs de commandes** lanc√©s par l‚ÄôIDE :
- `cmd.exe`
- `powershell.exe` / `pwsh.exe`
- `bash.exe`
- `wsl.exe`

### Indicateurs de commandes suspectes
Pour limiter les faux positifs, la r√®gle exige des **patterns explicites**, tels que :
- Outils r√©seau (`curl`, `wget`, `scp`, `nc`)
- T√©l√©chargement distant (`Invoke-WebRequest`, `iwr`)
- Acc√®s √† des fichiers sensibles (`.ssh`, `.env`)

### Condition de d√©tection
L‚Äôalerte se d√©clenche **uniquement si les trois conditions sont r√©unies** :
- IDE ‚Üí Shell
- Commandes suspectes
- Journaux de cr√©ation de processus Windows

---

## Interpr√©tation SOC

Lorsqu‚Äôune alerte est lev√©e, cela signifie :

> **Un IDE a lanc√© un shell pour ex√©cuter des commandes potentiellement malveillantes.**

Ce comportement est **anormal en arri√®re‚Äëplan** et doit √™tre consid√©r√© comme **√† haut risque**.

---

## R√¥le de cette r√®gle pour les analystes SOC

Cette r√®gle permet de :
- D√©tecter une **RCE silencieuse sur poste d√©veloppeur**
- Surveiller les **attaques supply‚Äëchain**
- Identifier l‚Äôabus d‚Äôoutils de confiance (IDE)
- R√©duire le temps de pr√©sence d‚Äôun attaquant

Elle est particuli√®rement pertinente pour :
- √âquipes de d√©veloppement
- Postes CI/CD
- Organisations avec R&D interne

---

## Faux positifs possibles

- D√©veloppeur ouvrant volontairement un terminal depuis l‚ÄôIDE
- Scripts de d√©veloppement ex√©cut√©s intentionnellement

### Recommandation analyste
Toujours v√©rifier :
- Le contexte de la commande
- L‚Äôintention utilisateur
- La provenance du projet

---

## Actions SOC recommand√©es

1. Identifier le poste d√©veloppeur impact√©
2. Analyser le projet ou d√©p√¥t r√©cemment ouvert
3. Examiner les commandes ex√©cut√©es et le trafic r√©seau
4. Isoler le poste si n√©cessaire
5. R√©initialiser les secrets expos√©s

---

## Pourquoi cette r√®gle est critique

> Les IDE sont des applications de confiance.  
> Leur d√©tournement constitue un vecteur d‚Äôattaque majeur.

Cette r√®gle apporte une **visibilit√© essentielle sur une surface d‚Äôattaque rarement monitor√©e mais √† fort impact**.

---

**Author:** Adama Assiongbon  
**Role:** SOC & CTI Analyst  
**LinkedIn:** https://www.linkedin.com/in/adama-assiongbon-9029893a/  
**Derni√®re mise √† jour :** 2025-12-24
