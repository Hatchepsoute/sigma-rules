# TheHive + Cortex Automated Playbook
# CVE-2025-64671 â€“ IDE Command Injection (Automated)
# Author: Adama Assiongbon
# Last Update: 2025-12-24

playbook:
  name: CVE-2025-64671_IDE_Command_Injection_AUTOMATED
  description: >
    Automated SOAR playbook using TheHive and Cortex
    to respond to suspicious IDE-spawned command execution.
  version: 1.1
  severity: high
  tlp: amber

  trigger:
    type: alert
    source: SIEM
    rule_name: cve-2025-64671_ide_command_injection_suspicious_exec

  automation:
    enabled: true

  steps:
    - id: enrich_process
      name: Enrich Process Tree
      cortex:
        analyzer: ProcessTree
        target: endpoint

    - id: enrich_network
      name: Network IOC Enrichment
      cortex:
        analyzer: VirusTotal_GetReport
        target: ip

    - id: command_analysis
      name: Analyze Command Line
      cortex:
        analyzer: Regex_Command_Detection
        target: command_line

    - id: decision
      name: Automated Decision Gate
      condition:
        if:
          - suspicious_command: true
          - external_network: true
      actions:
        - tag_alert: confirmed_exploitation
        - set_severity: critical

    - id: containment
      name: Automated Containment
      condition:
        if_tag_present: confirmed_exploitation
      actions:
        - edr_isolate_endpoint
        - firewall_block_destination_ip

    - id: notification
      name: Notify SOC & Dev Team
      actions:
        - send_slack_alert
        - create_incident_ticket

    - id: closure
      name: Close or Escalate
      condition:
        if_false_positive: true
      actions:
        - close_alert
        - add_comment: Legitimate developer activity confirmed

