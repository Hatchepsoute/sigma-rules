# TheHive Playbook
# Title: CVE-2025-64671 – IDE Command Injection Response
# Purpose: SOC response workflow for suspicious command execution spawned by IDEs
# Author: Adama Assiongbon
# Last Update: 2025-12-24

playbook:
  name: CVE-2025-64671_IDE_Command_Injection_Response
  description: >
    This playbook guides SOC analysts through investigation and response
    when a Sigma rule detects suspicious command execution spawned by an IDE
    (CVE-2025-64671 – Command Injection).
  version: 1.0
  severity: high
  tlp: amber

  trigger:
    type: alert
    source: SIEM
    condition:
      - rule_name: cve-2025-64671_ide_command_injection_suspicious_exec

  steps:
    - id: triage
      name: Initial Triage
      description: >
        Validate alert context and confirm IDE → shell execution chain.
      actions:
        - check_parent_process: IDE process (idea64.exe, pycharm64.exe, code.exe)
        - check_child_process: cmd.exe / powershell.exe / bash.exe
        - validate_command_line: network or sensitive file access

    - id: enrichment
      name: Context Enrichment
      description: >
        Enrich alert with host, user, and command execution context.
      actions:
        - collect_host_details
        - collect_user_activity
        - extract_command_line
        - timeline_process_tree

    - id: scope
      name: Scope Assessment
      description: >
        Determine if exploitation is isolated or part of broader activity.
      actions:
        - search_similar_alerts: last_24h
        - check_network_connections
        - check_file_downloads

    - id: containment
      name: Containment Decision
      description: >
        Decide containment actions based on confidence level.
      condition:
        if_confirmed_malicious: true
      actions:
        - isolate_endpoint
        - disable_user_account: optional
        - block_outbound_connections

    - id: investigation
      name: Deep Investigation
      description: >
        Investigate potential exploitation source and impact.
      actions:
        - review_recent_projects
        - inspect_repository_origin
        - check_ide_plugins
        - hunt_for_persistence

    - id: remediation
      name: Remediation
      description: >
        Remove malicious artifacts and reduce attack surface.
      actions:
        - remove_malicious_project
        - uninstall_suspicious_plugins
        - patch_ide
        - reset_exposed_credentials

    - id: recovery
      name: Recovery & Lessons Learned
      description: >
        Restore normal operations and document findings.
      actions:
        - reimage_endpoint_if_needed
        - close_alert
        - update_detection_rules
        - document_incident

