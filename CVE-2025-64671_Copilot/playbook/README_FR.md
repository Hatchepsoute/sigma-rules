# CVE-2025-64671 – Playbook TheHive (Injection de commandes via IDE)

## Objectif

Ce playbook fournit un **workflow SOC structuré** pour traiter les alertes déclenchées par la règle Sigma :

`cve-2025-64671_ide_command_injection_suspicious_exec`

Il permet aux équipes SOC de **qualifier, confirmer et répondre** à une exploitation potentielle de **CVE-2025-64671**, une vulnérabilité d’injection de commandes exploitée via des chaînes d’exécution IDE.

---

## Périmètre

- Cible : **Postes développeurs / hôtes CI-CD**
- Plateforme : **Windows**
- Niveau SOC : **L1 → L3**
- SOAR : **TheHive (versions manuelle & automatisée)**

---

## Contexte de détection

Le playbook est déclenché lorsqu’un **IDE** (IntelliJ, PyCharm, VS Code, etc.) lance un **interpréteur de commandes** (`cmd.exe`, `powershell.exe`, `bash.exe`) avec des paramètres suspects.

Ce comportement peut indiquer :
- Une injection de commandes via IDE
- Un dépôt ou projet malveillant
- Une attaque supply-chain
- Une RCE locale silencieuse

---

## Versions du playbook

### 1️⃣ Playbook TheHive manuel
- Investigation guidée par l’analyste
- Étapes SOC progressives
- Adapté aux environnements sans automatisation

### 2️⃣ Playbook TheHive + Cortex automatisé
- Enrichissement automatique (processus, réseau)
- Décisions conditionnelles
- Containment automatisé (EDR / pare-feu)
- Notifications et création d’incident

Les deux versions reposent sur **la même logique décisionnelle**.

---

## Workflow SOC (vue d’ensemble)

1. Réception de l’alerte SIEM
2. Triage initial (validation IDE → Shell)
3. Enrichissement du contexte (hôte, utilisateur, commande)
4. Évaluation du périmètre (réseau, fichiers, persistance)
5. Décision de confinement
6. Actions de remédiation
7. Clôture & retour d’expérience

---

## Recommandations analyste SOC

- Une exécution **IDE → Shell** n’est **pas un comportement normal**
- Toujours confirmer l’intention du développeur
- Les postes CI/CD sont des **actifs critiques**
- Corréler systématiquement avec l’activité réseau

---

## Entrées & sorties

### Entrées
- Alerte SIEM
- Logs de création de processus
- Arguments en ligne de commande
- Télémétrie réseau (si disponible)

### Sorties
- Faux positif confirmé
- Incident de sécurité
- Confinement du poste
- Amélioration des règles

---

## Bonnes pratiques

- Utiliser conjointement la table de décision SOC
- Corréler avec des règles Sigma BROAD / STRICT
- Documenter chaque étape dans TheHive
- Ajuster les règles selon le contexte réel

---

**CVE associée :** CVE-2025-64671  
**Maintenu par :** Adama Assiongbon  
**Rôle :** SOC & CTI Analyst  
**Dernière mise à jour :** 2025-12-24
