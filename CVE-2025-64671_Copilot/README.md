# CVE-2025-64671 â€“ Suspicious Command Execution Spawned by IDE (Sigma Rule)
[ðŸ‘‰ðŸ¾ **French version available here**](./README_FR.md)
## Status
- **Experimental**
- High-value detection for SOC monitoring

---

## Overview

This rule detects **suspicious command execution spawned by an Integrated Development Environment (IDE)** such as **IntelliJ IDEA, PyCharm, WebStorm, or VS Code**.

The detection is aligned with **CVE-2025-64671 (CWE-77 â€“ Command Injection)**, where malicious project metadata or filenames can trigger **silent command execution via IDE plugins**, leading to **local Remote Code Execution (RCE)** without explicit user intent.

This rule is designed to help SOC analysts **detect early exploitation or abuse of developer workstations**.

---

## Threat Context

Modern software development environments rely heavily on:
- IDE plugins
- Automatic project indexing
- Filename and metadata parsing

In the context of **CVE-2025-64671**, attackers may:
1. Publish a malicious repository or project
2. Embed crafted filenames or metadata
3. Trick a developer into opening the project
4. Trigger **command injection** inside the IDE
5. Execute OS commands silently

This makes **developer endpoints a highâ€‘value target**.

---

## What the Rule Detects
[cve-2025-64671_ide_command_injection_suspicious_exec.yml](./rules/cve-2025-64671_ide_command_injection_suspicious_exec.yml)
### Parent Process (IDE)
The rule monitors execution chains where the **parent process is an IDE**, including:
- `idea64.exe` (IntelliJ IDEA)
- `pycharm64.exe`
- `webstorm64.exe`
- `code.exe` (VS Code)

### Child Process (Shell)
The rule looks for **shells or command interpreters** spawned by the IDE:
- `cmd.exe`
- `powershell.exe` / `pwsh.exe`
- `bash.exe`
- `wsl.exe`

### Suspicious Command Indicators
To reduce false positives, the rule requires **explicit suspicious command patterns**, such as:
- Network utilities (`curl`, `wget`, `scp`, `nc`)
- Remote downloads (`Invoke-WebRequest`, `iwr`)
- Sensitive file access (`.ssh`, `.env`)

### Detection Condition
The alert triggers **only if all three conditions are met**:
- IDE â†’ Shell execution
- Suspicious command usage
- Windows process creation telemetry

---

## SOC Interpretation

When this rule triggers, it indicates:

> **An IDE process has spawned a shell to execute potentially malicious commands.**

This behavior is **not normal for background IDE operations** and should be treated as **highâ€‘risk**.

---

## Role of This Rule for SOC Analysts

This rule helps SOC teams to:
- Detect **silent RCE on developer workstations**
- Monitor **supplyâ€‘chain attack paths**
- Identify **abuse of trusted developer tools**
- Reduce dwell time in highâ€‘impact environments

It is especially relevant for:
- Engineering teams
- CI/CD workstations
- Organizations with internal development teams

---

## False Positives

Possible false positives include:
- Developers intentionally opening a terminal from the IDE
- Legitimate development scripts executed manually

### Analyst Recommendation
Always validate:
- Command context
- User intent
- Project source (trusted vs untrusted)

---

## Recommended SOC Actions

1. Identify the affected developer workstation
2. Inspect the project/repository recently opened
3. Review executed commands and network activity
4. Isolate the endpoint if malicious behavior is confirmed
5. Reset credentials if sensitive files were accessed

---

## Why This Rule Matters

> IDEs are trusted applications.  
> When they become execution vectors, detection must be immediate.

This rule provides **critical visibility into a rarely monitored but highâ€‘impact attack surface**.

---

**Author :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

