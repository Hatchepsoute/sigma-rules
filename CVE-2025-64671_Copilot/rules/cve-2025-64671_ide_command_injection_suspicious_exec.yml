title: Suspicious command execution spawned by IDE (Possible CVE-2025-64671 Command Injection)
id: 3e8c5a1e-8c91-4b8f-a2d3-64671cwe77
status: experimental
description: >
  Detects suspicious command execution spawned by an IDE process (e.g. IntelliJ IDEA),consistent with command injection via untrusted project metadata or filenames.
  This behavior matches exploitation scenarios of CVE-2025-64671 (CWE-77), where IDE plugins process malicious filenames leading to silent RCE.
author: |-
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/

date: 2025-12-24
references:
  - https://cwe.mitre.org/data/definitions/77.html
  - https://nvd.nist.gov/vuln/detail/cve-2025-64671
tags:
  - attack.execution
  - attack.t1059
  - attack.supply_chain
  - cwe.77
  - cve.2025.64671
logsource:
  product: windows
  category: process_creation

detection:
  selection_parent_ide:
    ParentImage|contains:
      - '\\idea64.exe'
      - '\\idea.exe'
      - '\\code.exe'
      - '\\pycharm64.exe'
      - '\\webstorm64.exe'

  selection_child_shell:
    Image|endswith:
      - '\\cmd.exe'
      - '\\powershell.exe'
      - '\\pwsh.exe'
      - '\\bash.exe'
      - '\\wsl.exe'

  selection_suspicious_commands:
    CommandLine|contains:
      - '.ssh'
      - '.env'
      - 'curl '
      - 'wget '
      - 'Invoke-WebRequest'
      - 'iwr '
      - 'scp '
      - 'nc '
      - 'netcat'

  condition: selection_parent_ide and selection_child_shell and selection_suspicious_commands

falsepositives:
  - Legitimate developer actions explicitly launching shells from the IDE
  - Local development scripts executed intentionally

level: high

