title: Suspicious command execution spawned by IDE (Possible CVE-2025-64671 Command Injection)
id: aa4d3b2f-03f3-423e-aa76-874793880feb
status: experimental
description: >
  Detects suspicious command execution spawned by an IDE process (e.g. IntelliJ IDEA),consistent with command injection via untrusted project metadata or filenames. This behavior matches exploitation scenarios of CVE-2025-64671 (CWE-77), where IDE plugins process malicious filenames leading to silent RCE.
  
  FR=> Détecte l’exécution suspecte de commandes initiées par un processus d’IDE (par exemple IntelliJ IDEA), cohérente avec une injection de commandes via des métadonnées de projet ou des noms de fichiers non fiables. Ce comportement correspond à des scénarios d’exploitation de la CVE-2025-64671 (CWE-77), dans lesquels des plugins d’IDE traitent des noms de fichiers malveillants menant à une exécution de code à distance (RCE) silencieuse.
author: |-
  Adama Assiongbon (SOC/CTI Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025-12-24
references:
  - https://cwe.mitre.org/data/definitions/77.html
  - https://nvd.nist.gov/vuln/detail/cve-2025-64671
tags:
  - attack.execution
  - attack.t1059
  - attack.t1195
logsource:
  product: windows
  category: process_creation

detection:
  selection_parent_ide:
    ParentImage|contains:
      - '\\idea64.exe'
      - '\\idea.exe'
      - '\\code.exe'
      - '\\pycharm64.exe'
      - '\\webstorm64.exe'

  selection_child_shell:
    Image|endswith:
      - '\\cmd.exe'
      - '\\powershell.exe'
      - '\\pwsh.exe'
      - '\\bash.exe'
      - '\\wsl.exe'

  selection_suspicious_commands:
    CommandLine|contains:
      - '.ssh'
      - '.env'
      - 'curl '
      - 'wget '
      - 'Invoke-WebRequest'
      - 'iwr '
      - 'scp '
      - 'nc '
      - 'netcat'

  condition: selection_parent_ide and selection_child_shell and selection_suspicious_commands

falsepositives:
  - Legitimate developer actions explicitly launching shells from the IDE
  - Local development scripts executed intentionally

level: high
