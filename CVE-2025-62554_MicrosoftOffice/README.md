# CVE-2025-62554 – Microsoft Office LOLBins Execution (Sigma Detection)

## Status
- **Experimental**
- SOC detection & incident triage focused

---

## Overview

This directory provides **two correlated Sigma rules** designed to detect **post-exploitation behaviors associated with Microsoft Office client-side RCE chains**, including **CVE-2025-62554** (type confusion in Microsoft Office).

The rules follow the **sigma-rules detection philosophy**:
- **BROAD rule** for visibility and hunting
- **STRICT rule** for high-confidence alerting

They are intended to be **deployed together**.

---

## Threat Context

CVE-2025-62554 affects Microsoft Office and may lead to **arbitrary code execution in the user context** when a malicious document is opened.

After exploitation, attackers typically:
- Abuse **LOLBins** (PowerShell, cmd, mshta, rundll32, etc.)
- Download remote payloads
- Execute obfuscated or in-memory commands
- Move toward post-exploitation or ransomware deployment

Sigma rules cannot prove exploit success, but they reliably detect **dangerous post-execution behaviors**.

---

## Rule 1 – BROAD

### Name
**Office spawns LOLBIN (Possible Office RCE chain) – BROAD**

### Purpose
Detect abnormal **parent-child process relationships** where Microsoft Office launches a LOLBin or script engine.

### Detection Logic
- **Parent**: Microsoft Office processes
- **Child**: Common LOLBins / script engines
- **No command-line inspection**

### SOC Interpretation
- Suspicious behavior
- Not sufficient alone to confirm compromise
- Useful for **early detection and hunting**

### Recommended Usage
- SOC L1 / L2 triage
- Threat hunting
- Correlation baseline

---

## Rule 2 – STRICT

### Name
**Office spawns LOLBIN with suspicious download/execute patterns – STRICT**

### Purpose
Detect **explicit malicious intent** following Office exploitation.

### Detection Logic
- Office parent process
- LOLBin child process
- **AND** command-line indicators such as:
  - Payload download (HTTP/HTTPS, curl, wget, bitsadmin, certutil)
  - Obfuscation or in-memory execution (`-enc`, Base64, IEX)

### SOC Interpretation
- **High-confidence malicious activity**
- Likely exploitation or post-exploitation in progress

### Recommended Usage
- SOC L2 / L3 escalation
- Incident declaration
- SOAR / automated containment

---

## Correlation Strategy (Required)

These rules are designed to work **together**.

### Recommended Flow

1. **BROAD rule triggers**
   - Suspicious Office behavior detected
   - Analyst context established

2. **STRICT rule triggers**
   - Malicious intent confirmed
   - Incident escalated

This correlation:
- Reduces false positives
- Maintains early visibility

---

## SOC Comparison Table

| Criteria | BROAD | STRICT |
|------|------|------|
| Detection scope | Broad | Narrow |
| False positives | Possible | Rare |
| Confidence level | Medium | High |
| Command-line analysis | ❌ | ✅ |
| Payload download detection | ❌ | ✅ |
| Obfuscation detection | ❌ | ✅ |
| SOC usage | L1 / L2 | L2 / L3 |
| Incident-ready | ❌ | ✅ |

---

## Best Practice

> Always deploy **both rules together**.
>
> - BROAD = visibility & hunting  
> - STRICT = confirmation & response  
>
> This pairing provides robust detection coverage for **CVE-2025-62554 exploitation chains**.
