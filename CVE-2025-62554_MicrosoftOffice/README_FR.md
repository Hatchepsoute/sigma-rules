# CVE-2025-62554 â€“ ExÃ©cution de LOLBins via Microsoft Office (Sigma)
[ğŸ‘‰ğŸ¾ **English version available here**](./README.md)
## Statut
- **ExpÃ©rimental**
- AxÃ© dÃ©tection SOC et triage dâ€™incident

---

## PrÃ©sentation

Ce rÃ©pertoire contient **deux rÃ¨gles Sigma corrÃ©lÃ©es** destinÃ©es Ã  dÃ©tecter les **comportements post-exploitation liÃ©s aux chaÃ®nes RCE Microsoft Office**, notamment **CVE-2025-62554** (type confusion dans Microsoft Office).

Ces rÃ¨gles respectent la **philosophie sigma-rules** :
- Une rÃ¨gle **BROAD** pour la visibilitÃ©
- Une rÃ¨gle **STRICT** pour la confirmation

ğŸ‘‰ğŸ¾ Elles doivent Ãªtre **dÃ©ployÃ©es ensemble**.

---

## Contexte de menace

CVE-2025-62554 peut permettre une **exÃ©cution de code arbitraire dans le contexte utilisateur** lors de lâ€™ouverture dâ€™un document Office piÃ©gÃ©.

AprÃ¨s exploitation, les attaquants utilisent frÃ©quemment :
- Des **LOLBins** (PowerShell, cmd, mshta, rundll32â€¦)
- Le tÃ©lÃ©chargement de payloads distants
- Lâ€™exÃ©cution obfusquÃ©e ou en mÃ©moire
- La prÃ©paration de la post-exploitation ou dâ€™un ransomware

Sigma ne prouve pas lâ€™exploit, mais dÃ©tecte efficacement les **comportements Ã  haut risque**.

---

## RÃ¨gle 1 â€“ BROAD

### Nom
**Office lance un LOLBin (ChaÃ®ne RCE Office possible) â€“ BROAD**
[office_lolbin_spawn_broad_cve-2025-62554.yml](./rules/office_lolbin_spawn_broad_cve-2025-62554.yml)
### Objectif
DÃ©tecter une **relation parent-enfant anormale** oÃ¹ Microsoft Office lance un binaire systÃ¨me.

### Logique de dÃ©tection
- **Parent** : processus Microsoft Office
- **Enfant** : LOLBins / moteurs de script
- **Sans analyse de ligne de commande**

### InterprÃ©tation SOC
- Comportement suspect
- Non suffisant seul pour confirmer un incident
- Utile pour **dÃ©tection prÃ©coce et hunting**

### Usage recommandÃ©
- Triage SOC L1 / L2
- Threat hunting
- Base de corrÃ©lation

---

## RÃ¨gle 2 â€“ STRICT

### Nom
**Office lance un LOLBin avec tÃ©lÃ©chargement/exÃ©cution suspecte - STRICT**
[office_lolbin_download_execute_strict_cve-2025-62554.yml](./rules/office_lolbin_download_execute_strict_cve-2025-62554.yml)
### Objectif
DÃ©tecter une **intention malveillante explicite** aprÃ¨s exploitation Office.

### Logique de dÃ©tection
- Office comme processus parent
- LOLBin comme processus enfant
- **ET** indicateurs :
  - TÃ©lÃ©chargement de payload (HTTP/HTTPS, curl, bitsadmin, certutil)
  - Obfuscation / exÃ©cution en mÃ©moire (`-enc`, Base64, IEX)

### InterprÃ©tation SOC
- **ActivitÃ© hautement malveillante**
- Exploitation ou post-exploitation probable

### Usage recommandÃ©
- Escalade SOC analyste N2 / N3
- DÃ©claration dâ€™incident
- Automatisation SOAR

---

## CorrÃ©lation des rÃ¨gles (ESSENTIEL)

Ces rÃ¨gles sont conÃ§ues pour Ãªtre **corrÃ©lÃ©es**.

### Logique recommandÃ©e

1. **DÃ©clenchement BROAD**
   - ActivitÃ© Office suspecte dÃ©tectÃ©e
   - Contexte Ã©tabli

2. **DÃ©clenchement STRICT**
   - Intention malveillante confirmÃ©e
   - Incident validÃ©

Cette corrÃ©lation :
- RÃ©duit les faux positifs
- Maintient une visibilitÃ© prÃ©coce

---

## Tableau comparatif SOC

| CritÃ¨re | BROAD | STRICT |
|------|------|------|
| PortÃ©e | Large | CiblÃ©e |
| Faux positifs | Possibles | Rares |
| Niveau de confiance | Moyen | Ã‰levÃ© |
| Analyse ligne de commande | âŒ | âœ… |
| TÃ©lÃ©chargement payload | âŒ | âœ… |
| DÃ©tection obfuscation | âŒ | âœ… |
| Niveau SOC | L1 / L2 | L2 / L3 |
| Incident confirmÃ© | âŒ | âœ… |

---

## Bonne pratique

> Toujours dÃ©ployer **les deux rÃ¨gles ensemble**.
>
> - BROAD = visibilitÃ© & hunting  
> - STRICT = confirmation & rÃ©ponse  
>
> Cette combinaison assure une dÃ©tection robuste des chaÃ®nes dâ€™exploitation liÃ©es Ã  **CVE-2025-62554**.
