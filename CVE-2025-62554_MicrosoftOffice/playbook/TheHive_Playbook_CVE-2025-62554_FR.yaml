version: 1
name: "CVE-2025-62554 - Office RCE (SOAR-ready)"
description: "Workflow triage et réponse pour activité LOLBIN déclenchée par Office (aligné CVE-2025-62554)."
severity: "HIGH"
tags:
  - "cve.2025-62554"
  - "attack.t1204.002"
  - "attack.t1059.001"
  - "attack.t1105"
  - "attack.t1218"
inputs:
  - { name: alert_id, type: string }
  - { name: host, type: string }
  - { name: user, type: string }
  - { name: parent_process, type: string }
  - { name: child_process, type: string }
  - { name: command_line, type: string }
  - { name: dst_ip, type: string }
  - { name: dst_domain, type: string }
  - { name: url, type: string }

workflow:
  - step: "L1 - Valider le contexte Office"
    actions:
      - "Confirmer que le parent est Office (WINWORD/EXCEL/POWERPNT/OUTLOOK)."
      - "Capturer l’arbre de processus complet et les timestamps."
  - step: "L1 - Vérifier LOLBIN enfant + CLI"
    actions:
      - "Vérifier que l’enfant est un LOLBIN/moteur de script."
      - "Analyser la CLI : URL/download/obfuscation (-enc, IEX, base64)."
  - step: "L1 - Corrélation réseau"
    actions:
      - "Vérifier trafic sortant vers hôte non fiable (first-seen, réputation, géo inhabituelle)."
  - step: "L2 - Vérif persistance"
    actions:
      - "Hunting persistance créée peu après (task/service/Run keys/Startup)."
  - step: "L2 - Décision"
    actions:
      - "Appliquer la table décisionnelle : CONFIRMED / PROBABLE / FP."
  - step: "Réponse - Confinement"
    when: "decision in ['CONFIRMED','PROBABLE']"
    actions:
      - "Isoler l’hôte via EDR."
      - "Terminer les processus suspects."
      - "Bloquer IOC (URL/domaine/IP/hash) si possible."
  - step: "Réponse - Collecte preuves"
    when: "decision in ['CONFIRMED','PROBABLE']"
    actions:
      - "Collecter : process tree, CLI, fichiers déposés, connexions réseau."
      - "Préserver le document Office et les en-têtes email (si disponibles)."
  - step: "Clôture - FP"
    when: "decision == 'FP'"
    actions:
      - "Documenter justification (changement IT / script signé)."
      - "Tuner allowlists si récurrence."

outputs:
  - { name: decision, type: string }
  - { name: notes, type: string }
