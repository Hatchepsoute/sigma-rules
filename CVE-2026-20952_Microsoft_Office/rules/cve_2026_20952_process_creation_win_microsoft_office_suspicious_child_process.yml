title: Microsoft Office Suspicious Child Process Execution (STRICT)
id: 38BDC9AD-7CAE-7778-0C61-54A5C5F51F18
status: stable
description: >
  Detects high-confidence suspicious command or script execution spawned by  Microsoft Office applications. This behavior is uncommon in legitimate Office  usage and may indicate exploitation of vulnerabilities such as CVE-2026-20952
  (Use After Free leading to local code execution). 
  FR=> Détecte l'exécution suspecte, avec un haut niveau de confiance, de commandes ou de scripts générés par les applications Microsoft Office. Ce comportement est rare dans le cadre d'une utilisation légitime d'Office et peut indiquer l'exploitation de vulnérabilités telles que CVE-2026-20952 (une faille de type Use-After-Free menant à l'exécution de code local).
author: Adama ASSIONGBON | SOC & CTI Analyst . https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-01-15
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20952
  - https://nvd.nist.gov/vuln/detail/CVE-2026-20952
tags:
  - attack.execution
  - attack.t1059
  - attack.t1203
  - cve.2026-20952

logsource:
  category: process_creation
  product: windows

detection:
  selection_parent:
    ParentImage|endswith:
      - '\WINWORD.EXE'
      - '\EXCEL.EXE'
      - '\POWERPNT.EXE'
      - '\OUTLOOK.EXE'
      - '\MSACCESS.EXE'

  selection_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
      - '\wscript.exe'
      - '\cscript.exe'

  selection_suspicious_args:
    CommandLine|contains:
      - '-enc'
      - 'EncodedCommand'
      - 'FromBase64String'
      - 'IEX'
      - 'Invoke-Expression'
      - 'DownloadString'
      - 'http://'
      - 'https://'
      - 'javascript:'
      - 'vbscript:'
      - '.dll,'

  filter_legitimate:
    Image|startswith:
      - 'C:\Program Files\'
      - 'C:\Program Files (x86)\'
    ParentCommandLine|contains:
      - '/automation'
      - '/pt'
      - '/embedding'

  condition: selection_parent and selection_child and selection_suspicious_args and not filter_legitimate

fields:
  - ParentImage
  - Image
  - CommandLine
  - ParentCommandLine
  - User
  - Hostname

falsepositives:
  - Rare enterprise Office automation executing scripts
  - Custom Office add-ins with command execution capabilities
  - Developer or testing environments

level: high

