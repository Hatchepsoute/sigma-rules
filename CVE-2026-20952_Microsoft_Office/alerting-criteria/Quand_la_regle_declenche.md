# Quand la r√®gle STRICT se d√©clenche ‚Äì CVE-2026-20952 (Microsoft Office)

## üéØ Principe g√©n√©ral

La r√®gle Sigma **STRICT CVE-2026-20952** se d√©clenche **uniquement lorsque toutes les conditions critiques sont r√©unies** :

> **Microsoft Office lance un processus enfant sensible avec un comportement explicitement offensif.**

Cette r√®gle est con√ßue pour un **SOC en production** et vise la **confirmation d‚Äôune compromission**, pas le simple threat hunting.

---

## ‚úÖ Cas o√π la r√®gle D√âCLENCHE

### 1Ô∏è‚É£ Exploitation d‚Äôun document Office malveillant

**Sc√©nario**
- Un utilisateur ouvre un document Word / Excel / PowerPoint pi√©g√©
- Le document exploite une vuln√©rabilit√© m√©moire (Use-After-Free)
- Office lance un interpr√©teur de commandes ou un moteur de script

**Exemples concrets**
- `WINWORD.EXE ‚Üí powershell.exe -EncodedCommand ...`
- `EXCEL.EXE ‚Üí mshta.exe javascript:...`
- `POWERPNT.EXE ‚Üí rundll32.exe evil.dll,Export`

‚û°Ô∏è **D√©clenchement imm√©diat**  
‚û°Ô∏è **Tr√®s forte probabilit√© de compromission**

---
### 2Ô∏è‚É£ Post-exploitation apr√®s compromission Office

**Sc√©nario**
- L‚Äôexploit initial a r√©ussi
- Office est utilis√© comme point d‚Äôentr√©e
- L‚Äôattaquant d√©ploie un payload, un loader ou un C2

**Indicateurs observ√©s**
- `IEX`
- `FromBase64String`
- `DownloadString`
- Chargement de DLL via `rundll32`

‚û°Ô∏è **D√©clenchement confirm√©**  
‚û°Ô∏è Incident SOC prioritaire

---

### 3Ô∏è‚É£ Campagnes malware fileless via Office

**Sc√©nario**
- Aucune √©criture de binaire malveillant sur disque
- Ex√©cution en m√©moire via PowerShell ou scripts
- T√©l√©chargement de charges utiles √† la vol√©e

‚û°Ô∏è La r√®gle est **sp√©cifiquement con√ßue pour ces cas**  
‚û°Ô∏è Tr√®s faible taux de faux positifs

---

## üö´ Cas o√π la r√®gle NE d√©clenche PAS

### ‚ùå Automatisation Office l√©gitime
- Impression
- COM automation
- Add-ins m√©tiers
- Lancement avec `/automation`, `/embedding`, `/pt`

‚û°Ô∏è **Explicitement filtr√©**

---

### ‚ùå PowerShell ou scripts lanc√©s hors Office
- L‚Äôutilisateur lance PowerShell manuellement
- Scripts IT ou t√¢ches planifi√©es
- Parent ‚â† Office

‚û°Ô∏è **Aucun d√©clenchement**

---

### ‚ùå Macros Office sans ex√©cution syst√®me
- VBA interne (calcul, formatage)
- Aucune cr√©ation de processus externe

‚û°Ô∏è **Aucun d√©clenchement**

---

## üß† Pourquoi cette r√®gle est STRICT

| Crit√®re | Comportement |
|------|------|
| Processus parent | Microsoft Office uniquement |
| Processus enfant | LOLBins sensibles uniquement |
| Arguments | Offensifs explicites |
| Automatisation | Filtr√©e |
| Faux positifs | Tr√®s faibles |
| Usage SOC | Alerte production |

---

## üö® Gravit√© SOC r√©elle

Lorsque cette r√®gle se d√©clenche en production :

- üî• Ce n‚Äôest pas du bruit
- üî• Ce n‚Äôest pas un simple indicateur faible
- üî• C‚Äôest un **incident potentiel**

‚û°Ô∏è Triage L1 rapide  
‚û°Ô∏è Escalade L2 justifi√©e  
‚û°Ô∏è Confinement souvent n√©cessaire

---

## üß© R√©sum√© en une phrase

> **Cette r√®gle se d√©clenche lorsque Microsoft Office adopte un comportement qu‚Äôil ne devrait quasiment jamais avoir : lancer un moteur d‚Äôex√©cution offensif.**
