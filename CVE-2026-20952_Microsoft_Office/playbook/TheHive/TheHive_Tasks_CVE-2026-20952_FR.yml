# Plan de tâches TheHive (YAML)
# CVE-2026-20952 – Microsoft Office UAF (STRICT)

tasks:
  - title: "Triage – Validation de l’alerte (L1)"
    group: "Triage"
    order: 10
    description: |
      Vérifier que l’alerte correspond à la logique STRICT :
      Office → processus enfant suspect avec arguments malveillants.
    checklist:
      - "Confirmer ParentImage (Office) et Image enfant (LOLBins)"
      - "Capturer CommandLine et ParentCommandLine"
      - "Identifier l’utilisateur et le contexte (interactif vs automatisation)"
      - "Vérifier la présence de /automation /pt /embedding"
    output:
      - "resultat_triage : FP | Suspect | Confirmé"

  - title: "Enrichissement – Arbre des processus & contexte hôte (L2)"
    group: "Investigation"
    order: 20
    checklist:
      - "Collecter l’arbre des processus"
      - "Récupérer les hash des binaires"
      - "Analyser les chemins d’exécution"
      - "Identifier les documents Office récents"
    output:
      - "arbre_collecte : oui/non"

  - title: "Corrélation – Trafic réseau sortant (L2)"
    group: "Investigation"
    order: 30
    checklist:
      - "Vérifier les connexions HTTP/S sortantes"
      - "Identifier IP/domaines rares ou inconnus"
      - "Évaluer la réputation"
    output:
      - "egress_externe : oui/non"

  - title: "Validation – Signaux EDR / AMSI (L2)"
    group: "Investigation"
    order: 40
    checklist:
      - "Rechercher des alertes AMSI PowerShell"
      - "Consulter les alertes EDR/AV"
    output:
      - "signal_edr : aucun/faible/moyen/élevé"

  - title: "Confinement – Isolation du poste (L2/L3)"
    group: "Confinement"
    order: 50
    checklist:
      - "Isoler le poste via l’EDR"
      - "Arrêter le processus malveillant"
      - "Bloquer les destinations réseau malveillantes"
    conditions:
      run_if:
        - "resultat_triage in ['Suspect','Confirmé']"

  - title: "Preuves – Préservation des artefacts (L2/L3)"
    group: "Forensic"
    order: 60
    checklist:
      - "Exporter lignes de commande et métadonnées"
      - "Collecter échantillons et hash"
      - "Sauvegarder documents/emails liés"
    output:
      - "preuves_collectees : oui/non"

  - title: "Remédiation – Correctifs & durcissement (IT/L3)"
    group: "Remédiation"
    order: 70
    checklist:
      - "Appliquer les correctifs Office (CVE-2026-20952)"
      - "Activer règles ASR Office"
      - "Réinitialiser les identifiants si nécessaire"

  - title: "Hunting – Recherche étendue (SOC/CTI)"
    group: "Hunting"
    order: 80
    checklist:
      - "Recherche Office → LOLBins sur 24–72h"
      - "Détection de commandes encodées similaires"

  - title: "Clôture – Rapport & retour d’expérience"
    group: "Clôture"
    order: 90
    checklist:
      - "Documenter la chronologie"
      - "Mettre à jour la base de connaissances"
      - "Créer tickets de tuning si FP"
