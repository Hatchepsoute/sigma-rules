# TheHive Case Template (YAML - import-friendly structure)
# CVE-2026-20952 - Microsoft Office UAF (STRICT)
# NOTE: TheHive templates are commonly managed via API as JSON.
# This YAML is a clean, readable representation you can convert to JSON if needed.

case_template:
  name: "CVE-2026-20952 - Microsoft Office UAF (STRICT)"
  displayName: "CVE-2026-20952 - Office Suspicious Child Process (STRICT)"
  titlePrefix: "[CVE-2026-20952][Office]"
  severity: 3            # 1=Low,2=Medium,3=High,4=Critical (typical SOC convention)
  tlp: 2                 # 0=WHITE,1=GREEN,2=AMBER,3=RED
  pap: 2                 # 1=WHITE,2=AMBER,3=RED (adapt to your internal scale)
  tags:
    - "cve-2026-20952"
    - "microsoft-office"
    - "use-after-free"
    - "sigma-strict"
    - "attack.t1059"
    - "attack.t1203"
  description: |
    Triggered when Microsoft Office spawns a suspicious command/script engine
    (PowerShell/cmd/mshta/rundll32/wscript/cscript) with malicious arguments
    (encoded, IEX, DownloadString, javascript/vbscript, dll loading), consistent
    with post-exploitation behavior such as CVE-2026-20952.

  customFields:
    detection_rule:
      type: "string"
      value: "Microsoft Office Suspicious Child Process Execution (STRICT)"
    cve:
      type: "string"
      value: "CVE-2026-20952"
    confidence:
      type: "string"
      value: "high"
    environment:
      type: "string"
      value: "production"
    recommended_actions:
      type: "string"
      value: "Validate parent/child, inspect command line, correlate egress/EDR/AMSI, isolate if confirmed."

  # Mapping of common observables to be added as TheHive observables
  # Your ingestion pipeline (SIEM/SOAR connector) should populate these when available.
  observable_defaults:
    - dataType: "hostname"
      ioc: false
      tags: ["asset"]
    - dataType: "user"
      ioc: false
      tags: ["identity"]
    - dataType: "process"
      ioc: false
      tags: ["telemetry"]
    - dataType: "other"
      ioc: false
      tags: ["commandline"]

  # Link to tasks playbook (see TheHive_Tasks_CVE-2026-20952.yml)
  tasks_ref: "TheHive_Tasks_CVE-2026-20952.yml"
