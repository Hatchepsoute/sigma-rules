# üêù SOC Playbook - Office Exploitation Chains (Global)

This playbook operationalizes triage and response for alerts where **Microsoft Office spawns LOLBINs/script engines**.
It is designed to cover Office RCE chains (malicious documents, embedded/remote content) and Office Patch Tuesday CVEs.

## Telemetry assumptions
- Endpoint logs: Sysmon / EDR process telemetry (process creation + command line)
- Network telemetry: proxy/firewall/DNS (optional but recommended)
- Optional: email gateway metadata (sender, subject, attachment hash)

## Triggers
- **Sigma BROAD**: Office spawns LOLBIN/script engine (context / hunting)
- **Sigma STRICT**: Office spawns LOLBIN with download/execute or obfuscation patterns (alert)

## Workflow (SOC analyst L1 ‚Üí L2)
1. Validate parent process is Office (WINWORD/EXCEL/POWERPNT/OUTLOOK/MSACCESS)
2. Confirm child is a LOLBIN/script engine and capture full process tree
3. Inspect command line for:
   - URLs (http/https), iwr/curl/wget, bitsadmin/certutil
   - -enc / EncodedCommand / FromBase64String / IEX
4. Correlate network egress (first-seen domain/IP, reputation, unusual geo)
5. Check for persistence shortly after (Tasks, Run keys, services, Startup)
6. Apply **Decision Table** (Confirmed / Probable / FP)
7. Response actions (containment + evidence collection)
8. Close & tune (allowlists, FP patterns)

## Containment (if Confirmed/Probable)
- Isolate host (EDR)
- Kill suspicious child processes
- Block IOC (URL/domain/IP) when feasible
- Quarantine the Office document (and email if available)

## Evidence collection
- Full process tree + timestamps
- Command line of child process(es)
- Dropped files in %TEMP% / %APPDATA% / Downloads
- DNS/proxy logs for associated domains/URLs
- Persistence artifacts created within 0‚Äì30 minutes after trigger

## Remediation recommendations
- Patch Microsoft Office / Microsoft 365 Apps across endpoints
- Reduce Office‚Üíscript engine abuse (ASR rules / WDAC / AppLocker)
- Harden PowerShell (Constrained Language Mode where applicable, logging, script block logging)
- Email hardening (sandbox attachments, block risky macros and suspicious file types)

## Mapping (typical)
- ATT&CK: T1204.002, T1059.001, T1105, T1218
