# üêù Playbook SOC - Cha√Ænes d‚Äôexploitation Office (Global)

Ce playbook op√©rationnalise le triage et la r√©ponse pour les alertes o√π **Microsoft Office lance des LOLBINs/moteurs de script**.
Il couvre les cha√Ænes RCE via documents malveillants (contenu int√©gr√©/distant) et les CVE Office des Patch Tuesday.

## Hypoth√®ses de t√©l√©m√©trie
- Logs endpoint : Sysmon / EDR (process creation + command line)
- T√©l√©m√©trie r√©seau : proxy/pare-feu/DNS (recommand√©)
- Optionnel : m√©tadonn√©es passerelle mail (exp√©diteur, sujet, hash pi√®ce jointe)

## D√©clenchement
- **Sigma BROAD** : Office lance LOLBIN/script (contexte / hunting)
- **Sigma STRICT** : Office lance LOLBIN avec patterns download/execute ou obfuscation (alerte)

## Workflow (Analyste SOC N1 ‚Üí N2)
1. Valider que le parent est Office (WINWORD/EXCEL/POWERPNT/OUTLOOK/MSACCESS)
2. Confirmer l‚Äôenfant LOLBIN/script et capturer l‚Äôarbre de processus complet
3. Analyser la ligne de commande :
   - URL (http/https), iwr/curl/wget, bitsadmin/certutil
   - -enc / EncodedCommand / FromBase64String / IEX
4. Corr√©ler le r√©seau sortant (first-seen, r√©putation, g√©o inhabituelle)
5. V√©rifier la persistance peu apr√®s (Tasks, Run keys, services, Startup)
6. Appliquer la **table d√©cisionnelle** (Confirm√© / Probable / FP)
7. Actions de r√©ponse (confinement + collecte preuves)
8. Cl√¥ture & tuning (allowlists, patterns FP)

## Confinement (si Confirm√©/Probable)
- Isoler l‚Äôh√¥te (EDR)
- Terminer les processus enfants suspects
- Bloquer IOC (URL/domaine/IP) si possible
- Mettre en quarantaine le document Office (et l‚Äôemail si disponible)

## Collecte de preuves
- Arbre de processus complet + timestamps
- Ligne de commande du/des processus enfant(s)
- Fichiers d√©pos√©s %TEMP% / %APPDATA% / Downloads
- Logs DNS/proxy associ√©s (domaines/URL)
- Artefacts de persistance cr√©√©s dans les 0‚Äì30 minutes apr√®s d√©clenchement

## Recommandations rem√©diation
- Patcher Microsoft Office / Microsoft 365 Apps sur les postes
- R√©duire l‚Äôabus Office‚Üíscript engine (ASR rules / WDAC / AppLocker)
- Durcir PowerShell (logging, script block logging, CLM si applicable)
- Durcir la messagerie (sandbox pi√®ces jointes, blocage macros/formats √† risque)

## Mapping (typique)
- ATT&CK : T1204.002, T1059.001, T1105, T1218
