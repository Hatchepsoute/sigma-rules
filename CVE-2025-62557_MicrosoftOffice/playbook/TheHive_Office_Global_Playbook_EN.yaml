version: 1
name: "Office Exploitation Chains - Global (SOAR-ready)"
description: "Triage and response workflow for Office-spawned LOLBIN activity (global Office RCE chain coverage)."
severity: "HIGH"
tags:
  - "attack.t1204.002"
  - "attack.t1059.001"
  - "attack.t1105"
  - "attack.t1218"
inputs:
  - { name: alert_id, type: string }
  - { name: host, type: string }
  - { name: user, type: string }
  - { name: parent_process, type: string }
  - { name: child_process, type: string }
  - { name: command_line, type: string }
  - { name: dst_ip, type: string }
  - { name: dst_domain, type: string }
  - { name: url, type: string }

workflow:
  - step: "L1 - Validate Office context"
    actions:
      - "Confirm parent is Office (WINWORD/EXCEL/POWERPNT/OUTLOOK/MSACCESS)."
      - "Capture full process tree and timestamps."
  - step: "L1 - Inspect child process and command line"
    actions:
      - "Verify child is LOLBIN/script engine."
      - "Search CLI for URL/download/obfuscation patterns (-enc, IEX, base64)."
  - step: "L1 - Network correlation"
    actions:
      - "Check DNS/proxy/firewall for egress to untrusted host (first-seen, reputation, unusual geo)."
  - step: "L2 - Persistence check"
    actions:
      - "Hunt for persistence created shortly after (task/service/Run keys/Startup)."
  - step: "L2 - Decision"
    actions:
      - "Apply decision table: CONFIRMED / PROBABLE / FP."
  - step: "Response - Containment"
    when: "decision in ['CONFIRMED','PROBABLE']"
    actions:
      - "Isolate host via EDR."
      - "Kill suspicious processes."
      - "Block IOC (URL/domain/IP/hash) where feasible."
  - step: "Response - Evidence collection"
    when: "decision in ['CONFIRMED','PROBABLE']"
    actions:
      - "Collect: process tree, command line, dropped files, network connections, persistence artifacts."
      - "Preserve Office document and email headers (if available)."
  - step: "Close - FP"
    when: "decision == 'FP'"
    actions:
      - "Document justification (IT change / signed script / approved automation)."
      - "Tune allowlists if repetitive."

outputs:
  - { name: decision, type: string }
  - { name: notes, type: string }
