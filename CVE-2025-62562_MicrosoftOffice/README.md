# ðŸ“˜ CVE-2025-62562 â€“ Office â†’ LOLBins Detection (BROAD & STRICT)

## ðŸŽ¯ Purpose of These Rules

This directory contains **two complementary Sigma rules** designed to detect **realistic exploitation scenarios involving Microsoft Office** (e.g. **CVE-2025-62562**).

The goal is to help SOC analysts:
- Understand **what each rule detects**
- Know **why two rules are required**
- Use them together for **reliable detection and triage**

These rules follow a **defense-in-depth detection strategy**.

---

## ðŸ§  Threat Context (Simple Explanation)

In modern attacks, Microsoft Office documents are frequently used as an **initial execution vector**:
- Malicious document opened by the user
- Office process executes system tools (**LOLBins**)
- Payload is downloaded and executed
- Attacker gains persistence or deploys ransomware

Office **should not normally spawn command interpreters or download tools**.

---

## ðŸŸ¦ Rule 1 - BROAD Detection

### ðŸ” What This Rule Detects

This rule detects when a **Microsoft Office application spawns a suspicious child process**, such as:

- `powershell.exe`
- `cmd.exe`
- `mshta.exe`
- `rundll32.exe`
- `wscript.exe`
- `regsvr32.exe`
- `bitsadmin.exe`
- `certutil.exe`

### ðŸ§  What It Means

This behavior is **abnormal but not always malicious**.

Possible causes:
- Malicious Office document
- Macro or exploit attempt
- Legitimate automation (rare but possible)

### ðŸŽ¯ Usage

- Early detection
- Threat hunting
- SOC L1 / L2 triage

---

## ðŸŸ¥ Rule 2 - STRICT Detection

### ðŸ” What This Rule Detects

This rule builds on the BROAD rule and adds **malicious intent indicators** in the command line, such as:

- Payload download (`http://`, `Invoke-WebRequest`, `curl`, `wget`)
- Obfuscation (`-enc`, `EncodedCommand`, `FromBase64String`)
- Direct execution (`IEX`, `Invoke-Expression`)

### ðŸ§  What It Means

This behavior is **high-confidence malicious activity**.

Office is being used to:
- Download remote payloads
- Execute obfuscated commands
- Launch post-exploitation tooling

### ðŸŽ¯ Usage

- Incident detection
- SOC L2 / L3 escalation
- SOAR / automated response

---

## ðŸ”— Why Both Rules Are Required (Correlation)

Using only one rule is not sufficient.

### Recommended Correlation Logic

1. **BROAD rule triggers**
   - Detect suspicious behavior
   - Generate context

2. **STRICT rule triggers**
   - Confirm malicious intent
   - Escalate incident

This approach reduces false positives while ensuring **early visibility**.

---

## ðŸ“Š SOC Comparison Table

| Criteria | BROAD | STRICT |
|------|------|------|
| Detection scope | Wide | Narrow |
| False positives | Possible | Very rare |
| Confidence level | Medium | High |
| Payload download | âŒ | âœ… |
| Obfuscation detection | âŒ | âœ… |
| SOC usage | L1 / L2 | L2 / L3 |
| Incident ready | âŒ | âœ… |

---

## ðŸ›¡ï¸ SOC Best Practice

> Deploy **both rules together**.
>
> - BROAD = visibility and hunting  
> - STRICT = confirmation and response  

This pairing provides **robust detection for CVE-2025-62562 exploitation**.

---
### CVE-2025-62562 - Microsoft Office Pack (SOC)

Contents:
- âœ… Sigma rules (BROAD + STRICT)
- âœ… Decision table (EN/FR + PDF)
- âœ… Attack flow diagrams (SVG EN/FR + 3D PNG EN/FR)
- âœ… SOC playbook (EN/FR) + TheHive YAML (EN/FR)
