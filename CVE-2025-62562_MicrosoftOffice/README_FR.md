# ðŸ“˜ CVE-2025-62562 â€“ DÃ©tection Office â†’ LOLBins (BROAD & STRICT)

## ðŸŽ¯ Objectif des rÃ¨gles

Ce rÃ©pertoire contient **deux rÃ¨gles Sigma complÃ©mentaires** conÃ§ues pour dÃ©tecter des **scÃ©narios dâ€™exploitation rÃ©alistes via Microsoft Office** (ex. **CVE-2025-62562**).

Lâ€™objectif est de permettre aux analystes SOC de :
- Comprendre **le rÃ´le de chaque rÃ¨gle**
- Savoir **pourquoi deux rÃ¨gles sont nÃ©cessaires**
- Utiliser ces rÃ¨gles comme **guide opÃ©rationnel**

Ces rÃ¨gles reposent sur une **approche de dÃ©tection en profondeur**.

---

## ðŸ§  Contexte de menace (explication simple)

Les documents Microsoft Office sont trÃ¨s souvent utilisÃ©s comme **vecteur dâ€™attaque initial** :
- Ouverture dâ€™un document piÃ©gÃ©
- ExÃ©cution de commandes systÃ¨me par Office
- TÃ©lÃ©chargement dâ€™un payload
- Post-exploitation / ransomware

ðŸ‘‰ **Office ne devrait jamais lancer directement des outils systÃ¨me.**

---

## ðŸŸ¦ RÃ¨gle 1 - DÃ©tection BROAD

### ðŸ” Ce que la rÃ¨gle dÃ©tecte

Cette rÃ¨gle dÃ©tecte lorsquâ€™une **application Office lance un processus suspect**, par exemple :

- `powershell.exe`
- `cmd.exe`
- `mshta.exe`
- `rundll32.exe`
- `wscript.exe`
- `regsvr32.exe`
- `bitsadmin.exe`
- `certutil.exe`

### ðŸ§  InterprÃ©tation SOC

Ce comportement est **anormal**, mais **pas toujours malveillant**.

Causes possibles :
- Document malveillant
- Tentative dâ€™exploitation
- Automatisation lÃ©gitime (rare)

### ðŸŽ¯ Utilisation

- DÃ©tection prÃ©coce
- Threat hunting
- Triage SOC analyst L1 / L2

---

## ðŸŸ¥ RÃ¨gle 2 - DÃ©tection STRICT

### ðŸ” Ce que la rÃ¨gle dÃ©tecte

Cette rÃ¨gle ajoute des **indicateurs explicites de malveillance**, tels que :

- TÃ©lÃ©chargement de payload (`http://`, `Invoke-WebRequest`, `curl`, `wget`)
- Obfuscation (`-enc`, `EncodedCommand`, `FromBase64String`)
- ExÃ©cution directe (`IEX`, `Invoke-Expression`)

### ðŸ§  InterprÃ©tation SOC

Il sâ€™agit ici dâ€™une **activitÃ© fortement malveillante** :
- TÃ©lÃ©chargement de code distant
- ExÃ©cution obfusquÃ©e
- Post-exploitation

### ðŸŽ¯ Utilisation

- DÃ©tection dâ€™incident
- Escalade SOC L2 / L3
- SOAR / rÃ©ponse automatisÃ©e

---

## ðŸ”— CorrÃ©lation des deux rÃ¨gles (essentiel)

Utiliser une seule rÃ¨gle est insuffisant.

### Logique recommandÃ©e

1. **La rÃ¨gle BROAD se dÃ©clenche**
   - Alerte initiale
   - Contexte fourni

2. **La rÃ¨gle STRICT se dÃ©clenche**
   - Confirmation malveillante
   - Incident confirmÃ©

Cette approche permet de :
- RÃ©duire les faux positifs
- Conserver une visibilitÃ© prÃ©coce

---

## ðŸ“Š Tableau comparatif SOC

| CritÃ¨re | BROAD | STRICT |
|------|------|------|
| PortÃ©e de dÃ©tection | Large | CiblÃ©e |
| Faux positifs | Possibles | TrÃ¨s rares |
| Niveau de confiance | Moyen | Ã‰levÃ© |
| TÃ©lÃ©chargement payload | âŒ | âœ… |
| DÃ©tection obfuscation | âŒ | âœ… |
| Niveau SOC | L1 / L2 | L2 / L3 |
| Incident confirmÃ© | âŒ | âœ… |

---

## ðŸ›¡ï¸ Bonne pratique SOC

> DÃ©ployer **les deux rÃ¨gles ensemble**.
>
> - BROAD = visibilitÃ© et hunting  
> - STRICT = confirmation et rÃ©ponse  

Cette combinaison offre une **dÃ©tection robuste des exploitations liÃ©es Ã  CVE-2025-62562**.
---
### CVE-2025-62562 - Pack Microsoft Office (SOC)

Contenu :
- âœ… RÃ¨gles Sigma (BROAD + STRICT)
- âœ… Table dÃ©cisionnelle (EN/FR + PDF)
- âœ… Diagrammes dâ€™attaque (SVG EN/FR + PNG 3D EN/FR)
- âœ… Playbook SOC (EN/FR) + YAML TheHive (EN/FR)
