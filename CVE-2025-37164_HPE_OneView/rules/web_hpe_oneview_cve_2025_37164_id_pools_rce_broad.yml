title: HPE OneView ID Pools API Exploitation Attempt (CVE-2025-37164)
id: e98d3dbc-ef98-11f0-aa52-97a563fad0ee
status: stable
description: >
  Detects suspicious POST requests targeting the HPE OneView ID Pools REST API that may indicate unauthenticated remote code execution attempts (CVE-2025-37164). Focuses on specific exploit patterns with high confidence.
  |
  Détecte des requêtes POST suspectes ciblant l'API ID Pools de HPE OneView, pouvant indiquer une tentative d'exécution de code à distance non authentifiée. Se concentre sur des modèles d'exploitation spécifiques avec une haute confiance.
author: Adama ASSIONGBON | SOC & CTI Analyst Consultant
date: 2026-01-10
modified: 2026-01-13
references:
  - https://attackerkb.com/topics/ixWdbDvjwX/cve-2025-37164/rapid7-analysis
  - https://www.rapid7.com/blog/post/etr-cve-2025-37164-critical-unauthenticated-rce-affecting-hewlett-packard-enterprise-oneview/
  - https://nvd.nist.gov/vuln/detail/CVE-2025-37164
  - https://www.tenable.com/cve/CVE-2025-37164
tags:
  - attack.t1190
  - attack.initial-access
  - detection.threat-hunting
  - cve.2025-37164
logsource:
  category: webserver
  product: hpe_oneview
detection:
  # Base URI pattern for vulnerable endpoint
  selection_uri:
    cs-method: POST
    cs-uri-stem|contains: "/rest/id-pools/"
    cs-uri-stem|endswith: "/validate"  # Specific vulnerable endpoint
  
  # High-confidence exploit patterns
  selection_exploit_patterns:
    cs-uri-query|contains:
      - "$(/"  # Command substitution with path
      - "`/"   # Backtick command substitution
      - "|/"   # Pipe with command
      - "; /"  # Command separator with space
  
  # Shell/command patterns in URI
  selection_shell_commands:
    cs-uri-query|contains:
      - "/bin/sh"
      - "/bin/bash"
      - "/bin/dash"
      - "curl "
      - "wget "
      - "nc "
      - "python"
      - "perl"
  
  # Server response indicating potential exploitation
  selection_response:
    # 500 errors often indicate attempted command execution
    sc-status: 500
    # OR successful response but with suspicious content
    # cs-uri-query|contains: "success"
  
  # Filter out legitimate traffic
  filter_legitimate:
    # Exclude known security scanners by User-Agent
    c-useragent|contains:
      - "nessus"
      - "nexpose"
      - "qualys"
      - "acunetix"
      - "burpsuite"
      - "nikto"
      - "nmap"
      - "openvas"
    # Exclude internal IP ranges (adjust as needed)
    c-ip|startswith:
      - "10."
      - "192.168."
      - "172.16."
      - "172.17."
      - "172.18."
      - "172.19."
      - "172.20."
      - "172.21."
      - "172.22."
      - "172.23."
      - "172.24."
      - "172.25."
      - "172.26."
      - "172.27."
      - "172.28."
      - "172.29."
      - "172.30."
      - "172.31."
  
  # Filter out legitimate API testing tools
  filter_api_testing:
    c-useragent|contains:
      - "PostmanRuntime"
      - "Insomnia"
      - "Swagger"
      - "curl/"  # Legitimate curl with version
  
  condition: 
    selection_uri and 
    (selection_exploit_patterns or (selection_shell_commands and selection_response)) and
    not filter_legitimate and
    not filter_api_testing

fields:
  - c-ip
  - cs-method
  - cs-uri-stem
  - cs-uri-query
  - c-useragent
  - sc-status
  - cs-bytes
  - time-taken

falsepositives:
  - Legitimate API testing with malformed data (filtered by User-Agent)
  - Internal security testing (filtered by IP range)

level: high
