flowchart LR
  %% =========================================================
  %% Sigma-Rules Repository Overview (GitHub Mermaid compatible)
  %% =========================================================

  R[(sigma-rules repo)]

  %% --- Top-level docs ---
  R --> DOCS[Docs & Governance]
  DOCS --> README_EN[README.md]
  DOCS --> README_FR[README_FR.md]
  DOCS --> CONTRIB_EN[CONTRIBUTING.md]
  DOCS --> CONTRIB_FR[CONTRIBUTING_FR.md]
  DOCS --> INSTALL[INSTALLATION.md]
  DOCS --> LICENSE[LICENSE]
  DOCS --> CHANGELOG_ROOT[CHANGELOG.md]
  DOCS --> RELEASES[Release Notes]
  RELEASES --> RN_020[RELEASE_NOTES_v0.2.0.md]
  RELEASES --> RN_030[RELEASE_NOTES_v0.3.0.md]

  %% --- Global diagrams ---
  R --> GLOBAL_DIAG[Global Diagrams]
  GLOBAL_DIAG --> GDIAG_EN[sigma_rules_global_soc_workflow_3D_EN.png]
  GLOBAL_DIAG --> GDIAG_FR[sigma_rules_vue_globale_soc_3D_FR.png]
  GLOBAL_DIAG --> GDIAG_README_EN[diagrams/README.md]
  GLOBAL_DIAG --> GDIAG_README_FR[diagrams/README_FR.md]

  %% --- Scripts/tooling ---
  R --> SCRIPTS[Scripts & Tooling]
  SCRIPTS --> CONVERT[convert_all_rules.sh]
  SCRIPTS --> VALID_ALL[validate_all_rules.sh]
  SCRIPTS --> S_LINUX[Linux_MacOS/]
  S_LINUX --> VALID_PORTABLE[validate_all_rules_portable.sh]
  S_LINUX --> S_LINUX_README_EN[Linux_MacOS/README.md]
  S_LINUX --> S_LINUX_README_FR[Linux_MacOS/README_FR.md]
  SCRIPTS --> S_WIN[windows/]
  S_WIN --> VALID_PS[validate_all_rules.ps1]
  S_WIN --> S_WIN_README_EN[windows/README.md]
  S_WIN --> S_WIN_README_FR[windows/README_FR.md]
  SCRIPTS --> SCRIPTS_README_EN[scripts/README.md]
  SCRIPTS --> SCRIPTS_README_FR[scripts/README_FR.md]

  %% --- Detection Packs (high-level buckets) ---
  R --> PACKS[Detection Packs]
  PACKS --> PACK_AI[AI / Identity & Context Theft]
  PACKS --> PACK_CVE[CVE Packs]
  PACKS --> PACK_CAMPAIGNS[Campaign / Threat Packs]
  PACKS --> PACK_GENERIC[Generic Detection Patterns]

  %% --- AI pack example ---
  PACK_AI --> AI_CTX[AI_Agent_Context_Theft]
  AI_CTX --> AI_README_EN[README.md]
  AI_CTX --> AI_README_FR[README_FR.md]
  AI_CTX --> AI_RULES[rules/]
  AI_CTX --> AI_DT[decision-table/]
  AI_CTX --> AI_DIAG[diagrams/]
  AI_CTX --> AI_PB[playbook/]
  AI_RULES --> AI_BROAD[AI_Agent_Config_Access_BROAD.yml]
  AI_RULES --> AI_STRICT1[AI_Agent_Secrets_Exfiltration_STRICT.yml]
  AI_RULES --> AI_STRICT2[AI_Agent_MultiFile_Exfiltration_STRICT.yml]
  AI_RULES --> AI_STRICT3[AI_Agent_Crypto_Identity_Compromise_STRICT.yml]

  %% --- CVE packs (examples) ---
  PACK_CVE --> CVE_2009[CVE-2009-0556_PowerPoint]
  PACK_CVE --> CVE_SAMBA[CVE-2025-10230_samba]
  PACK_CVE --> CVE_FORTI[CVE-2025-59718_Fortigate_bypass]
  PACK_CVE --> CVE_BYOVD[CVE-2025-68947_BYOVD]
  PACK_CVE --> CVE_EOP[CVE-2026-20822_Windows_EoP]
  PACK_CVE --> CVE_SP[CVE-2026-20947_SharePoint_RCE]
  PACK_CVE --> CVE_WP[CVE-2026-23550_WordPress_ModularDS]
  PACK_CVE --> CVE_FCLOUD[CVE-2026-24858_FortiOS_FortiCloud_SSO]

  %% Standard pack structure (template)
  PACKS --> TEMPLATE[[Pack Standard Layout]]
  TEMPLATE --> T_README[README.md / README_FR.md]
  TEMPLATE --> T_RULES[rules/  (BROAD + STRICT)]
  TEMPLATE --> T_DIAG[diagrams/ (Mermaid + PNG/SVG)]
  TEMPLATE --> T_DT[decision-table/ (triage tables)]
  TEMPLATE --> T_PB[playbook/ (Generic + TheHive)]
  TEMPLATE --> T_CHANGELOG[CHANGELOG.md (optional)]
  TEMPLATE --> T_IOC[ioc/ or artifacts/ (optional)]
  TEMPLATE --> T_CORR[correlation/ (optional)]

  %% --- Campaign / Threat packs (examples) ---
  PACK_CAMPAIGNS --> FORTIWEB_SLIVER[FortiWeb-Sliver-Campaign]
  PACK_CAMPAIGNS --> INFOSTEALER[Infostealer_FULL_SOC]
  PACK_CAMPAIGNS --> KROOTKIT[Kernel_Rootkit_MVDR]

  %% --- Generic patterns ---
  PACK_GENERIC --> DEF_EVASION[Defense_Evasion_Security_Process_Termination]
  PACK_GENERIC --> OFFICE_GENERIC[MicrosoftOffice_Generic]

  %% =========================
  %% Styling (GitHub supported)
  %% =========================
  classDef root fill:#111827,stroke:#111827,color:#ffffff;
  classDef bucket fill:#0b1220,stroke:#334155,color:#e2e8f0;
  classDef pack fill:#0f172a,stroke:#475569,color:#e2e8f0;
  classDef folder fill:#0b1f2a,stroke:#1f2937,color:#e2e8f0;
  classDef broad fill:#1f3b2c,stroke:#10b981,color:#ecfdf5;
  classDef strict fill:#3b1f1f,stroke:#ef4444,color:#fff1f2;
  classDef doc fill:#1e293b,stroke:#64748b,color:#e2e8f0;

  class R root;
  class PACKS,PACK_AI,PACK_CVE,PACK_CAMPAIGNS,PACK_GENERIC bucket;
  class AI_CTX,CVE_2009,CVE_SAMBA,CVE_FORTI,CVE_BYOVD,CVE_EOP,CVE_SP,CVE_WP,CVE_FCLOUD,FORTIWEB_SLIVER,INFOSTEALER,KROOTKIT,DEF_EVASION,OFFICE_GENERIC pack;
  class AI_RULES,AI_DT,AI_DIAG,AI_PB,SCRIPTS,S_LINUX,S_WIN,GLOBAL_DIAG folder;
  class AI_BROAD broad;
  class AI_STRICT1,AI_STRICT2,AI_STRICT3 strict;
  class README_EN,README_FR,CONTRIB_EN,CONTRIB_FR,INSTALL,LICENSE,CHANGELOG_ROOT,RN_020,RN_030 doc;

