# üö® R√®gle Sigma : D√©tection d'Exploitation CVE-2009-0556 PowerPoint

## üìã Vue d'Ensemble
Cette r√®gle Sigma d√©tecte les tentatives d'exploitation de **CVE-2009-0556**, une vuln√©rabilit√© critique de corruption m√©moire dans Microsoft PowerPoint permettant l'ex√©cution de code √† distance via des fichiers de pr√©sentation sp√©cialement con√ßus.

## üéØ Que D√©tecte Cette R√®gle ?
- **Processus enfants suspects** lanc√©s par `POWERPNT.EXE`
- **Comportements post-exploitation courants** lorsque PowerPoint est compromis
- **Indicateurs d'exploitation de corruption m√©moire** menant √† l'ex√©cution de code arbitraire

## üîß D√©tails Techniques

### Contexte de la Vuln√©rabilit√©
- **Identifiant CVE** : CVE-2009-0556
- **Score CVSS** : 9.3 (√âLEV√â) - CVSS 2.0
- **Logiciels Affect√©s** :
  - PowerPoint 2000 SP3
  - PowerPoint 2002 SP3
  - PowerPoint 2003 SP3
  - Office 2004 pour Mac
- **Vecteur d'Attaque** : Structure `OutlineTextRefAtom` malform√©e dans les fichiers PowerPoint

### Logique de D√©tection
1. PowerPoint ouvre un fichier de pr√©sentation (.ppt, .pptx, .pps, etc.)
2. PowerPoint lance un interpr√©teur/ex√©cutable suspect
3. Les commandes b√©nignes courantes sont filtr√©es

### Processus Enfants Surveill√©s
| Processus | Utilisation Malveillante Typique |
|-----------|----------------------------------|
| `cmd.exe` | Ex√©cution de commandes, pr√©paration de payload |
| `powershell.exe` | Exploitation PowerShell, commandes encod√©es |
| `rundll32.exe` | Chargement de DLL, ex√©cution de code |
| `regsvr32.exe` | Attaque Squiblydoo, ex√©cution de scriptlets |
| `wscript.exe` | Ex√©cution VBScript/JScript |
| `mshta.exe` | Ex√©cution d'application HTML |

## ‚öôÔ∏è Configuration & D√©ploiement

### Pr√©requis
- SIEM supportant les r√®gles Sigma (Elastic SIEM, Splunk, Azure Sentinel, etc.)
- Journalisation des √©v√©nements Windows activ√©e (√©v√©nements de cr√©ation de processus)
- Journalisation PowerShell (optionnelle mais recommand√©e)

### √âtapes de D√©ploiement
1. Convertir la r√®gle Sigma au format natif de votre SIEM avec [Sigma Converter](https://github.com/SigmaHQ/sigma)
2. D√©ployer la r√®gle dans votre SIEM
3. Tester avec des sc√©narios contr√¥l√©s
4. Surveiller les alertes initiales et ajuster les seuils si n√©cessaire

## üé® Ajustement & Personnalisation

### R√©duction des Faux Positifs
La r√®gle inclut des filtres pour les commandes administratives courantes :
- `/?` - Requ√™tes d'aide syst√®me
- `echo ` - Commandes de d√©bogage (notez l'espace)
- `Get-Help` - Requ√™tes d'aide PowerShell

### Augmentation de la Sensibilit√©
Pour rendre la r√®gle plus agressive :
1. Supprimer la section `filter_benign_commands`
2. Ajouter une corr√©lation temporelle : `within 30s`
3. Ajouter une corr√©lation r√©seau (connexions sortantes PowerPoint)

### Ajustements Sp√©cifiques √† l'Environnement

### Ajustements Sp√©cifiques √† l'Environnement
```yaml
# Ajouter des chemins de confiance sp√©cifiques √† l'organisation
filter_trusted_paths:
  Image|startswith:
    - 'D:\OutilsCorporatifs\'
    - '\\DFS\IT\Scripts\'
```
    
###¬† Tests & Validation
Sc√©narios de Test
-1) Utilisation L√©gitime : PowerPoint ouvrant une pr√©sentation normale
- 2) Activit√© Admin : PowerPoint avec scripts d'automatisation
-3) Attaque Simul√©e : Utiliser une simulation d'exploit contr√¥l√©e

### R√©sultats Attendus
- ‚úÖ Utilisation l√©gitime de PowerPoint : Aucune alerte
- ‚úÖ D√©pannage administrateur : Alertes minimales (filtr√©es)
- üö® Exploitation r√©elle : Alertes haute confiance
