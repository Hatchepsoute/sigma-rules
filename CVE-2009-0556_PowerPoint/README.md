# üö® Sigma rule: detecting CVE-2009-0556 PowerPoint exploitation
üëâüèæ  [**French version available  here** ](README_FR.md)
## üìã Overview
This Sigma rule detects potential exploitation attempts targeting **CVE-2009-0556**, a critical memory corruption vulnerability in Microsoft PowerPoint that allows remote code execution via specially crafted presentation files.

## üéØ What does this rule detect?
- **Suspicious child processes** spawned by `POWERPNT.EXE`
- **Common post-exploitation behaviors** when PowerPoint is compromised
- **Indicators of memory corruption exploitation** leading to arbitrary code execution

## üîß Technical details

### Vulnerability Background
- **CVE ID**: CVE-2009-0556
- **CVSS Score**: 9.3 (HIGH) - CVSS 2.0
- **Affected Software**:
  - PowerPoint 2000 SP3
  - PowerPoint 2002 SP3  
  - PowerPoint 2003 SP3
  - Office 2004 for Mac
- **Attack Vector**: Malformed `OutlineTextRefAtom` structure in PowerPoint files

### Detection logic
1. PowerPoint opens a presentation file (.ppt, .pptx, .pps, etc.)
2. PowerPoint spawns a suspicious interpreter/executable
3. Common benign commands are filtered out

### Monitored child processes
| Process | Typical Malicious Use |
|---------|----------------------|
| `cmd.exe` | Command execution, payload staging |
| `powershell.exe` | PowerShell exploitation, encoded commands |
| `rundll32.exe` | DLL sideloading, code execution |
| `regsvr32.exe` | Squiblydoo attack, scriptlet execution |
| `wscript.exe` | VBScript/JScript execution |
| `mshta.exe` | HTML Application execution |

## ‚öôÔ∏è Configuration & deployment

### Prerequisites
- SIEM supporting Sigma rules (Elastic SIEM, Splunk, Azure Sentinel, etc.)
- Windows event logging enabled (Process Creation events)
- PowerShell logging (optional but recommended)

### Deployment steps
1. Convert Sigma rule to your SIEM's native format using [Sigma Converter](https://github.com/SigmaHQ/sigma)
2. Deploy the rule to your SIEM
3. Test with controlled scenarios
4. Monitor initial alerts and adjust thresholds as needed

## üé® Tuning & customization

### Reducing false positives
The rule includes built-in filters for common administrative commands:
- `/?` - Help system requests
- `echo ` - Debug commands (note the space)
- `Get-Help` - PowerShell help requests

### Increasing sensitivity
To make the rule more aggressive:
1. Remove `filter_benign_commands` section
2. Add time correlation: `within 30s`
3. Add network correlation (PowerPoint making outbound connections)

### Environment-specific adjustments
```yaml
# Add organization-specific trusted paths
filter_trusted_paths:
  Image|startswith:
    - 'D:\CorporateTools\'
    - '\\DFS\IT\Scripts\'
```
  ---
###    üìä Testing & validation
#### Test Scenarios
- **Legitimate Use**: PowerPoint opening a normal presentation
- **Admin Activity**: PowerPoint with automation scripts
- **Simulated Attack**: Use controlled exploit simulation

### Expected results
- ‚úÖ Legitimate PowerPoint usage: No alerts
- ‚úÖ Admin troubleshooting: Minimal alerts (filtered)
- üö® Actual exploitation: High-confidence alerts
---
**Author :** Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

