# üö® Sigma Rule: Detecting CVE-2009-0556 PowerPoint Exploitation

## üìã Overview
This Sigma rule detects potential exploitation attempts targeting **CVE-2009-0556**, a critical memory corruption vulnerability in Microsoft PowerPoint that allows remote code execution via specially crafted presentation files.

## üéØ What Does This Rule Detect?
- **Suspicious child processes** spawned by `POWERPNT.EXE`
- **Common post-exploitation behaviors** when PowerPoint is compromised
- **Indicators of memory corruption exploitation** leading to arbitrary code execution

## üîß Technical Details

### Vulnerability Background
- **CVE ID**: CVE-2009-0556
- **CVSS Score**: 9.3 (HIGH) - CVSS 2.0
- **Affected Software**:
  - PowerPoint 2000 SP3
  - PowerPoint 2002 SP3  
  - PowerPoint 2003 SP3
  - Office 2004 for Mac
- **Attack Vector**: Malformed `OutlineTextRefAtom` structure in PowerPoint files

### Detection Logic
-1) PowerPoint opens a presentation file (.ppt, .pptx, .pps, etc.)
-2) PowerPoint spawns a suspicious interpreter/executable
-3) Common benign commands are filtered out

### Monitored Child Processes
| Process | Typical Malicious Use |
|---------|----------------------|
| `cmd.exe` | Command execution, payload staging |
| `powershell.exe` | PowerShell exploitation, encoded commands |
| `rundll32.exe` | DLL sideloading, code execution |
| `regsvr32.exe` | Squiblydoo attack, scriptlet execution |
| `wscript.exe` | VBScript/JScript execution |
| `mshta.exe` | HTML Application execution |

## ‚öôÔ∏è Configuration & Deployment

### Prerequisites
- SIEM supporting Sigma rules (Elastic SIEM, Splunk, Azure Sentinel, etc.)
- Windows event logging enabled (Process Creation events)
- PowerShell logging (optional but recommended)

### Deployment Steps
1. Convert Sigma rule to your SIEM's native format using [Sigma Converter](https://github.com/SigmaHQ/sigma)
2. Deploy the rule to your SIEM
3. Test with controlled scenarios
4. Monitor initial alerts and adjust thresholds as needed

## üé® Tuning & Customization

### Reducing False Positives
The rule includes built-in filters for common administrative commands:
- `/?` - Help system requests
- `echo ` - Debug commands (note the space)
- `Get-Help` - PowerShell help requests

### Increasing Sensitivity
To make the rule more aggressive:
1. Remove `filter_benign_commands` section
2. Add time correlation: `within 30s`
3. Add network correlation (PowerPoint making outbound connections)

### Environment-Specific Adjustments

# Add organization-specific trusted paths

filter_trusted_paths:
  Image|startswith:
    - 'D:\CorporateTools\'
    - '\\DFS\IT\Scripts\'   
 
### üìä Testing & Validation
Test Scenarios
-1)   Legitimate Use: PowerPoint opening a normal presentation
-2)  Admin Activity: PowerPoint with automation scripts
-3) Simulated Attack: Use controlled exploit simulation
### Expected Results
‚úÖ Legitimate PowerPoint usage: No alerts
‚úÖ Admin troubleshooting: Minimal alerts (filtered)
üö® Actual exploitation: High-confidence alerts
