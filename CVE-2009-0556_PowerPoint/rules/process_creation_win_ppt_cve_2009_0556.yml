title: Suspicious Process Spawned From PowerPoint - Potential CVE-2009-0556 Exploit
id: 525a3d08-2230-49ae-98db-f665caca4f07
status: experimental
description: |
  Detects a suspicious child process spawned by Microsoft PowerPoint (POWERPNT.EXE), which is a common indicator  of exploitation of memory corruption vulnerabilities such as CVE-2009-0556. This vulnerability allows remote   code execution via a specially crafted PowerPoint file containing a malformed OutlineTextRefAtom structure.
  
  Détecte la création d'un processus enfant suspect lancé par Microsoft PowerPoint (POWERPNT.EXE), ce qui constitue un indicateur courant de l'exploitation de vulnérabilités de corruption mémoire, telles que la 
  CVE-2009-0556. Cette vulnérabilité permet l'exécution de code à distance via un fichier PowerPoint spécialement conçu contenant une structure OutlineTextRefAtom malformée.
references:
  - https://www.cve.org/CVERecord?id=CVE-2009-0556
  - https://nvd.nist.gov/vuln/detail/CVE-2009-0556
  - https://docs.microsoft.com/en-us/security-updates/securitybulletins/2009/ms09-017
author: Adama ASSIØNGBØN – SOC & CTI Analyst Consultant
date: 2026-01-10
modified: 2026-01-12
tags:
  - attack.execution
  - attack.t1204.002  # User Execution Malicious File
 # - cve.2009.0556
logsource:
  category: process_creation
  product: windows
detection:
  # Parent process: PowerPoint opening a presentation file
  parent_process:
    Image|endswith: '\POWERPNT.EXE'
    CommandLine|contains:
      - '.ppt'
      - '.pptx'
      - '.pps'
      - '.ppsx'
      - '.pot'
      - '.potx'
  
  # Suspicious child processes commonly used in exploitation chains
  suspicious_child:
    ParentImage|endswith: '\POWERPNT.EXE'
    Image|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
      - '\rundll32.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\mshta.exe'
      - '\certutil.exe'
  
  # Filter out benign administrative commands
  filter_benign_commands:
    CommandLine|contains:
      - '/?'                     # System help
      - 'echo '                  # Debug (note the space)
      - ' /c ping '              # Legitimate network test
      - 'Get-Help'               # PowerShell help
      - 'Out-Null'               # Silent command
      - 'Write-Host'             # Information display
  
  # Final condition - removed filter_trusted_paths as too restrictive
  condition: parent_process and suspicious_child and not filter_benign_commands
falsepositives:
  - Legitimate Office automation scripts (very rare)
  - Administrative troubleshooting where PowerPoint is used with benign commands
  - Security software scanning PowerPoint files
  - Note: Attackers could bypass detection by avoiding filtered arguments
level: high
