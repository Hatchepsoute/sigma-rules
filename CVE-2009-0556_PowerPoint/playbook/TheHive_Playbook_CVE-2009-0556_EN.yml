name: "CVE-2009-0556 | PowerPoint RCE - TheHive Playbook"
description: >
  TheHive-oriented incident response playbook for alerts indicating that Microsoft PowerPoint
  (POWERPNT.EXE) spawned a suspicious child process. This behavior may indicate exploitation
  of CVE-2009-0556, a known exploited memory corruption vulnerability allowing remote code
  execution via a crafted PowerPoint document.
severity: 3
tlp: "amber"
pap: "amber"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - thehive
customFields:
  cve_id:
    string: "CVE-2009-0556"
  kev_status:
    string: "CISA Known Exploited Vulnerability"
  detection_source:
    string: "Sigma / SIEM"
  mitre_attack:
    string: "T1204.002 - User Execution: Malicious File"
tasks:

  - title: "Triage - Validate alert context"
    group: "Triage"
    description: >
      Confirm that POWERPNT.EXE is the parent process and identify the spawned child process.
      Review command lines, host, user, timestamp, and confirm association with a PowerPoint file.
    mandatory: true

  - title: "Triage - Collect endpoint evidence"
    group: "Triage"
    description: >
      Collect endpoint telemetry including process tree, command lines, file paths,
      hashes of the PowerPoint document and spawned process, and adjacent events.
    mandatory: true

  - title: "Investigation - Analyze PowerPoint document"
    group: "Investigation"
    description: >
      Retrieve the PowerPoint file if permitted by policy. Compute hashes, extract metadata,
      and analyze in a sandbox or malware analysis platform to identify exploitation indicators.
    mandatory: true

  - title: "Investigation - CTI enrichment"
    group: "Investigation"
    description: >
      Enrich hashes, IPs, URLs, and domains using CTI platforms. Identify any association
      with known campaigns exploiting legacy Office vulnerabilities.
    mandatory: true

  - title: "Investigation - Post-exploitation activity"
    group: "Investigation"
    description: >
      Review logs for follow-on activity such as outbound network connections,
      file creation, LOLBin chaining, and persistence mechanisms.
    mandatory: true

  - title: "Containment - Scope and isolate"
    group: "Containment"
    description: >
      Identify additional impacted hosts or users and isolate affected endpoints
      if exploitation is suspected or confirmed.
    mandatory: false

  - title: "Eradication - Remove artifacts and mitigate"
    group: "Eradication"
    description: >
      Remove malicious artifacts, apply vendor patches or mitigations for legacy Office,
      and harden endpoints with EDR or application control policies.
    mandatory: false

  - title: "Recovery - Lessons learned"
    group: "Recovery"
    description: >
      Confirm system integrity, restore services if needed, document indicators,
      and update detection and response controls.
    mandatory: false

observables_to_add_suggestions:
  - type: "file"
    examples: ["malicious.ppt", "SHA256:<document_hash>"]
  - type: "process"
    examples: ["POWERPNT.EXE", "cmd.exe", "powershell.exe", "rundll32.exe"]
  - type: "ip"
    examples: ["<destination_ip>"]
  - type: "domain"
    examples: ["<malicious_domain>"]

