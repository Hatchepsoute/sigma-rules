name: "CVE-2009-0556 | PowerPoint RCE Exploitation - IR Playbook"
description: >
  Comprehensive incident response playbook for alerts indicating exploitation of CVE-2009-0556, a memory corruption vulnerability in Microsoft PowerPoint (2000-2003, 2004 Mac) that allows  remote code execution via crafted presentation files. This playbook aligns with Sigma rule  'Suspicious Process Spawned From PowerPoint - Potential CVE-2009-0556 Exploit'.
severity: 3
tlp: "amber"
pap: "amber"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - thehive
  - sigma
customFields:
  cve_id:
    string: "CVE-2009-0556"
  kev_status:
    string: "CISA Known Exploited Vulnerability (added 2026-01-07)"
  detection_source:
    string: "Sigma Rule ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  mitre_attack:
    string: "T1204.002 - User Execution: Malicious File | T1137 - Office Application Startup"
  exploit_complexity:
    string: "Low"
  affected_versions:
    string: "PowerPoint 2000 SP3, 2002 SP3, 2003 SP3, Office 2004 for Mac"
  patch_available:
    string: "MS09-017 (May 2009)"
  sigma_rule_status:
    string: "Experimental"

tasks:
  # Triage Phase (First 30 minutes)
  - title: "T1 - Validate alert & initial context"
    group: "Triage"
    status: "Waiting"
    description: >
      Confirm POWERPNT.EXE is parent and spawned a suspicious interpreter (cmd, powershell, etc.).
      Review: Process command lines, hostname, user, timestamp, associated PowerPoint file.
    flag: true
    procedure: |
      1. Verify ParentImage contains '\POWERPNT.EXE'
      2. Verify child is suspicious (powershell.exe, cmd.exe, rundll32.exe, regsvr32.exe)
      3. Check ParentCommandLine contains PowerPoint extension (.ppt, .pptx, .pps, .pot)
      4. Note if child NOT from C:\Windows\System32\ or C:\Program Files\
      
  - title: "T2 - Collect endpoint evidence"
    group: "Triage"
    status: "Waiting"
    description: >
      Collect process tree, command lines, file paths, hashes of PowerPoint document  and spawned process, plus adjacent security events (network, registry, file).
    flag: true

  # Investigation Phase (Next 2-4 hours)
  - title: "I1 - Retrieve & analyze PowerPoint document"
    group: "Investigation"
    status: "Waiting"
    description: >
      If policy permits, retrieve the PowerPoint file. Compute hashes, extract metadata,  analyze for malformed OutlineTextRefAtom structures indicative of CVE-2009-0556.
    procedure: |
      1. Extract file from endpoint or email attachment
      2. Compute MD5, SHA1, SHA256: `sha256sum malicious.ppt`
      3. Analyze with tools: oledump.py, officeparser, oletools
      4. Search for 'OutlineTextRefAtom' in binary/hex
      5. Submit to sandbox/VirusTotal if external analysis needed

  - title: "I2 - CTI enrichment & campaign correlation"
    group: "Investigation"
    status: "Waiting"
    description: >
      Enrich file hashes, IPs, domains in Threat Intelligence platforms.
      Check for associations with known campaigns (e.g., Exploit:Win32/Apptom.gen).
    
  - title: "I3 - Hunt for post-exploitation activity"
    group: "Investigation"
    status: "Waiting"
    description: >
      Search logs for: Outbound connections, file creations in temp paths,
      LOLBin usage (certutil, bitsadmin), persistence mechanisms (scheduled tasks, run keys).
    procedure: |
      Common post-exploitation to hunt for:
      - Network: Connections within 5 min of alert, especially to uncommon ports
      - Files: New executables in %TEMP%, %APPDATA%, Public directories
      - Persistence: New scheduled tasks, services, registry Run keys

  # Containment & Eradication
  - title: "C1 - Scope impact & isolate if confirmed"
    group: "Containment"
    status: "Waiting"
    description: >
      Identify additional impacted hosts/users via logs. If exploitation is confirmed,  isolate endpoint from network to prevent lateral movement/data exfiltration.

  - title: "E1 - Apply patches & remove artifacts"
    group: "Eradication"
    status: "Waiting"
    description: >
      Apply Microsoft patch MS09-017 if legacy systems exist. Remove malicious files, registry entries, scheduled tasks. Consider application whitelisting for Office.

  # Communication & Recovery
  - title: "COM1 - Notify stakeholders"
    group: "Communication"
    status: "Waiting"
    description: >
      Notify security management, IT operations, and affected business unit.
      Prepare initial incident report.
    template: |
      Template available in TheHive Templates -> "Incident Notification - PowerPoint Exploitation"

  - title: "R1 - Lessons learned & control improvement"
    group: "Recovery"
    status: "Waiting"
    description: >
      Document IOCs, update detection rules, assess need for legacy Office upgrade, review email/web filtering for malicious attachments.

# Typical observables from this attack
observables_to_add_suggestions:
  - type: "file"
    tags: ["malicious", "powerpoint", "document"]
    examples: ["exploit.ppt", "presentation.pps", "SHA256:a1b2c3..."]
  - type: "process"
    tags: ["lolbin", "interpreter"]
    examples: ["POWERPNT.EXE", "cmd.exe", "powershell.exe", "rundll32.exe"]
  - type: "ip"
    tags: ["callback", "c2"]
    examples: ["192.0.2.100", "203.0.113.50"]
  - type: "domain"
    tags: ["malicious", "c2"]
    examples: ["malicious-domain.tld", "download.evil[.]com"]
# Ajouter dans description ou customFields
references:
  - "Sigma Rule ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  - "https://github.com/Hatchepsoute/sigma-rules/blob/main/CVE-2009-0556_PowerPoint/rules/process_creation_win_ppt_cve_2009_0556.yml"
