name: "CVE-2009-0556 | Exploitation RCE PowerPoint - Playbook TheHive"
description: >
  Playbook de réponse aux incidents pour les alertes indiquant que Microsoft PowerPoint (POWERPNT.EXE) a lancé un processus enfant suspect. Ce comportement peut indiquer  l'exploitation de la CVE-2009-0556, une vulnérabilité de corruption mémoire exploitée  activement permettant l'exécution de code à distance via un document PowerPoint conçu à cet effet.
severity: 3
tlp: "amber"
pap: "amber"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - thehive
  - sigma
customFields:
  cve_id:
    string: "CVE-2009-0556"
  kev_status:
    string: "Vulnérabilité Exploitée Connue CISA (ajoutée le 07/01/2026)"
  detection_source:
    string: "Règle Sigma ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  mitre_attack:
    string: "T1204.002 - Exécution Utilisateur: Fichier Malveillant | T1137 - Démarrage Application Office"
  exploit_complexite:
    string: "Faible"
  versions_affectees:
    string: "PowerPoint 2000 SP3, 2002 SP3, 2003 SP3, Office 2004 pour Mac"
  correctif_disponible:
    string: "MS09-017 (Mai 2009)"
  statut_regle_sigma:
    string: "Expérimental"

tasks:
  # Phase de Triage (Premières 30 minutes)
  - title: "T1 - Validation de l'alerte & contexte initial"
    group: "Triage"
    status: "Waiting"
    description: >
      Confirmer que POWERPNT.EXE est le parent et a lancé un interpréteur suspect
      (cmd, powershell, etc.). Examiner : lignes de commande, hôte, utilisateur,
      horodatage, fichier PowerPoint associé.
    flag: true
    procedure: |
      1. Vérifier que ParentImage contient '\POWERPNT.EXE'
      2. Vérifier que l'enfant est suspect (powershell.exe, cmd.exe, rundll32.exe, regsvr32.exe)
      3. Vérifier que ParentCommandLine contient une extension PowerPoint (.ppt, .pptx, .pps, .pot)
      4. Noter si l'enfant ne vient PAS de C:\Windows\System32\ ou C:\Program Files\
      
  - title: "T2 - Collecte de preuves sur le poste"
    group: "Triage"
    status: "Waiting"
    description: >
      Collecter l'arborescence des processus, lignes de commande, chemins de fichiers,   empreintes du document PowerPoint et du processus lancé, plus les événements  de sécurité adjacents (réseau, registre, fichiers).
    flag: true

  # Phase d'Investigation (2-4 heures suivantes)
  - title: "I1 - Récupération & analyse du document PowerPoint"
    group: "Investigation"
    status: "Waiting"
    description: >
      Si la politique le permet, récupérer le fichier PowerPoint. Calculer les empreintes,
      extraire les métadonnées, analyser les structures OutlineTextRefAtom malformées
      indicatrices de la CVE-2009-0556.
    procedure: |
      1. Extraire le fichier depuis le poste ou la pièce jointe email
      2. Calculer MD5, SHA1, SHA256 : `sha256sum malicious.ppt`
      3. Analyser avec outils : oledump.py, officeparser, oletools
      4. Rechercher 'OutlineTextRefAtom' dans le binaire/hexadécimal
      5. Soumettre à un bac à sable/VirusTotal si analyse externe nécessaire

  - title: "I2 - Enrichissement CTI & corrélation de campagne"
    group: "Investigation"
    status: "Waiting"
    description: >
      Enrichir les empreintes de fichiers, IPs, domaines dans les plateformes de  Threat Intelligence. Vérifier les associations avec des campagnes connues   (ex : Exploit:Win32/Apptom.gen).
    
  - title: "I3 - Recherche d'activité post-exploitation"
    group: "Investigation"
    status: "Waiting"
    description: >
      Rechercher dans les logs : connexions sortantes, créations de fichiers dans les chemins temporaires, utilisation de LOLBins (certutil, bitsadmin),  mécanismes de persistance (tâches planifiées, clés Run).
    procedure: |
      Activités post-exploitation courantes à rechercher :
      - Réseau : Connexions dans les 5 min après l'alerte, surtout vers ports inhabituels
      - Fichiers : Nouveaux exécutables dans %TEMP%, %APPDATA%, répertoires Public
      - Persistance : Nouvelles tâches planifiées, services, clés de registre Run

  # Confinement & Éradication
  - title: "C1 - Évaluer l'impact & isoler si confirmé"
    group: "Confinement"
    status: "Waiting"
    description: >
      Identifier les hôtes/utilisateurs impactés supplémentaires via les logs.
      Si l'exploitation est confirmée, isoler le poste du réseau pour empêcher
      les mouvements latéraux/l'exfiltration de données.

  - title: "E1 - Appliquer correctifs & supprimer artefacts"
    group: "Éradication"
    status: "Waiting"
    description: >
      Appliquer le correctif Microsoft MS09-017 si des systèmes hérités existent. 
      Supprimer les fichiers malveillants, entrées de registre, tâches planifiées.
      Envisager la mise en liste blanche d'applications pour Office.

  # Communication & Récupération
  - title: "COM1 - Notifier les parties prenantes"
    group: "Communication"
    status: "Waiting"
    description: >
      Notifier la direction sécurité, les opérations IT, et l'unité métier affectée.
      Préparer le rapport d'incident initial.
    template: |
      Modèle disponible dans TheHive Templates -> "Notification Incident - Exploitation PowerPoint"

  - title: "R1 - Retours d'expérience & amélioration des contrôles"
    group: "Récupération"
    status: "Waiting"
    description: >
      Documenter les IOCs, mettre à jour les règles de détection, évaluer le besoin de mise à niveau des versions Office héritées, revoir le filtrage email/web pour les pièces jointes malveillantes.

# Observables typiques de cette attaque
observables_to_add_suggestions:
  - type: "file"
    tags: ["malveillant", "powerpoint", "document"]
    examples: ["exploit.ppt", "presentation.pps", "SHA256:a1b2c3..."]
  - type: "process"
    tags: ["lolbin", "interpréteur"]
    examples: ["POWERPNT.EXE", "cmd.exe", "powershell.exe", "rundll32.exe"]
  - type: "ip"
    tags: ["callback", "c2"]
    examples: ["192.0.2.100", "203.0.113.50"]
  - type: "domain"
    tags: ["malveillant", "c2"]
    examples: ["malicious-domain.tld", "download.evil[.]com"]
references:
  - "Sigma Rule ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  - "https://github.com/Hatchepsoute/sigma-rules/blob/main/CVE-2009-0556_PowerPoint/rules/process_creation_win_ppt_cve_2009_0556.yml"
