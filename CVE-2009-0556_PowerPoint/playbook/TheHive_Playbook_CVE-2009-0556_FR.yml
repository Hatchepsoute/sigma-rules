name: "CVE-2009-0556 / PowerPoint RCE - Suspicious Child Process"
description: >
  Triage et réponse à une alerte indiquant qu'un processus enfant suspect (cmd/powershell/rundll32/regsvr32)
  a été lancé depuis Microsoft PowerPoint (POWERPNT.EXE) lors de l'ouverture/enregistrement d'un fichier
  de présentation. Risque: exploitation RCE (CVE-2009-0556) via document malveillant.
severity: 3            # 1=low,2=medium,3=high,4=critical (adapter à ton modèle)
tlp: "amber"
pap: "amber"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - user-execution
  - sigma
customFields:
  detection_rule_id:
    string: "525a3d08-2230-49ae-98db-f665caca4f07"
  detection_source:
    string: "SIEM/Sigma"
  mitre:
    string: "T1204.002 (User Execution: Malicious File)"
tasks:

  - title: "T1 - Qualification de l'alerte"
    group: "Triage"
    description: >
      Confirmer le contexte: POWERPNT.EXE parent, commande associée à un fichier .ppt/.pps/.pot,
      et identifier le processus enfant (cmd/powershell/rundll32/regsvr32), l'utilisateur, l'hôte, l'heure.
      Objectif: valider que c'est bien PowerPoint qui a spawn le processus, et non un artefact de collecte.
    mandatory: true

  - title: "T2 - Collecte rapide des preuves (host)"
    group: "Triage"
    description: >
      Collecter: CommandLine parent et enfant, Parent/Child PID, hashes du binaire enfant et du document,
      chemin du document, signer/éditeur, horodatage (creation/modification), et events voisins (±10 min).
      Sources typiques: Sysmon (EID 1/7/11/3), Security 4688, EDR telemetry.
    mandatory: true

  - title: "T3 - Analyse du document PowerPoint (artefact)"
    group: "Investigation"
    description: >
      Récupérer le fichier PPT/PPS/POT (si politique OK), calculer hash (SHA256),
      exécuter sandbox interne/VT si autorisé, extraire metadata (OLE/ZIP structure),
      rechercher contenus anormaux, macros (même si CVE est memory corruption), objets intégrés.
    mandatory: true

  - title: "T4 - Enrichissement CTI & réputation"
    group: "Investigation"
    description: >
      Enrichir hash du document et des binaires droppés/chargés, URLs/domains/IPs,
      vérifier correspondances campagnes connues, et rechercher l'existence d'autres victimes internes
      (même hash/nom de fichier/expéditeur).
    mandatory: true

  - title: "T5 - Vérification post-exploitation (comportements)"
    group: "Investigation"
    description: >
      Chercher: connexions sortantes inhabituelles (Sysmon EID 3), création de fichiers (EID 11),
      persistance (Run keys, scheduled tasks, services), injection/chargement DLL (EID 7),
      utilisation de LOLBins supplémentaires (mshta/wscript/certutil/bitsadmin).
    mandatory: true

  - title: "T6 - Scoping (étendue) & hunting"
    group: "Containment"
    description: >
      Étendre la recherche à tout l'environnement:
      - événements 'POWERPNT.EXE' spawn process suspect sur 30-90 jours
      - mêmes noms de fichiers, mêmes hash, même expéditeur/email
      - autres hôtes du même utilisateur.
    mandatory: true

  - title: "C1 - Containment immédiat"
    group: "Containment"
    description: >
      Si suspicion forte/confirmée:
      - isoler l'hôte (EDR)
      - bloquer hash/URL/domain/IP associés
      - mettre en quarantaine le document et empêcher sa diffusion interne
      - révoquer sessions si compromission probable.
    mandatory: false

  - title: "E1 - Remédiation & patching (legacy Office)"
    group: "Eradication"
    description: >
      Vérifier versions Office/PowerPoint concernées (legacy), appliquer correctifs vendor,
      désactiver/limiter composants obsolètes, durcir: ASR rules/EDR policies, blocage OLE/Active content
      selon baselines, et supprimer/quarantaine artefacts persistants.
    mandatory: false

  - title: "R1 - Rétablissement & leçons"
    group: "Recovery"
    description: >
      Restaurer si besoin, valider absence de persistance, documenter IoCs/TTPs,
      ajuster les règles (Sigma/SIEM) et sensibiliser sur documents Office suspects.
    mandatory: false

observables_to_add_suggestions:
  - type: "file"
    examples: ["document.ppt", "document.ppsx", "SHA256:<hash>"]
  - type: "process"
    examples: ["POWERPNT.EXE", "cmd.exe", "powershell.exe", "rundll32.exe", "regsvr32.exe"]
  - type: "ip"
    examples: ["<dest_ip_if_any>"]
  - type: "domain"
    examples: ["<domain_if_any>"]

