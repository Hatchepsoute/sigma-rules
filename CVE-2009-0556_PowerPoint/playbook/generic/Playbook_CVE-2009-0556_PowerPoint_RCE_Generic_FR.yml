name: "CVE-2009-0556 | PowerPoint RCE - Processus Enfant Suspect"
description: >
  Playbook de réponse aux incidents pour les alertes indiquant que Microsoft PowerPoint (POWERPNT.EXE)  a lancé un processus enfant suspect. Ce comportement peut indiquer une exploitation de la CVE-2009-0556,
  une vulnérabilité de corruption mémoire permettant l'exécution de code à distance via un fichier PowerPoint  spécialement conçu.
id: IR-PLAY-005
version: "2.0"
created: "2026-01-12"
owner: "Équipe CSIRT"
last_updated: "2026-01-13"
severity: 3
tlp: "amber"
pap: "amber"
classification: "RCE - Office Exploit"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - sigma
  - legacy-exploit
  - memory-corruption
  - process-injection
references:
  - "Bulletin Microsoft MS09-017"
  - "CISA KEV Catalog: CVE-2009-0556"
  - "MITRE ATT&CK: T1204.002"
  - "Sigma Rule ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  - "https://github.com/Hatchepsoute/sigma-rules/blob/main/CVE-2009-0556_PowerPoint/rules/process_creation_win_ppt_cve_2009_0556.yml"

customFields:
  cve_id:
    string: "CVE-2009-0556"
  detection_type:
    string: "Anomalie de Création de Processus"
  mitre_attack:
    string: "T1204.002 - User Execution: Malicious File"
  mitre_technique_id:
    string: "T1204.002"
  kev_catalog:
    boolean: true
  affected_software:
    string: "Microsoft PowerPoint 2000, 2002, 2003, 2007"
  sigma_rule_id:
    string: "525a3d08-2230-49ae-98db-f665caca4f07"

prerequisites:
  teams_involved:
    - "SOC (Niveau 1/2)"
    - "Équipe CSIRT"
    - "Administration Système"
    - "Équipe Juridique"
    - "Communication"
  tools_required:
    endpoint_collection: ["EDR", "Sysmon", "Windows Event Logs", "PowerShell"]
    analysis: ["Sandbox interne", "VirusTotal", "Hybrid-Analysis", "ANY.RUN"]
    cti: ["MISP", "ThreatConnect", "AlienVault OTX"]
    documentation: ["SIEM", "Système de ticketing", "Wiki interne"]
  access_required:
    - "Accès aux logs des endpoints concernés"
    - "Droits d'administration sur les hôtes"
    - "Accès aux plateformes de CTI"
    - "Accès au système de quarantaine"

workflow:
  phases:
    - name: "Phase 1 - Tri & Validation"
      tasks:
        - id: "T1"
          title: "Validation Initiale de l'Alerte"
          description: "Confirmer que l'alerte concerne bien PowerPoint lançant un processus enfant suspect"
          estimated_time: "≤ 15 min"
          owner: "Analyste SOC Niveau 1"
          mandatory: true
          actions:
            - "Vérifier que le processus parent est POWERPNT.EXE"
            - "Confirmer hôte, utilisateur et horodatage"
            - "Examiner la relation parent-enfant des processus"
            - "Analyser les lignes de commande associées"
            - "Consulter les alertes similaires récentes"
          validation_criteria:
            - "PowerPoint.exe lance un processus inhabituel (cmd, powershell, rundll32, etc.)"
            - "L'utilisateur n'a pas initié volontairement cette action"
            - "L'activité correspond aux heures de bureau normales"
          commands:
            powershell:
              - "Get-Process -Name POWERPNT -IncludeUserName"
              - "Get-CimInstance -ClassName Win32_Process | Where-Object {$_.ParentProcessId -eq [PID_POWERPNT]} | Select-Object Name, ProcessId, CommandLine"

        - id: "T2"
          title: "Collecte de Preuves Initiales"
          description: "Collecter les données essentielles pour l'investigation"
          estimated_time: "≤ 30 min"
          owner: "Analyste SOC Niveau 2"
          mandatory: true
          data_to_collect:
            process_data:
              - "PID parent et enfant"
              - "Lignes de commande complètes"
              - "Hachages des exécutables (MD5, SHA1, SHA256)"
              - "Chemin d'accès complet"
            document_data:
              - "Chemin du fichier .ppt/.pptx"
              - "Hachages du document"
              - "Métadonnées (auteur, date de création)"
              - "Source du document"
            temporal_context:
              - "Événements ±10 minutes autour de l'incident"
              - "Logs d'ouverture de fichier"
              - "Connexions réseau simultanées"
          tools_recommended:
            - "EDR (CrowdStrike, SentinelOne, Microsoft Defender)"
            - "Sysmon (Event ID 1 - Process Creation)"
            - "Velociraptor pour collecte approfondie"
            - "KAPE pour forensic léger"

    - name: "Phase 2 - Investigation Approfondie"
      tasks:
        - id: "T3"
          title: "Analyse du Document Suspect"
          description: "Déterminer si le document PowerPoint est malveillant"
          estimated_time: "≤ 2 heures"
          owner: "Analyste Malware"
          mandatory: true
          procedure:
            quarantine: "Isoler le document immédiatement"
            static_analysis:
              - "Calculer les hachages (SHA256, MD5)"
              - "Extraire les métadonnées avec oledump.py"
              - "Rechercher des macros suspectes"
              - "Examiner les objets OLE intégrés"
            dynamic_analysis:
              - "Soumettre à une sandbox interne"
              - "Analyser le comportement en environnement isolé"
              - "Capturer les indicateurs d'exploitation"
            vt_check: "Vérifier sur VirusTotal"
          tools:
            - "oledump.py"
            - "officeparser"
            - "Sandbox interne"
            - "VirusTotal API"

        - id: "T4"
          title: "Enrichissement par Threat Intelligence"
          description: "Contextualiser les indicateurs avec des sources CTI"
          estimated_time: "≤ 45 min"
          owner: "Analyste Threat Intelligence"
          mandatory: true
          cti_sources:
            hashes: ["VirusTotal", "Hybrid-Analysis", "MalwareBazaar"]
            domains_ip: ["AlienVault OTX", "AbuseIPDB", "Shodan"]
            campaigns: ["MITRE ATT&CK", "Unit42", "Mandiant"]
            vulnerabilities: ["CISA KEV", "NVD", "Exploit-DB"]
          key_questions:
            - "L'exploit est-il connu dans des campagnes APT ?"
            - "Y a-t-il des clusters d'attaques similaires ?"
            - "Des IOCs réutilisés ?"

        - id: "T5"
          title: "Recherche d'Activités Post-Exploitation"
          description: "Identifier les actions adverses subséquentes"
          estimated_time: "≤ 1 heure"
          owner: "Analyste IR"
          mandatory: true
          scenarios_to_investigate:
            - activity: "C2 Communication"
              detection: "Firewall logs, DNS queries"
              evidence: "Connexions vers IP suspectes"
            - activity: "Lateral Movement"
              detection: "Logs d'authentification"
              evidence: "RDP, SMB, WMI depuis l'hôte"
            - activity: "Persistence"
              detection: "Registry, Services, Scheduled Tasks"
              evidence: "Nouvelles entrées Run/Startup"
            - activity: "Data Exfiltration"
              detection: "Data transfer logs"
              evidence: "Uploads volumineux, archives"
          commands:
            powershell:
              - "Get-NetTCPConnection | Where-Object {$_.OwningProcess -eq [PID_ENFANT]}"
              - "Get-ScheduledTask | Where-Object {$_.TaskPath -like '*\\*'} | Select-Object TaskName, State"
              - "Get-ItemProperty -Path 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -ErrorAction SilentlyContinue"

    - name: "Phase 3 - Évaluation de l'Étendue"
      tasks:
        - id: "T6"
          title: "Recherche d'Activités Similaires"
          description: "Identifier tous les systèmes potentiellement affectés"
          estimated_time: "≤ 2 heures"
          owner: "Lead IR"
          mandatory: true
          search_criteria:
            by_hash: "Recherche par hachage de document"
            by_behavior: "PowerPoint lançant cmd/powershell/rundll32"
            by_source: "Documents provenant de la même source email"
            time_window: "30-90 jours en arrière"
          siem_query_example: |
            index=endpoint EventCode=1 
            | search ParentImage="*POWERPNT.EXE" 
            | stats count by host, user, CommandLine

    - name: "Phase 4 - Confinement"
      tasks:
        - id: "C1"
          title: "Actions de Confinement Immédiates"
          description: "Limiter l'impact et prévenir la propagation"
          estimated_time: "≤ 1 heure"
          owner: "Administrateur Système"
          mandatory: false
          trigger: "Si exploitation confirmée"
          actions:
            - "Isoler l'hôte du réseau (VLAN quarantine)"
            - "Bloquer les IOCs dans tous les systèmes"
            - "Mettre en quarantaine le document sur tous les systèmes"
            - "Révoquer les sessions de l'utilisateur concerné"
            - "Configurer des alertes de monitoring supplémentaires"
          edr_rule_example: |
            rule: Block_Suspicious_PowerPoint_Children
            action: block
            conditions:
              parent_process: POWERPNT.EXE
              child_process: 
                - cmd.exe
                - powershell.exe
                - rundll32.exe
                - wscript.exe

    - name: "Phase 5 - Éradication"
      tasks:
        - id: "E1"
          title: "Nettoyage et Mesures Correctives"
          description: "Supprimer les artefacts malveillants et appliquer les correctifs"
          estimated_time: "≤ 4 heures"
          owner: "Équipe Sécurité + Administration"
          mandatory: false
          trigger: "Si exploitation confirmée"
          eradication_actions:
            - "Suppression du document malveillant"
            - "Nettoyage des fichiers créés par le payload"
            - "Suppression des entrées de registre malveillantes"
            - "Suppression des tâches planifiées suspectes"
          patch_verification:
            powershell: "Get-HotFix -Id KB957789, KB969618"
          compensating_controls:
            - "Activer Attack Surface Reduction (ASR) rules"
            - "Bloquer les macros Office d'Internet"
            - "Mettre en œuvre Application Whitelisting"
            - "Renforcer les politiques de restriction logicielle"
          workaround_registry: |
            Windows Registry Editor Version 5.00
            [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\Security]
            "DisablePowerPointFileValidation"=dword:00000001

    - name: "Phase 6 - Rétablissement"
      tasks:
        - id: "R1"
          title: "Retour à la Normale Sécurisé"
          description: "Valider l'intégrité et réintégrer les systèmes"
          estimated_time: "Variable"
          owner: "Équipe Opérations"
          mandatory: false
          validation_checklist:
            - "Scan antivirus complet"
            - "Vérification des checksums système"
            - "Audit des comptes et permissions"
            - "Analyse mémoire pour rootkits"
          reintegration_steps:
            - "Réintégrer l'hôte en surveillance accrue"
            - "Monitorer étroitement pendant 7 jours"
            - "Configurer des alertes spécifiques pour l'hôte"
          restoration_options:
            - "Restauration depuis backup propre"
            - "Rebuild complet si compromission avérée"

    - name: "Phase 7 - Documentation"
      tasks:
        - id: "R2"
          title: "Rapport et Leçons Apprises"
          description: "Capitaliser sur l'incident pour amélioration continue"
          estimated_time: "≤ 3 jours"
          owner: "Lead IR + Manager SOC"
          mandatory: false
          report_template: |
            # Rapport d'Incident - CVE-2009-0556
            ## Résumé
            - Date: [Date]
            - Hôte(s) affecté(s): [Liste]
            - Impact: [Low/Medium/High]
            - Statut: [Résolu/En cours]
            
            ## Chronologie
            - T0-10min: Détection initiale
            - T0+30min: Validation et tri
            - T0+2h: Investigation approfondie
            - T0+4h: Confinement appliqué
            - T0+24h: Éradication complète
            
            ## Indicateurs de Compromission (IOCs)
            ### Fichiers
            - Document: [hash], [nom]
            - Payload: [hash], [chemin]
            
            ### Réseau
            - IPs: [list]
            - Domaines: [list]
            
            ## Correctifs Appliqués
            1. [Correctif 1]
            2. [Correctif 2]
            
            ## Recommandations d'Amélioration
            1. [Amélioration détection]
            2. [Amélioration prévention]
            3. [Amélioration processus]

observables_to_add:
  - type: "file"
    examples: 
      - "suspicious.ppt"
      - "presentation_malveillante.pptx"
      - "SHA256:<document_hash>"
  - type: "process"
    examples:
      - "POWERPNT.EXE"
      - "cmd.exe"
      - "powershell.exe"
      - "rundll32.exe"
      - "wscript.exe"
      - "cscript.exe"
  - type: "ip"
    examples: ["<destination_ip>", "<c2_server_ip>"]
  - type: "domain"
    examples: ["<malicious_domain>", "<download_domain>"]
  - type: "registry_key"
    examples: 
      - "HKLM\\Software\\Microsoft\\Office\\..."
      - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"

metrics:
  kpis_to_track:
    - "MTTA (Mean Time to Acknowledge): < 15 min"
    - "MTTR (Mean Time to Respond): < 2 heures"
    - "MTTC (Mean Time to Contain): < 4 heures"
    - "Nombre d'hôtes affectés"
    - "Source de l'infection (email, web, USB)"
  dashboard_query: |
    index=endpoint (EventCode=1 OR EventCode=3) 
    | search ParentImage="*POWERPNT.EXE" 
    | timechart count by host span=1h

communication_protocol:
  internal:
    immediate: "Channel #incident-response, appel conférence"
    after_1h: "Email au RSSI et direction"
    after_4h: "Point de situation écrit"
    closure: "Rapport complet distribué"
  external:
    - "Autorité légale (ANSSI, etc.) - si requis"
    - "Clients affectés - selon contrat"
    - "Assurance cyber - si déclenchement"

testing_exercise:
  frequency: "Semi-annuelle"
  duration: "2 heures"
  participants: ["SOC", "CSIRT", "Administrateurs"]
  scenario: "Injecter une alerte simulée et suivre le playbook"
  evaluation_criteria:
    - "Complétion des tâches obligatoires"
    - "Respect des délais estimés"
    - "Qualité de la documentation produite"
    - "Efficacité de la communication"

approval:
  name: "___________________"
  position: "RSSI"
  date: "___________________"
  signature: "___________________"

review_schedule:
  next_review: "6 mois"
  next_review_date: "[Date]"

disclaimer: "Ce playbook est la propriété de l'organisation. Toute reproduction ou distribution non autorisée est interdite."
