name: "CVE-2009-0556 | PowerPoint RCE - Suspicious Child Process (Generic)"
description: >
  Generic incident response playbook for alerts indicating that Microsoft PowerPoint (POWERPNT.EXE)
  spawned a suspicious child process. This behavior may indicate exploitation of CVE-2009-0556,
  a memory corruption vulnerability allowing remote code execution via a crafted PowerPoint file.
severity: 3
tlp: "amber"
pap: "amber"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - sigma
customFields:
  cve_id:
    string: "CVE-2009-0556"
  detection_type:
    string: "Process Creation Anomaly"
  mitre_attack:
    string: "T1204.002 - User Execution: Malicious File"
tasks:

  - title: "T1 - Alert validation"
    group: "Triage"
    description: >
      Validate that the alert is related to Microsoft PowerPoint (POWERPNT.EXE) spawning
      a suspicious child process. Confirm host, user, timestamp, parent/child process
      relationship and associated command lines.
    mandatory: true

  - title: "T2 - Evidence collection (endpoint)"
    group: "Triage"
    description: >
      Collect endpoint telemetry: parent and child command lines, process IDs,
      PowerPoint document path, hashes (document and child process),
      and surrounding events (+/- 10 minutes).
    mandatory: true

  - title: "T3 - Malicious document analysis"
    group: "Investigation"
    description: >
      Retrieve the PowerPoint document if allowed by policy. Compute file hashes,
      extract metadata, and analyze in an internal sandbox or trusted malware
      analysis platform to identify exploitation indicators.
    mandatory: true

  - title: "T4 - Threat intelligence enrichment"
    group: "Investigation"
    description: >
      Enrich document and process hashes, domains, URLs, and IP addresses using
      CTI platforms. Check if indicators are associated with known campaigns
      exploiting legacy Office vulnerabilities.
    mandatory: true

  - title: "T5 - Post-exploitation activity check"
    group: "Investigation"
    description: >
      Review logs for follow-on behavior: outbound network connections,
      file creation in user-writable directories, LOLBin chaining,
      persistence mechanisms (Run keys, scheduled tasks, services).
    mandatory: true

  - title: "T6 - Scope assessment"
    group: "Containment"
    description: >
      Perform environment-wide search for similar activity:
      PowerPoint spawning suspicious processes, identical document hashes,
      same user or email source, across the last 30 to 90 days.
    mandatory: true

  - title: "C1 - Containment actions"
    group: "Containment"
    description: >
      If exploitation is suspected or confirmed:
      isolate the affected host, block related indicators,
      quarantine the malicious document, and restrict further execution.
    mandatory: false

  - title: "E1 - Eradication and mitigation"
    group: "Eradication"
    description: >
      Remove malicious artifacts, ensure legacy Office components are patched
      or decommissioned, and apply compensating controls such as
      EDR rules, Office hardening, or application whitelisting.
    mandatory: false

  - title: "R1 - Recovery and lessons learned"
    group: "Recovery"
    description: >
      Validate system integrity, restore services if needed,
      document indicators and detection gaps, and improve
      detection and prevention controls.
    mandatory: false

observables_to_add_suggestions:
  - type: "file"
    examples: ["malicious.ppt", "SHA256:<document_hash>"]
  - type: "process"
    examples: ["POWERPNT.EXE", "cmd.exe", "powershell.exe", "rundll32.exe"]
  - type: "ip"
    examples: ["<destination_ip>"]
  - type: "domain"
    examples: ["<malicious_domain>"]

