name: "CVE-2009-0556 | PowerPoint RCE - Suspicious Child Process"
description: >
  Incident response playbook for alerts indicating Microsoft PowerPoint (POWERPNT.EXE)
  spawned a suspicious child process. This behavior may indicate exploitation of CVE-2009-0556,
  a memory corruption vulnerability allowing remote code execution via a crafted PowerPoint file.
id: IR-PLAY-005
version: "2.0"
created: "2026-01-12"
owner: "CSIRT Team"
last_updated: "2026-01-13"
severity: 3
tlp: "amber"
pap: "amber"
classification: "RCE - Office Exploit"
tags:
  - cve-2009-0556
  - powerpoint
  - office
  - rce
  - kev
  - sigma
  - legacy-exploit
  - memory-corruption
  - process-injection
references:
  - "Microsoft Security Bulletin MS09-017"
  - "CISA KEV Catalog: CVE-2009-0556"
  - "MITRE ATT&CK: T1204.002"
  - "Sigma Rule ID: 525a3d08-2230-49ae-98db-f665caca4f07"
  - "https://github.com/Hatchepsoute/sigma-rules/blob/main/CVE-2009-0556_PowerPoint/rules/process_creation_win_ppt_cve_2009_0556.yml"

customFields:
  cve_id:
    string: "CVE-2009-0556"
  detection_type:
    string: "Process Creation Anomaly"
  mitre_attack:
    string: "T1204.002 - User Execution: Malicious File"
  mitre_technique_id:
    string: "T1204.002"
  kev_catalog:
    boolean: true
  affected_software:
    string: "Microsoft PowerPoint 2000, 2002, 2003, 2007"
  sigma_rule_id:
    string: "525a3d08-2230-49ae-98db-f665caca4f07"

prerequisites:
  teams_involved:
    - "SOC (Tier 1/2)"
    - "CSIRT Team"
    - "System Administration"
    - "Legal Team"
    - "Communications"
  tools_required:
    endpoint_collection: ["EDR", "Sysmon", "Windows Event Logs", "PowerShell"]
    analysis: ["Internal Sandbox", "VirusTotal", "Hybrid-Analysis", "ANY.RUN"]
    cti: ["MISP", "ThreatConnect", "AlienVault OTX"]
    documentation: ["SIEM", "Ticketing System", "Internal Wiki"]
  access_required:
    - "Access to endpoint logs"
    - "Administrative rights on affected hosts"
    - "Access to CTI platforms"
    - "Access to quarantine system"

workflow:
  phases:
    - name: "Phase 1 - Triage & Validation"
      tasks:
        - id: "T1"
          title: "Initial Alert Validation"
          description: "Confirm the alert involves PowerPoint spawning a suspicious child process"
          estimated_time: "≤ 15 min"
          owner: "SOC Analyst Tier 1"
          mandatory: true
          actions:
            - "Verify parent process is POWERPNT.EXE"
            - "Confirm host, user, and timestamp"
            - "Examine parent-child process relationship"
            - "Analyze associated command lines"
            - "Check for similar recent alerts"
          validation_criteria:
            - "PowerPoint.exe spawning unusual process (cmd, powershell, rundll32, etc.)"
            - "User did not intentionally initiate this action"
            - "Activity occurs during normal business hours"
          commands:
            powershell:
              - "Get-Process -Name POWERPNT -IncludeUserName"
              - "Get-CimInstance -ClassName Win32_Process | Where-Object {$_.ParentProcessId -eq [PID_POWERPNT]} | Select-Object Name, ProcessId, CommandLine"

        - id: "T2"
          title: "Initial Evidence Collection"
          description: "Collect essential data for investigation"
          estimated_time: "≤ 30 min"
          owner: "SOC Analyst Tier 2"
          mandatory: true
          data_to_collect:
            process_data:
              - "Parent and child PID"
              - "Complete command lines"
              - "Executable hashes (MD5, SHA1, SHA256)"
              - "Full path"
            document_data:
              - "Path to .ppt/.pptx file"
              - "Document hashes"
              - "Metadata (author, creation date)"
              - "Document source"
            temporal_context:
              - "Events ±10 minutes around incident"
              - "File opening logs"
              - "Simultaneous network connections"
          tools_recommended:
            - "EDR (CrowdStrike, SentinelOne, Microsoft Defender)"
            - "Sysmon (Event ID 1 - Process Creation)"
            - "Velociraptor for deep collection"
            - "KAPE for light forensics"

    - name: "Phase 2 - Deep Investigation"
      tasks:
        - id: "T3"
          title: "Suspicious Document Analysis"
          description: "Determine if PowerPoint document is malicious"
          estimated_time: "≤ 2 hours"
          owner: "Malware Analyst"
          mandatory: true
          procedure:
            quarantine: "Immediately isolate the document"
            static_analysis:
              - "Calculate hashes (SHA256, MD5)"
              - "Extract metadata with oledump.py"
              - "Search for suspicious macros"
              - "Examine embedded OLE objects"
            dynamic_analysis:
              - "Submit to internal sandbox"
              - "Analyze behavior in isolated environment"
              - "Capture exploitation indicators"
            vt_check: "Check on VirusTotal"
          tools:
            - "oledump.py"
            - "officeparser"
            - "Internal sandbox"
            - "VirusTotal API"

        - id: "T4"
          title: "Threat Intelligence Enrichment"
          description: "Contextualize indicators with CTI sources"
          estimated_time: "≤ 45 min"
          owner: "Threat Intelligence Analyst"
          mandatory: true
          cti_sources:
            hashes: ["VirusTotal", "Hybrid-Analysis", "MalwareBazaar"]
            domains_ip: ["AlienVault OTX", "AbuseIPDB", "Shodan"]
            campaigns: ["MITRE ATT&CK", "Unit42", "Mandiant"]
            vulnerabilities: ["CISA KEV", "NVD", "Exploit-DB"]
          key_questions:
            - "Is exploit known in APT campaigns?"
            - "Are there similar attack clusters?"
            - "Any reused IOCs?"

        - id: "T5"
          title: "Post-Exploitation Activity Check"
          description: "Identify subsequent adversary actions"
          estimated_time: "≤ 1 hour"
          owner: "IR Analyst"
          mandatory: true
          scenarios_to_investigate:
            - activity: "C2 Communication"
              detection: "Firewall logs, DNS queries"
              evidence: "Connections to suspicious IPs"
            - activity: "Lateral Movement"
              detection: "Authentication logs"
              evidence: "RDP, SMB, WMI from host"
            - activity: "Persistence"
              detection: "Registry, Services, Scheduled Tasks"
              evidence: "New Run/Startup entries"
            - activity: "Data Exfiltration"
              detection: "Data transfer logs"
              evidence: "Large uploads, archives"
          commands:
            powershell:
              - "Get-NetTCPConnection | Where-Object {$_.OwningProcess -eq [CHILD_PID]}"
              - "Get-ScheduledTask | Where-Object {$_.TaskPath -like '*\\*'} | Select-Object TaskName, State"
              - "Get-ItemProperty -Path 'HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' -ErrorAction SilentlyContinue"

    - name: "Phase 3 - Scope Assessment"
      tasks:
        - id: "T6"
          title: "Similar Activity Search"
          description: "Identify all potentially affected systems"
          estimated_time: "≤ 2 hours"
          owner: "IR Lead"
          mandatory: true
          search_criteria:
            by_hash: "Search by document hash"
            by_behavior: "PowerPoint spawning cmd/powershell/rundll32"
            by_source: "Documents from same email source"
            time_window: "30-90 days backward"
          siem_query_example: |
            index=endpoint EventCode=1 
            | search ParentImage="*POWERPNT.EXE" 
            | stats count by host, user, CommandLine

    - name: "Phase 4 - Containment"
      tasks:
        - id: "C1"
          title: "Immediate Containment Actions"
          description: "Limit impact and prevent spread"
          estimated_time: "≤ 1 hour"
          owner: "System Administrator"
          mandatory: false
          trigger: "If exploitation confirmed"
          actions:
            - "Isolate host from network (VLAN quarantine)"
            - "Block IOCs across all systems"
            - "Quarantine document on all systems"
            - "Revoke affected user sessions"
            - "Configure additional monitoring alerts"
          edr_rule_example: |
            rule: Block_Suspicious_PowerPoint_Children
            action: block
            conditions:
              parent_process: POWERPNT.EXE
              child_process: 
                - cmd.exe
                - powershell.exe
                - rundll32.exe
                - wscript.exe

    - name: "Phase 5 - Eradication"
      tasks:
        - id: "E1"
          title: "Cleanup and Corrective Measures"
          description: "Remove malicious artifacts and apply patches"
          estimated_time: "≤ 4 hours"
          owner: "Security Team + Administration"
          mandatory: false
          trigger: "If exploitation confirmed"
          eradication_actions:
            - "Remove malicious document"
            - "Clean files created by payload"
            - "Remove malicious registry entries"
            - "Delete suspicious scheduled tasks"
          patch_verification:
            powershell: "Get-HotFix -Id KB957789, KB969618"
          compensating_controls:
            - "Enable Attack Surface Reduction (ASR) rules"
            - "Block Office macros from internet"
            - "Implement Application Whitelisting"
            - "Strengthen software restriction policies"
          workaround_registry: |
            Windows Registry Editor Version 5.00
            [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\Security]
            "DisablePowerPointFileValidation"=dword:00000001

    - name: "Phase 6 - Recovery"
      tasks:
        - id: "R1"
          title: "Secure Return to Normal"
          description: "Validate integrity and reintegrate systems"
          estimated_time: "Variable"
          owner: "Operations Team"
          mandatory: false
          validation_checklist:
            - "Full antivirus scan"
            - "System checksum verification"
            - "Account and permissions audit"
            - "Memory analysis for rootkits"
          reintegration_steps:
            - "Reintegrate host with enhanced monitoring"
            - "Close monitoring for 7 days"
            - "Configure specific alerts for the host"
          restoration_options:
            - "Restore from clean backup"
            - "Complete rebuild if compromise confirmed"

    - name: "Phase 7 - Documentation"
      tasks:
        - id: "R2"
          title: "Reporting and Lessons Learned"
          description: "Capitalize on incident for continuous improvement"
          estimated_time: "≤ 3 days"
          owner: "IR Lead + SOC Manager"
          mandatory: false
          report_template: |
            # Incident Report - CVE-2009-0556
            ## Summary
            - Date: [Date]
            - Affected Host(s): [List]
            - Impact: [Low/Medium/High]
            - Status: [Resolved/In Progress]
            
            ## Timeline
            - T0-10min: Initial detection
            - T0+30min: Validation and triage
            - T0+2h: Deep investigation
            - T0+4h: Containment applied
            - T0+24h: Eradication complete
            
            ## Indicators of Compromise (IOCs)
            ### Files
            - Document: [hash], [name]
            - Payload: [hash], [path]
            
            ### Network
            - IPs: [list]
            - Domains: [list]
            
            ## Applied Fixes
            1. [Fix 1]
            2. [Fix 2]
            
            ## Improvement Recommendations
            1. [Detection improvement]
            2. [Prevention improvement]
            3. [Process improvement]

observables_to_add:
  - type: "file"
    examples: 
      - "suspicious.ppt"
      - "malicious_presentation.pptx"
      - "SHA256:<document_hash>"
  - type: "process"
    examples:
      - "POWERPNT.EXE"
      - "cmd.exe"
      - "powershell.exe"
      - "rundll32.exe"
      - "wscript.exe"
      - "cscript.exe"
  - type: "ip"
    examples: ["<destination_ip>", "<c2_server_ip>"]
  - type: "domain"
    examples: ["<malicious_domain>", "<download_domain>"]
  - type: "registry_key"
    examples: 
      - "HKLM\\Software\\Microsoft\\Office\\..."
      - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"

metrics:
  kpis_to_track:
    - "MTTA (Mean Time to Acknowledge): < 15 min"
    - "MTTR (Mean Time to Respond): < 2 hours"
    - "MTTC (Mean Time to Contain): < 4 hours"
    - "Number of affected hosts"
    - "Infection source (email, web, USB)"
  dashboard_query: |
    index=endpoint (EventCode=1 OR EventCode=3) 
    | search ParentImage="*POWERPNT.EXE" 
    | timechart count by host span=1h

communication_protocol:
  internal:
    immediate: "Channel #incident-response, conference call"
    after_1h: "Email to CISO and management"
    after_4h: "Written status update"
    closure: "Complete report distributed"
  external:
    - "Legal authorities (if required)"
    - "Affected clients (per contract)"
    - "Cyber insurance (if triggered)"

testing_exercise:
  frequency: "Semi-annually"
  duration: "2 hours"
  participants: ["SOC", "CSIRT", "Administrators"]
  scenario: "Inject simulated alert and follow playbook"
  evaluation_criteria:
    - "Completion of mandatory tasks"
    - "Adherence to estimated timelines"
    - "Quality of documentation produced"
    - "Communication effectiveness"

approval:
  name: "___________________"
  position: "CISO"
  date: "___________________"
  signature: "___________________"

review_schedule:
  next_review: "6 months"
  next_review_date: "[Date]"

disclaimer: "This playbook is property of the organization. Any unauthorized reproduction or distribution is prohibited."
