# CVE-2026-20947 â€“ SharePoint RCE Detection (SOC)
ğŸ‘‰ğŸ¾ French version available here : [README_FR.md](README_FR.md)
## ğŸ“Œ Repository Purpose

This repository provides a **Sigma detection pack** for **SOC and Detection Engineering teams** to detect **exploitation attempts** and **post-exploitation impact** related to:

**CVE-2026-20947 â€“ Microsoft SharePoint Server Remote Code Execution (RCE)**

The vulnerability is caused by a **SQL Injection (CWE-89)** allowing an authenticated attacker to execute arbitrary code via crafted HTTP requests.

---

## ğŸ§± Repository Structure
```
CVE-2026-20947_SharePoint_RCE/
â”œâ”€â”€ decision-table
â”‚Â Â  â”œâ”€â”€ Decision_Table_CVE-2026-20947_EN.md
â”‚Â Â  â”œâ”€â”€ Decision_Table_CVE-2026-20947_FR.md
â”‚Â Â  â”œâ”€â”€ README_FR.md
â”‚Â Â  â””â”€â”€ README.md
â”œâ”€â”€ diagrams
â”‚Â Â  â”œâ”€â”€ Attack_Detection_Response_Flow_CVE-2026-20947.png
â”‚Â Â  â””â”€â”€ README.md
â”œâ”€â”€ playbook
â”‚Â Â  â”œâ”€â”€ Playbook_CVE-2026-20947_EN.md
â”‚Â Â  â”œâ”€â”€ Playbook_CVE-2026-20947_EN.yml
â”‚Â Â  â”œâ”€â”€ Playbook_CVE-2026-20947_FR.md
â”‚Â Â  â”œâ”€â”€ Playbook_CVE-2026-20947_FR.yml
â”‚Â Â  â”œâ”€â”€ README_FR.md
â”‚Â Â  â””â”€â”€ README.md
â”œâ”€â”€ README_FR.md
â”œâ”€â”€ README.md
â””â”€â”€ rules
    â”œâ”€â”€ web
    â”‚Â Â  â””â”€â”€ sharepoint_rce_cve-2026-20947_http.yml
    â””â”€â”€ windows
        â””â”€â”€ sharepoint_rce_cve-2026-20947_process.yml

```
---

## ğŸ§  SOC Detection Strategy

This pack follows a **layered SOC detection approach**:

- **Web / HTTP layer**: early exploitation detection
- **Windows / Process layer**: post-exploitation / confirmed RCE detection

---

## ğŸ” Rule 1 â€“ HTTP Detection (HUNTING / EARLY WARNING)

**File:** `rules/web/sharepoint_rce_cve-2026-20947_http.yml`

**Purpose:**
Detect suspicious HTTP requests targeting sensitive SharePoint endpoints with SQL injection or command execution indicators.

---

## ğŸ”¥ Rule 2 â€“ Windows Process Detection (STRICT)

**File:** `rules/windows/sharepoint_rce_cve-2026-20947_process.yml`

**Purpose:**
Detect a high-confidence compromise signal where **IIS / SharePoint spawns a system shell**.

---

## ğŸ¬ Covered Attack Scenario

1. Malicious HTTP requests sent to SharePoint  
2. Web-layer detection triggers (hunting)  
3. Exploit succeeds â†’ code execution  
4. w3wp.exe spawns cmd.exe / powershell.exe  
5. Critical SOC alert  
6. Incident response initiated

---

## ğŸ“š References

- https://nvd.nist.gov/vuln/detail/CVE-2026-20947
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20947
- https://windowsforum.com/threads/cve-2026-20947-patch-and-hunt-for-sharepoint-server-rce-jan-2026.396820/
---
**Author :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

