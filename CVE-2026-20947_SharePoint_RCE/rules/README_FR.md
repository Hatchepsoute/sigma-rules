ğŸ‘‰ğŸ¾ Version anglaise ici: [README.md](./README.md)
# ğŸ›¡ï¸ DÃ©tection SharePoint RCE (CVE-2026-20947)

Ce pack contient des rÃ¨gles Sigma conÃ§ues pour identifier les tentatives d'exploitation de la vulnÃ©rabilitÃ© d'exÃ©cution de code Ã  distance (RCE) dans Microsoft SharePoint.

## ğŸ¯ StratÃ©gie de DÃ©tection : Approche Multi-Couches

Pour maximiser la visibilitÃ©, la dÃ©tection est divisÃ©e entre le vecteur d'entrÃ©e (HTTP) et l'impact sur le systÃ¨me (Processus) :

### 1. ğŸ” La RÃ¨gle "HTTP Parameter Exploitation" (Early Warning)
* **Fichier** : `sharepoint_rce_cve-2026-20947_http.yml` ğŸ‘‰ğŸ¾ [web/sharepoint_rce_cve-2026-20947_http.yml](./web/sharepoint_rce_cve-2026-20947_http.yml)
* **Niveau** : `high`
* **RÃ´le** : Analyse les logs IIS (`w3svc`) pour dÃ©tecter des requÃªtes web suspectes vers les points d'entrÃ©e SharePoint (`/_vti_bin/`, `/_layouts/15/`) contenant des charges utiles SQLi ou des commandes shell.
* **Usage** : IdÃ©al pour le **Hunting** et la dÃ©tection prÃ©coce des scanners ou des tentatives d'exploitation initiales.

### 2. âš¡ La RÃ¨gle "IIS Worker Suspicious Shell" (Impact Critique)
* **Fichier** : `sharepoint_rce_cve-2026-20947_process.yml` ğŸ‘‰ğŸ¾  [windows/sharepoint_rce_cve-2026-20947_process.yml](./windows/sharepoint_rce_cve-2026-20947_process.yml)
* **Niveau** : `critical`
* **RÃ´le** : Surveille la crÃ©ation de processus systÃ¨me. Elle alerte si le worker IIS (`w3wp.exe`) gÃ©nÃ¨re un interprÃ©teur de commandes (`cmd`, `powershell`) avec des indicateurs suspects (tÃ©lÃ©chargement, encodage Base64).
* **Usage** : DÃ©tection Ã  haute confiance pour une **alerte en temps rÃ©el**. Un dÃ©clenchement ici indique probablement une exploitation rÃ©ussie.

---

## ğŸ•µï¸ Guide d'Investigation pour l'Analyste SOC

En cas d'alerte sur ces rÃ¨gles, suivez cette mÃ©thodologie :

1. **VÃ©rification du Processus** : Si la rÃ¨gle `process` se dÃ©clenche, examinez la `CommandLine`. Cherchez des connexions rÃ©seau sortantes Ã©tablies par le processus enfant (`curl`, `wget`, `certutil`).
2. **CorrÃ©lation Web** : Utilisez l'IP source (`c-ip`) identifiÃ©e dans la rÃ¨gle `http` pour voir si d'autres requÃªtes inhabituelles ont Ã©tÃ© effectuÃ©es avant l'alerte.
3. **Analyse de l'Utilisateur** : VÃ©rifiez si le compte utilisateur (`User`) exÃ©cutant la commande est le compte de service SharePoint (`svc_...`) ou un compte anormal.

## ğŸ“‹ Correspondance des Champs (IIS & Windows)

| Champ Sigma | Source Log | Description |
| :--- | :--- | :--- |
| **cs-uri-query** | IIS | ParamÃ¨tres de l'URL contenant la charge utile. |
| **cs(User-Agent)** | IIS | IdentitÃ© du client (cherche les outils de scan). |
| **CommandLine** | Windows | La commande exacte exÃ©cutÃ©e par l'attaquant. |
| **ParentImage** | Windows | Le processus parent (doit Ãªtre `w3wp.exe` ou `OWSTIMER.EXE`). |

---

**Auteur :** Adama ASSIONGBON â€“ SOC & CTI Consultant  

**Me contacter** : [LinkedIn](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
