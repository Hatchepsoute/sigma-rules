title: SharePoint Possible Exploitation Attempt via HTTP Parameters - CVE-2026-20947
id: 3f6b9e2a-8c3a-4c2e-9d6a-6a2f9e9a1b7c
status: experimental
description: >
  Detects suspicious SharePoint HTTP requests that may indicate exploitation attempts associated with CVE-2026-20947.  This rule is intended for hunting or early warning using IIS (w3svc) logs.

  FR => Détecte les requêtes HTTP suspectes vers SharePoint pouvant indiquer des tentatives  d'exploitation associées à la CVE-2026-20947. Règle orientée hunting / early warning.
author: Adama ASSIONGBON SOC/CTI Analyst Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a
date: 2026-01-29
modified: 2026-01-30
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2026-20947
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20947
  - https://windowsforum.com/threads/cve-2026-20947-patch-and-hunt-for-sharepoint-server-rce-jan-2026.396820/
  - https://www.cisa.gov/news-events/bulletins/sb26-020
tags:
  - attack.initial-access
  - attack.t1190
  - attack.persistence
  - attack.t1505.003
  - cve.2026-20947

logsource:
  category: webserver
  product: iis
  service: w3svc

detection:
  selection_paths:
    cs-uri-stem|contains:
      - '/_layouts/15/'
      - '/_vti_bin/'
      - '/_api/'
      - '/_admin/'
      - '/_catalogs/'
      - '/_controltemplates/'

  selection_suspicious_params:
    cs-uri-query|contains:
      - 'cmd='
      - 'exec='
      - 'shell='
      - 'powershell'
      - 'cmd.exe'
      - 'xp_cmdshell'
      - 'UNION'
      - 'WAITFOR'
      - 'DELAY'
      - '--'
      - '/*'
      - '*/'
      - ';'
      - '|'
      - '`'
      - '$('
      - '${'

  selection_suspicious_ua:
    cs(User-Agent)|contains:
      - 'curl/'
      - 'wget/'
      - 'python-requests'
      - 'Go-http-client'
      - 'nikto'
      - 'sqlmap'

  filter_known_scanners:
    cs(User-Agent)|contains:
      - 'nessus'
      - 'qualys'
      - 'rapid7'
      - 'acunetix'

  condition: >
    (
      selection_paths and
      (selection_suspicious_params or selection_suspicious_ua)
    )
    and not filter_known_scanners

fields:
  - c-ip
  - cs-username
  - cs-uri-stem
  - cs-uri-query
  - cs(User-Agent)
  - sc-status
  - time

falsepositives:
  - Authorized vulnerability scanning / penetration testing
  - Legitimate SharePoint administration or troubleshooting
  - Internal development or testing activity
level: high

