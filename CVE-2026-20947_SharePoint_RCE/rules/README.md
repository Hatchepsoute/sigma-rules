ğŸ‘‰ğŸ¾ English version available here: [README.md](./README.md)
# ğŸ›¡ï¸ SharePoint RCE Detection Pack (CVE-2026-20947)
This repository provides Sigma rules specifically crafted to detect Remote Code Execution (RCE) exploitation attempts against Microsoft SharePoint.

## ğŸ¯ Detection Strategy: Multi-Layered Defense

To ensure maximum visibility, the detection is split between the entry vector (HTTP) and the system impact (Process):

### 1. ğŸ” HTTP Parameter Exploitation Rule (Early Warning)
* **File**: `sharepoint_rce_cve-2026-20947_http.yml`  ğŸ‘‰ğŸ¾ [web/sharepoint_rce_cve-2026-20947_http.yml](./web/sharepoint_rce_cve-2026-20947_http.yml)
* **Level**: `high`
* **Role**: Analyzes IIS logs (`w3svc`) for suspicious web requests targeting SharePoint endpoints (`/_vti_bin/`, `/_layouts/15/`) containing SQLi payloads or shell commands.
* **Usage**: Best used for **Threat Hunting** and early warning against scanners or initial exploitation attempts.

### 2. âš¡ IIS Worker Suspicious Shell Rule (Critical Impact)
* **File**: `sharepoint_rce_cve-2026-20947_process.yml` ğŸ‘‰ğŸ¾ [windows/sharepoint_rce_cve-2026-20947_process.yml](./windows/sharepoint_rce_cve-2026-20947_process.yml)
* **Level**: `critical`
* **Role**: Monitors process creation events. It alerts when the IIS worker (`w3wp.exe`) spawns a command interpreter (`cmd`, `powershell`) with suspicious indicators (download cradles, Base64 encoding).
* **Usage**: High-confidence detection for **real-time alerting**. A trigger here likely indicates a successful compromise.

---

## ğŸ•µï¸ SOC Analyst Investigation Guide

When these rules trigger, follow this investigation workflow:

1. **Process Verification**: If the `process` rule fires, examine the `CommandLine`. Look for outbound network connections established by the child process (`curl`, `wget`, `certutil`).
2. **Web Correlation**: Use the source IP (`c-ip`) found in the `http` rule to identify other unusual requests made prior to the alert.
3. **User Analysis**: Verify if the account (`User`) executing the command is the legitimate SharePoint service account or an anomaly.

## ğŸ“‹ Field Mapping (IIS & Windows)

| Sigma Field | Log Source | Description |
| :--- | :--- | :--- |
| **cs-uri-query** | IIS | URL parameters containing the payload. |
| **cs(User-Agent)** | IIS | Client identity (searching for scanning tools). |
| **CommandLine** | Windows | The exact command executed by the attacker. |
| **ParentImage** | Windows | The parent process (should be `w3wp.exe` or `OWSTIMER.EXE`). |

---
**Author :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
**Connect with me**: [LinkedIn](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
