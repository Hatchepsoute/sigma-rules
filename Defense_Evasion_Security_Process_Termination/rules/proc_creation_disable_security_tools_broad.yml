title: Defense Evasion - Disable Security Tools via Command Line
id: 3c2d9b7a-9f4d-4b8f-8c2a-6a7a2f7b1c4e
status: experimental
description: |
  Detects suspicious attempts to disable or stop security/EDR/AV tools via common command-line utilities (taskkill, sc, net, PowerShell, wmic). Frequently observed in ransomware pre-encryption and post-exploitation to impair defenses before lateral movement, credential access, or encryption.
references:
  - https://attack.mitre.org/techniques/T1562/001/
author: Adama ASSIONGBON - SOC & CTI Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-02-08
logsource:
  category: process_creation
  product: windows

detection:
  selection_tools:
    Image|endswith:
      - '\taskkill.exe'
      - '\sc.exe'
      - '\net.exe'
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\wmic.exe'

  selection_intent:
    CommandLine|contains:
      - 'taskkill'
      - '/F'
      - 'sc stop'
      - 'sc config'
      - 'net stop'
      - 'Stop-Service'
      - 'Set-Service'
      - 'DisableRealtimeMonitoring'
      - 'Add-MpPreference'
      - 'wmic process'

  selection_targets:
    CommandLine|contains:
      - 'WinDefend'
      - 'WdNisSvc'
      - 'MsMpEng'
      - 'Sense'
      - 'SecurityHealthService'
      - 'Defender'

  selection_wmic_delete:
    CommandLine|contains|all:
      - 'wmic'
      - 'process'
      - 'delete'

  condition: selection_tools and ( (selection_intent and selection_targets) or selection_wmic_delete )

falsepositives:
  - Legitimate EDR/AV maintenance, upgrades, or troubleshooting by administrators
  - Provisioning / hardening scripts that disable Defender on specific server roles (golden image)
  - IT support actions during incident response (containment, remediation)
level: high
tags:
  - attack.defense-evasion
  - attack.t1562
  - attack.t1562.001

