![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--6218-critical)
![License](https://img.shields.io/badge/License-MIT-green)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)

This document is bilingual (French and English).  The French version appears first, followed by the English version.

# ğŸš¨ WinRAR CVE-2025-6218 - Sigma & SOAR Pack

 ğŸ‡«ğŸ‡· Version franÃ§aise
## ğŸ¯ Objectif 
Ce pack fournit des **rÃ¨gles Sigma**, des **playbooks SOAR** et des **implÃ©mentations outils** pour dÃ©tecter et rÃ©pondre Ã  lâ€™exploitation de la vulnÃ©rabilitÃ© **CVE-2025-6218** affectant **WinRAR sur Windows**.

La logique couvre :
- lâ€™**exploitation** (traversÃ©e de rÃ©pertoires lors de lâ€™extraction),
- le **postâ€‘exploitation** (Ã©criture de fichiers arbitraires),
- la **persistance** (Startup, tÃ¢ches planifiÃ©es),
- la **corrÃ©lation SOC/SOAR** pour une forte confiance.

---

## ğŸ“Œ PrÃ©sentation de la vulnÃ©rabilitÃ©

| Ã‰lÃ©ment | DÃ©tail |
|------|------|
| CVE | CVE-2025-6218 |
| Logiciel | WinRAR |
| Type | Directory Traversal |
| OS | Windows |
| Impact | Ã‰criture arbitraire de fichiers + Persistance |
| GravitÃ© | Critique |

---

## ğŸ­ ScÃ©nario dâ€™attaque (rÃ©aliste)

### ğŸ“¨ 1ï¸âƒ£ Livraison
Un utilisateur reÃ§oit une **archive WinRAR piÃ©gÃ©e** via :
- phishing email,
- tÃ©lÃ©chargement depuis un site compromis,
- partage de fichiers.

### ğŸ“‚ 2ï¸âƒ£ Exploitation
Lâ€™archive contient des chemins malveillants, par exemple :
```
..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update.exe
```
Lors de lâ€™extraction, WinRAR Ã©crit le fichier **en dehors du rÃ©pertoire choisi par lâ€™utilisateur**.

### ğŸ› ï¸ 3ï¸âƒ£ Postâ€‘exploitation & persistance
Le fichier est dÃ©posÃ© dans un emplacement de **dÃ©marrage automatique**.
â¡ï¸ Le malware sâ€™exÃ©cute au prochain logon ou reboot.

---

## ğŸ§  Logique de dÃ©tection (Sigma)

### ğŸŸ§ RÃ¨gle 1 - Exploitation (Traversal)
ğŸ“„ `WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml`

ğŸ”” **DÃ©tecte :**
- ğŸ”¸ lâ€™exÃ©cution de `winrar.exe`,
- ğŸ”¸ des motifs de traversÃ©e de rÃ©pertoires (`..\`, `../`, encodage URL),
- ğŸ”¸ lors dâ€™une extraction.

ğŸŸ§  **RÃ©action SOC :**
- alerte de sÃ©vÃ©ritÃ© *Moyenne*,
- investigation recommandÃ©e,
- surveillance des actions postâ€‘exploitation.


### ğŸŸ¥ RÃ¨gle 2 - Persistance
ğŸ“„ `WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml`

ğŸ”” **DÃ©tecte :**
- â™¦ï¸ WinRAR Ã©crivant des fichiers,
- â™¦ï¸dans des rÃ©pertoires de persistance Windows (Startup / Tasks).

ğŸ”´ **RÃ©action SOC :**
- â™¦ï¸alerte de sÃ©vÃ©ritÃ© *Ã‰levÃ©e*,
- â™¦ï¸suspicion forte de compromission,
- â™¦ï¸actions de confinement recommandÃ©es.

---

### ğŸ”— CorrÃ©lation SOC / SOAR
ğŸš¨ **Exploitation confirmÃ©e** si :
- ğŸ”¹RÃ¨gle 1 **ET** RÃ¨gle 2,
- ğŸ”¹mÃªme hÃ´te (et utilisateur),
- ğŸ”¹fenÃªtre â‰¤ **10 minutes**.

ğŸŸ© **RÃ©action automatique possible :**
- â–ªï¸isolement du poste,
- â–ªï¸quarantaine du fichier dÃ©posÃ©,
- â–ªï¸suppression de la persistance,
- â–ªï¸crÃ©ation dâ€™un incident IR (TheHive).

---

## ğŸ§¬ MITRE ATT&CK
- T1566 â†”ï¸ Phishing (livraison archive)
- T1204 â†”ï¸ User Execution
- T1547 â†”ï¸ Startup Folder / Scheduled Task

#### âš ï¸ Avertissement
Ces rÃ¨gles sont fournies Ã  des fins exclusivement dÃ©fensives.  Toujours tester et ajuster les rÃ¨gles avant tout dÃ©ploiement en environnement de production.

## ğŸ”— RÃ©fÃ©rences
- https://nvd.nist.gov/vuln/detail/CVE-2025-6218
- https://thehackernews.com/2025/12/warning-winrar-vulnerability-cve-2025.html
- https://foresiet.com/blog/apt-c-08-winrar-directory-traversal-exploit/
- https://www.secpod.com/blog/archive-terror-dissecting-the-winrar-cve-2025-6218-exploit-apt-c-08s-stealth-move/
---

 ğŸ‡¬ğŸ‡§ English version 

## ğŸ¯ Pack Objective
During extraction, WinRAR writes the file **outside the directory selected by the user**.

### ğŸ› ï¸ 3ï¸âƒ£ Post-Exploitation & Persistence
The file is dropped into an **auto-start location**.
â¡ï¸ The malware executes at the next user logon or system reboot.

## ğŸ§  Detection Logic (Sigma)

### ğŸŸ§ Rule 1 â€“ Exploitation (Traversal)
ğŸ“„ `WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml`

ğŸ”” **Detects:**
- ğŸ”¹ execution of `winrar.exe`,
- ğŸ”¹ directory traversal patterns (`..\`, `../`, URL-encoded variants),
- ğŸ”¹ during archive extraction.

ğŸŸ§ **SOC Response:**
- *Medium* severity alert,
- investigation recommended,
- monitoring of post-exploitation activity.

### ğŸŸ¥ Rule 2 â€“ Persistence
ğŸ“„ `WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml`

ğŸ”” **Detects:**
- ğŸ”¹ WinRAR writing files,
- ğŸ”¹ to Windows persistence directories (Startup / Tasks).

ğŸ”´ **SOC Response:**
- *High* severity alert,
- strong suspicion of compromise,
- containment actions recommended.

---

### ğŸ”— SOC / SOAR Correlation
ğŸš¨ **Confirmed exploitation** if:
- ğŸ”¹ Rule 1 **AND** Rule 2,
- ğŸ”¹ same host (and user),
- ğŸ”¹ time window â‰¤ **10 minutes**.

ğŸŸ© **Possible automated response:**
- â–ªï¸ endpoint isolation,
- â–ªï¸ quarantine of the dropped file,
- â–ªï¸ removal of persistence mechanisms,
- â–ªï¸ creation of an IR incident (TheHive).

---

## ğŸ§¬ MITRE ATT&CK
- T1566 â†”ï¸ Phishing (archive delivery)
- T1204 â†”ï¸ User Execution
- T1547 â†”ï¸ Startup Folder / Scheduled Task

####  âš ï¸  Disclaimer
These rules are provided **for defensive purposes only**.  Always test and tune the rules before deploying them in production.

ğŸ›¡ï¸ **Maintained for the Blue Team community**

## ğŸ”— References
- https://nvd.nist.gov/vuln/detail/CVE-2025-6218
- https://thehackernews.com/2025/12/warning-winrar-vulnerability-cve-2025.html
- https://foresiet.com/blog/apt-c-08-winrar-directory-traversal-exploit/
- https://www.secpod.com/blog/archive-terror-dissecting-the-winrar-cve-2025-6218-exploit-apt-c-08s-stealth-move/
---
**Author:** Adama Assiongbon  
SOC / CTI Analyst Consultant  
LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
