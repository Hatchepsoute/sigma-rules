![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--6218-critical)
![License](https://img.shields.io/badge/License-MIT-green)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)

This document is bilingual (French and English).  The French version appears first, followed by the English version.

# ğŸš¨ WinRAR CVE-2025-6218 - Sigma & SOAR Pack
---
## ğŸŒ Language Notice / Avis de langue
ğŸ‡«ğŸ‡· **FranÃ§ais**  
Ce document commence par la **version franÃ§aise**, suivie de la **version anglaise**.
ğŸ‡¬ğŸ‡§ **English**  
This document starts with the **French version**, followed by the **English version**.
---

# ğŸ‡«ğŸ‡· VERSION FRANÃ‡AISE

## ğŸ¯ Objectif du pack
Ce pack fournit des **rÃ¨gles Sigma**, des **playbooks SOAR** et des **implÃ©mentations outils**
pour dÃ©tecter et rÃ©pondre Ã  lâ€™exploitation de la vulnÃ©rabilitÃ© **CVE-2025-6218** affectant **WinRAR sur Windows**.

La logique couvre :
- lâ€™**exploitation** (traversÃ©e de rÃ©pertoires lors de lâ€™extraction),
- le **postâ€‘exploitation** (Ã©criture de fichiers arbitraires),
- la **persistance** (Startup, tÃ¢ches planifiÃ©es),
- la **corrÃ©lation SOC/SOAR** pour une forte confiance.

---

## ğŸ“Œ PrÃ©sentation de la vulnÃ©rabilitÃ©

| Ã‰lÃ©ment | DÃ©tail |
|------|------|
| CVE | CVE-2025-6218 |
| Logiciel | WinRAR |
| Type | Directory Traversal |
| OS | Windows |
| Impact | Ã‰criture arbitraire de fichiers + Persistance |
| GravitÃ© | Critique |

---

## ğŸ­ ScÃ©nario dâ€™attaque (rÃ©aliste)

### ğŸ“¨ 1ï¸âƒ£ Livraison
Un utilisateur reÃ§oit une **archive WinRAR piÃ©gÃ©e** via :
- phishing email,
- tÃ©lÃ©chargement depuis un site compromis,
- partage de fichiers.

### ğŸ“‚ 2ï¸âƒ£ Exploitation
Lâ€™archive contient des chemins malveillants, par exemple :
```
..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update.exe
```

Lors de lâ€™extraction, WinRAR Ã©crit le fichier **en dehors du rÃ©pertoire choisi par lâ€™utilisateur**.

### ğŸ› ï¸ 3ï¸âƒ£ Postâ€‘exploitation & persistance
Le fichier est dÃ©posÃ© dans un emplacement de **dÃ©marrage automatique**.
â¡ï¸ Le malware sâ€™exÃ©cute au prochain logon ou reboot.

---

## ğŸ§  Logique de dÃ©tection (Sigma)

### ğŸŸ§ RÃ¨gle 1 - Exploitation (Traversal)
ğŸ“„ `WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml`

**DÃ©tecte :**
- lâ€™exÃ©cution de `winrar.exe`,
- des motifs de traversÃ©e de rÃ©pertoires (`..\`, `../`, encodage URL),
- lors dâ€™une extraction.

**RÃ©action SOC :**
- alerte de sÃ©vÃ©ritÃ© *Moyenne*,
- investigation recommandÃ©e,
- surveillance des actions postâ€‘exploitation.
---

### ğŸŸ¥ RÃ¨gle 2 - Persistance
ğŸ“„ `WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml`

**DÃ©tecte :**
- WinRAR Ã©crivant des fichiers,
- dans des rÃ©pertoires de persistance Windows (Startup / Tasks).

**RÃ©action SOC :**
- alerte de sÃ©vÃ©ritÃ© *Ã‰levÃ©e*,
- suspicion forte de compromission,
- actions de confinement recommandÃ©es.

---

### ğŸ”— CorrÃ©lation SOC / SOAR
ğŸš¨ **Exploitation confirmÃ©e** si :
- RÃ¨gle 1 **ET** RÃ¨gle 2,
- mÃªme hÃ´te (et utilisateur),
- fenÃªtre â‰¤ **10 minutes**.

**RÃ©action automatique possible :**
- isolement du poste,
- quarantaine du fichier dÃ©posÃ©,
- suppression de la persistance,
- crÃ©ation dâ€™un incident IR (TheHive).

---

## ğŸ§¬ MITRE ATT&CK
- T1566 â€” Phishing (livraison archive)
- T1204 â€” User Execution
- T1547 â€” Startup Folder / Scheduled Task

---

## ğŸ”— RÃ©fÃ©rences
- https://nvd.nist.gov/vuln/detail/CVE-2025-6218
- https://thehackernews.com/2025/12/warning-winrar-vulnerability-cve-2025.html
- https://foresiet.com/blog/apt-c-08-winrar-directory-traversal-exploit/
- https://www.secpod.com/blog/archive-terror-dissecting-the-winrar-cve-2025-6218-exploit-apt-c-08s-stealth-move/

---

# ğŸ‡¬ğŸ‡§ ENGLISH VERSION

## ğŸ¯ Pack Objective
This pack provides **Sigma rules**, **SOAR playbooks**, and **toolâ€‘specific implementations**
to detect and respond to the exploitation of **CVE-2025-6218**, a critical WinRAR vulnerability on Windows.

---

## ğŸ­ Attack Scenario

1ï¸âƒ£ **Delivery**  
A weaponized WinRAR archive is delivered via phishing or malicious download.

2ï¸âƒ£ **Exploitation**  
The archive abuses directory traversal paths to write files outside the extraction folder.

3ï¸âƒ£ **Persistence**  
Payloads are dropped into Windows Startup or task locations and executed on reboot.

---

## ğŸ§  Detection & Rule Reaction

- **Rule 1 (Traversal)** â†’ Suspicious exploitation attempt â†’ Investigation
- **Rule 2 (Persistence)** â†’ Highâ€‘risk activity â†’ Containment
- **Correlation (â‰¤ 10 min)** â†’ Confirmed exploitation â†’ Incident Response
---
## âš ï¸ Disclaimer
These detection rules and playbooks are provided for **defensive purposes only**.
Always test and adapt before production deployment.

---

**Author:** Adama Assiongbon  
**Role:** SOC / CTI Analyst Consultant  
LinkedIn : https://www.linkedin.com/in/adama-assiongbon-9029893a/
**Last update:** 2025-12-18

## ğŸ“ Structure du pack CVE

Lâ€™arborescence ci-dessous prÃ©sente lâ€™organisation du pack **CVE-2025-6218_WinRAR** :

```text
CVE-2025-6218_WinRAR/
â”œâ”€â”€ README.md                        # PrÃ©sentation globale du CVE
â”œâ”€â”€ rules/                                    # RÃ¨gles Sigma (dÃ©tection)
â”œâ”€â”€ playbook/                            # Playbooks SOAR gÃ©nÃ©riques
â”‚   â””â”€â”€ implementations/      # ImplÃ©mentations outils (TheHive / Shuffle)
â””â”€â”€ diagrams/                           # Diagrammes & vue exÃ©cutive

```

