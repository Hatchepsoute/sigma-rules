![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--6218-critical)
![License](https://img.shields.io/badge/License-MIT-green)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)


# CVE-2025-6218 â€“ WinRAR Path Traversal & Persistence Detection (Sigma Rules)

## Status
- **Experimental**
- SOC / Detection Engineering focused

---

## Overview

This directory contains **two correlated Sigma rules** designed to detect **real exploitation chains of CVE-2025-6218**, a critical **WinRAR path traversal vulnerability**.

The rules follow the **official sigma-rules philosophy**:
- One rule focused on **initial exploitation behavior**
- One rule focused on **post-exploitation persistence**

They are intended to be **deployed and correlated together**.

---

## Vulnerability Context

| Item | Details |
|------|--------|
| CVE | CVE-2025-6218 |
| Affected Software | WinRAR |
| Vulnerability Type | Path Traversal |
| Exploitation Vector | Malicious archive |
| Impact | Arbitrary file write |
| Post-Exploitation | Persistence |

Attackers can craft a malicious archive that, when extracted, writes files **outside the intended directory**, enabling payload placement in sensitive locations.

---

## Threat Model

Observed exploitation chains include:
1. User opens a malicious archive
2. WinRAR extracts files using **directory traversal**
3. Payload is written outside extraction directory
4. Payload is dropped into **Startup / persistence locations**
5. Malicious code executes on reboot or login

Sigma rules cannot detect the vulnerability itself, but reliably detect **dangerous exploitation effects**.

---

## Rule 1 â€“ Initial Exploitation (BROAD)

### File
`WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml`

### Purpose
Detect **path traversal patterns during WinRAR extraction**, which strongly indicate exploitation of CVE-2025-6218.

### Detection Logic
- **Process**: WinRAR / UnRAR
- **Command line**:
  - Directory traversal sequences (`..\`, `../`, URL-encoded traversal)
  - Extraction flags (`x`, `e`, `-ep`, `-o+`)

### SOC Interpretation
- Suspicious archive extraction
- Likely exploitation attempt
- Requires validation and correlation

### Recommended Usage
- SOC L1 / L2 triage
- Threat hunting
- Exploitation precursor detection

---

## Rule 2 â€“ Persistence (STRICT)

### File
`WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml`

### Purpose
Detect **post-exploitation persistence** where WinRAR writes extracted files into **Windows startup or scheduled task directories**.

### Detection Logic
- **Process**: WinRAR / UnRAR
- **Target paths**:
  - Startup folders
  - Scheduled Tasks directories

### SOC Interpretation
- **High-confidence malicious activity**
- Persistence attempt detected
- Incident-ready alert

### Recommended Usage
- SOC L2 / L3 escalation
- Incident declaration
- SOAR containment trigger

---

## Correlation Strategy (Required)

These rules are designed to be **correlated**.

| Trigger Pattern | SOC Meaning |
|---------------|------------|
| Rule 1 only | Exploitation attempt suspected |
| Rule 2 only | Persistence activity detected |
| **Rule 1 + Rule 2** | ðŸš¨ **Confirmed exploitation of CVE-2025-6218** |

Correlation can be implemented in SIEM or SOAR platforms.

---

## SOC Comparison Table

| Criteria | Exploitation (Rule 1) | Persistence (Rule 2) |
|--------|-----------------------|----------------------|
| Detection stage | Initial exploitation | Post-exploitation |
| False positives | Medium | Very low |
| Confidence | Medium | High |
| Persistence detection | âŒ | âœ… |
| Incident-ready | âŒ | âœ… |
| SOC level | L1 / L2 | L2 / L3 |

---

## Best Practice

> Always deploy **both rules together**.
>
> - Rule 1 provides **early exploitation visibility**
> - Rule 2 confirms **successful compromise and persistence**
>
> This layered detection ensures **robust coverage of CVE-2025-6218 exploitation chains**.
