![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--6218-critical)
![License](https://img.shields.io/badge/License-MIT-green)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)


# CVE-2025-6218 â€“ DÃ©tection WinRAR Path Traversal & Persistance (RÃ¨gles Sigma)

## Statut
- **ExpÃ©rimental**
- AxÃ© SOC / Detection Engineering

---

## PrÃ©sentation

Ce rÃ©pertoire contient **deux rÃ¨gles Sigma corrÃ©lÃ©es** permettant de dÃ©tecter des **chaÃ®nes dâ€™exploitation rÃ©elles de la CVE-2025-6218**, une vulnÃ©rabilitÃ© critique de **traversÃ©e de rÃ©pertoires dans WinRAR**.

Ces rÃ¨gles suivent la **philosophie officielle sigma-rules** :
- Une rÃ¨gle ciblant **lâ€™exploitation initiale**
- Une rÃ¨gle ciblant **la persistance post-exploitation**

ðŸ‘‰ Elles doivent Ãªtre **corrÃ©lÃ©es et dÃ©ployÃ©es ensemble**.

---

## Contexte de la vulnÃ©rabilitÃ©

| Ã‰lÃ©ment | DÃ©tail |
|------|-------|
| CVE | CVE-2025-6218 |
| Logiciel affectÃ© | WinRAR |
| Type | Path Traversal |
| Vecteur | Archive malveillante |
| Impact | Ã‰criture de fichiers arbitraires |
| Post-exploitation | Persistance |

Un attaquant peut forger une archive qui Ã©crit des fichiers **en dehors du rÃ©pertoire dâ€™extraction**, permettant le dÃ©pÃ´t de payloads malveillants.

---

## ModÃ¨le de menace

ChaÃ®ne dâ€™attaque observÃ©e :
1. Lâ€™utilisateur ouvre une archive malveillante
2. WinRAR extrait des fichiers avec **traversÃ©e de rÃ©pertoires**
3. Le payload est Ã©crit hors du dossier prÃ©vu
4. DÃ©pÃ´t dans des emplacements de **dÃ©marrage Windows**
5. ExÃ©cution automatique Ã  lâ€™ouverture de session

Sigma ne dÃ©tecte pas la vulnÃ©rabilitÃ© elle-mÃªme, mais dÃ©tecte efficacement les **effets observables de lâ€™exploitation**.

---

## RÃ¨gle 1 - Exploitation initiale (BROAD)

### Fichier
`WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml`

### Objectif
DÃ©tecter des **motifs de traversÃ©e de rÃ©pertoires lors de lâ€™extraction WinRAR**, fortement liÃ©s Ã  CVE-2025-6218.

### Logique de dÃ©tection
- **Processus** : WinRAR / UnRAR
- **Ligne de commande** :
  - SÃ©quences `..\`, `../`, traversal encodÃ©
  - Options dâ€™extraction

### InterprÃ©tation SOC
- Tentative dâ€™exploitation probable
- Validation et corrÃ©lation requises

### Usage recommandÃ©
- Triage analyste SOC N1 / N2
- Threat hunting
- DÃ©tection prÃ©curseur

---

## RÃ¨gle 2 â€“ Persistance (STRICT)

### Fichier
`WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml`

### Objectif
DÃ©tecter une **tentative de persistance** oÃ¹ WinRAR Ã©crit des fichiers extraits dans des emplacements sensibles Windows.

### Logique de dÃ©tection
- **Processus** : WinRAR / UnRAR
- **Chemins ciblÃ©s** :
  - Dossiers de dÃ©marrage
  - RÃ©pertoires des tÃ¢ches planifiÃ©es

### InterprÃ©tation SOC
- **ActivitÃ© hautement malveillante**
- Persistance dÃ©tectÃ©e
- Alerte prÃªte incident

### Usage recommandÃ©
- Escalade analyste SOC N2 / N3
- DÃ©claration dâ€™incident
- DÃ©clenchement SOAR

---

## CorrÃ©lation des rÃ¨gles (ESSENTIEL)

| DÃ©clenchement | InterprÃ©tation SOC |
|-------------|-------------------|
| RÃ¨gle 1 seule | Exploitation suspectÃ©e |
| RÃ¨gle 2 seule | Persistance dÃ©tectÃ©e |
| **RÃ¨gle 1 + RÃ¨gle 2** | ðŸš¨ **Exploitation CVE-2025-6218 confirmÃ©e** |

La corrÃ©lation peut Ãªtre implÃ©mentÃ©e dans un SIEM ou un SOAR.

---

## Tableau comparatif SOC

| CritÃ¨re | Exploitation | Persistance |
|--------|-------------|------------|
| Phase attaque | Exploitation | Post-exploitation |
| Faux positifs | Moyens | TrÃ¨s faibles |
| Confiance | Moyenne | Ã‰levÃ©e |
| DÃ©tection persistance | âŒ | âœ… |
| PrÃªt incident | âŒ | âœ… |
| Niveau analyste SOC | N1 / N2 | N2 / N3 |

---

## Bonne pratique

> Toujours dÃ©ployer **les deux rÃ¨gles ensemble**.
>
> - RÃ¨gle 1 = visibilitÃ© prÃ©coce  
> - RÃ¨gle 2 = confirmation de compromission  
>
> Cette dÃ©tection en couches assure une **couverture robuste de CVE-2025-6218**.
**Auteur :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

