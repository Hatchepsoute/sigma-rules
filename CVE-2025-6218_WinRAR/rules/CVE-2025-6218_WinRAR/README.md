![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--6218-critical)
![License](https://img.shields.io/badge/License-MIT-green)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)
---
This document is bilingual ( English and French ).  The English version appears first, followed by the  French version.

# ğŸš¨ WinRAR CVE-2025-6218 - Sigma Detection Pack

## ğŸ¯ Objective
This repository provides production-ready Sigma rules to detect exploitation attempts of the WinRAR directory traversal vulnerability (CVE-2025-6218) on Windows systems.

The vulnerability allows attackers to extract files outside the intended directory, enabling payload drops and persistence mechanisms.

The detection approach follows Sigma best practices:
- Atomic detection rules
- SIEM / SOAR-level correlation
- Cross-platform portability

---

## ğŸ“Œ CVE Overview

| Field | Value |
|------|-------|
| CVE | CVE-2025-6218 |
| Type | Directory Traversal |
| Product | WinRAR |
| OS | Windows |
| Impact | Arbitrary file write |

---

## ğŸ“‚ Repository Content

- WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
- WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
- README.md
- README_FR.md

---

## ğŸ§  Detection Strategy

1. **Initial exploitation detection**
   - WinRAR extraction abusing directory traversal patterns

2. **Post-exploitation detection**
   - WinRAR writing files into Windows persistence locations

High confidence is achieved when both detections are correlated within a short time window.

---

## âš™ï¸ Step-by-Step Conversion Guide

### 1ï¸âƒ£ Prerequisites

- Sigma CLI v2.x
- Sysmon enabled (recommended)
- Logs ingested into a SIEM

#### Verify installation:

```bash
sigma list pipelines
sigma list targets
```
#### ğŸ“¥ Rule validation

Validate the rules using Sigma CLI:

```bash
sigma check WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma check WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```
### 2ï¸âƒ£ OpenSearch (Sysmon)

```bash
sigma convert -t opensearch_lucene -p sysmon WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t opensearch_lucene -p sysmon WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 3ï¸âƒ£ Elastic (ECS / Winlogbeat)

```bash
sigma convert -t lucene -p ecs_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t lucene -p ecs_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 4ï¸âƒ£ EQL (Elastic Security):
```bash
sigma convert -t eql -p ecs_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t eql -p ecs_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 5ï¸âƒ£ Splunk

```bash
sigma convert -t splunk -p splunk_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t splunk -p splunk_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 6ï¸âƒ£ NetWitness

```bash
sigma convert -t net_witness WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t net_witness WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

---

## ğŸ§­ Pipeline Selection Guide

| SIEM | Logs | Recommended Pipeline | Target |
|------|------|----------------------|--------|
| OpenSearch | Sysmon | `sysmon` | `opensearch_lucene` |
| Elastic | Winlogbeat (ECS) | `ecs_windows` | `lucene`, `eql` |
| Splunk | Windows Logs | `splunk_windows` | `splunk` |
| SentinelOne | Endpoint Telemetry | *(none)* | `sentinel_one` |
| NetWitness | Windows Logs | *(none)* | `net_witness` |


> âš ï¸ Choosing the correct pipeline is critical.  
> An incorrect pipeline may result in queries that do not match any events.

---

## ğŸ”— Correlation Logic (SIEM / SOAR)

Trigger a HIGH severity alert if:
- Rule 1 AND Rule 2
- Same host (and ideally same user)
- Within 10 minutes
Correlation should be implemented using native SIEM alerting or SOAR playbooks.
---
## ğŸ§¬ MITRE ATT&CK Mapping

- Initial Access: T1566 (Phishing â€“ weaponized archive)
- Execution: T1204 (User Execution)
- Persistence: T1547 (Startup Folder / Scheduled Task)
---
## ğŸ”— References

- https://nvd.nist.gov/vuln/detail/CVE-2025-6218  
- https://thehackernews.com/2025/12/warning-winrar-vulnerability-cve-2025.html  
- https://foresiet.com/blog/apt-c-08-winrar-directory-traversal-exploit/  
- https://www.secpod.com/blog/archive-terror-dissecting-the-winrar-cve-2025-6218-exploit-apt-c-08s-stealth-move/
---
#### âš ï¸ Disclaimer
- These rules are provided for defensive purposes only. Always test before production deployment.
---
ğŸ‡«ğŸ‡· Version franÃ§aise

# ğŸš¨ WinRAR CVE-2025-6218 - Pack de DÃ©tection Sigma

## ğŸ¯ Objectif
Ce dÃ©pÃ´t fournit des rÃ¨gles Sigma prÃªtes pour la production afin de dÃ©tecter lâ€™exploitation de la vulnÃ©rabilitÃ© CVE-2025-6218 affectant WinRAR sous Windows.

Cette vulnÃ©rabilitÃ© permet Ã  un attaquant de :
- exploiter une **traversÃ©e de rÃ©pertoires** lors de lâ€™extraction dâ€™archives
- dÃ©poser des fichiers en dehors du dossier prÃ©vu
- Ã©tablir une **persistance systÃ¨me** (Startup, tÃ¢ches planifiÃ©es)

---

## ğŸ“Œ PrÃ©sentation de la vulnÃ©rabilitÃ©

| Ã‰lÃ©ment | DÃ©tail |
|--------|--------|
| CVE | CVE-2025-6218 |
| Type | TraversÃ©e de rÃ©pertoires |
| Logiciel | WinRAR |
| OS | Windows |
| Impact | Ã‰criture de fichiers arbitraires |

---

## ğŸ“‚ Contenu du dÃ©pÃ´t

- WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
- WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
- README.md
- README_FR.md

---

## ğŸ§  StratÃ©gie de dÃ©tection

La dÃ©tection repose sur **deux comportements distincts** :

### 1ï¸âƒ£ Phase dâ€™exploitation
DÃ©tection de WinRAR utilisant des motifs de traversÃ©e de rÃ©pertoires (`..\\`, `../`, etc.) lors de lâ€™extraction.

### 2ï¸âƒ£ Phase post-exploitation
DÃ©tection de WinRAR Ã©crivant des fichiers dans des emplacements de **persistance Windows**.

â¡ï¸ La corrÃ©lation de ces deux signaux indique une **exploitation confirmÃ©e**.
---

## â“ Pourquoi aucune rÃ¨gle Sigma de corrÃ©lation ?

Les rÃ¨gles de corrÃ©lation Sigma :
- sont peu portables entre SIEM
- sont mal supportÃ©es par certains backends
- posent des problÃ¨mes de conversion

â¡ï¸ La corrÃ©lation doit Ãªtre implÃ©mentÃ©e **au niveau du SIEM ou du SOAR** (OpenSearch, Elastic, TheHive, etc.).


## âš™ï¸ Guide de conversion pas Ã  pas

### 1ï¸âƒ£ PrÃ©requis

- Sigma CLI v2.x
- Sysmon activÃ© (recommandÃ©)
- Logs ou Journaux ingÃ©rÃ©s dans un SIEM

#### VÃ©rification de lâ€™installation :

```bash
sigma list pipelines
sigma list targets
```
#### ğŸ“¥ Usage

Validation de la rÃ¨gle utilisant Sigma CLI:

```bash
sigma check WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma check WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 2ï¸âƒ£ OpenSearch (Sysmon)

```bash
sigma convert -t opensearch_lucene -p sysmon WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t opensearch_lucene -p sysmon WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 3ï¸âƒ£ Elastic (ECS / Winlogbeat)

```bash
sigma convert -t lucene -p ecs_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t lucene -p ecs_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 4ï¸âƒ£ EQL (Elastic Security):
```bash
sigma convert -t eql -p ecs_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t eql -p ecs_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 5ï¸âƒ£ Splunk

```bash
sigma convert -t splunk -p splunk_windows WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t splunk -p splunk_windows WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```

### 6ï¸âƒ£ NetWitness

```bash
sigma convert -t net_witness WinRAR_Path_Traversal_Extraction_CVE-2025-6218.yml
sigma convert -t net_witness WinRAR_Persistence_Startup_Write_CVE-2025-6218.yml
```
---

## ğŸ§­ Guide de sÃ©lection des pipelines

| SIEM | Journaux | Pipeline recommandÃ© | Cible |
|------|----------|---------------------|-------|
| OpenSearch | Sysmon | `sysmon` | `opensearch_lucene` |
| Elastic | Winlogbeat (ECS) | `ecs_windows` | `lucene`, `eql` |
| Splunk | Journaux Windows | `splunk_windows` | `splunk` |
| SentinelOne | TÃ©lÃ©mÃ©trie Endpoint | *(aucun)* | `sentinel_one` |
| NetWitness | Journaux Windows | *(aucun)* | `net_witness` |


> âš ï¸ Le choix du pipeline est essentiel pour une dÃ©tection efficace.  
> Un pipeline inadaptÃ© peut produire des requÃªtes qui ne gÃ©nÃ¨rent aucun rÃ©sultat dans le SIEM.

---

## ğŸ”— Logique de corrÃ©lation

DÃ©clencher une alerte CRITIQUE si:
- RÃ¨gle 1 ET rÃ¨gle 2
- MÃªme machine (et utilisateur si possible)
- Intervalle de 10 minutes
La corrÃ©lation doit Ãªtre implÃ©mentÃ©e via les mÃ©canismes natifs du SIEM ou Ã  lâ€™aide dâ€™un SOAR.
---
## ğŸ§¬ Correspondance MITRE ATT&CK

- AccÃ¨s initial : T1566 (Phishing â€“ archive piÃ©gÃ©e)
- ExÃ©cution : T1204 (ExÃ©cution par lâ€™utilisateur)
- Persistance : T1547 (Dossier Startup / TÃ¢che planifiÃ©e)
---

---
## ğŸ”— References

- https://nvd.nist.gov/vuln/detail/CVE-2025-6218  
- https://thehackernews.com/2025/12/warning-winrar-vulnerability-cve-2025.html  
- https://foresiet.com/blog/apt-c-08-winrar-directory-traversal-exploit/  
- https://www.secpod.com/blog/archive-terror-dissecting-the-winrar-cve-2025-6218-exploit-apt-c-08s-stealth-move/
---

#### âš ï¸ Avertissement

- Ces rÃ¨gles sont fournies Ã  des fins dÃ©fensives uniquement. Toujours tester et adapter les rÃ¨gles Ã  votre environnement avant toute mise en production.
---
####  ğŸ‘¤ Auteur
**Adama Assiongbon**  
Consultant SOC / CTI  
LinkedIn : https://www.linkedin.com/in/adama-assiongbon-9029893a/
