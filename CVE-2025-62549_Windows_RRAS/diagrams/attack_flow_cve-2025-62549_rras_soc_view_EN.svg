<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
  <defs>
    <linearGradient id="bg" x1="0" x2="0" y1="0" y2="1">
      <stop offset="0%" stop-color="#0b1a3a"/>
      <stop offset="100%" stop-color="#071129"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="10" stdDeviation="12" flood-opacity="0.35"/>
    </filter>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="10" markerHeight="10" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#ff4d4d"/>
    </marker>
    <style>
      .title { font: 700 44px Arial, Helvetica, sans-serif; fill: #ffffff; }
      .subtitle { font: 400 18px Arial, Helvetica, sans-serif; fill: #c9d4ff; }
      .boxTitle { font: 700 20px Arial, Helvetica, sans-serif; fill: #ffffff; }
      .boxText { font: 400 16px Arial, Helvetica, sans-serif; fill: #e8ecff; }
      .pill { font: 700 14px Arial, Helvetica, sans-serif; fill: #ffffff; }
      .hint { font: 700 16px Arial, Helvetica, sans-serif; fill: #ffffff; }
    </style>
  </defs>

  <rect x="0" y="0" width="1600" height="900" fill="url(#bg)"/>

  <text x="800" y="85" text-anchor="middle" class="title">CVE-2025-62549 – RRAS Exploitation Chain (SOC View)</text>
  <text x="800" y="120" text-anchor="middle" class="subtitle">Windows Routing and Remote Access Service (RRAS) • Behavior-based detection</text>

  <g filter="url(#shadow)">
    <rect x="85" y="210" rx="22" ry="22" width="270" height="190" fill="#163a8a"/>
    <rect x="395" y="210" rx="22" ry="22" width="310" height="190" fill="#1f4aa8"/>
    <rect x="745" y="210" rx="22" ry="22" width="300" height="190" fill="#7a1d1d"/>
    <rect x="1085" y="210" rx="22" ry="22" width="300" height="190" fill="#7a1d1d"/>
    <rect x="1425" y="210" rx="22" ry="22" width="90" height="190" fill="#7a1d1d"/>
  </g>

  <text x="220" y="255" text-anchor="middle" class="boxTitle">1) Recon / Targeting</text>
  <text x="220" y="285" text-anchor="middle" class="boxText">Internet scan to find</text>
  <text x="220" y="307" text-anchor="middle" class="boxText">RRAS-exposed servers</text>
  <text x="220" y="342" text-anchor="middle" class="boxText">Indicators (network):</text>
  <text x="220" y="364" text-anchor="middle" class="boxText">VPN / Remote Access ports</text>

  <text x="550" y="255" text-anchor="middle" class="boxTitle">2) RRAS Exposed Service</text>
  <text x="550" y="285" text-anchor="middle" class="boxText">Windows server running</text>
  <text x="550" y="307" text-anchor="middle" class="boxText">Routing &amp; Remote Access</text>
  <text x="550" y="342" text-anchor="middle" class="boxText">Service context:</text>
  <text x="550" y="364" text-anchor="middle" class="boxText">svchost.exe (RemoteAccess)</text>

  <g>
    <rect x="445" y="375" rx="12" ry="12" width="58" height="26" fill="#0ea5e9"/>
    <rect x="510" y="375" rx="12" ry="12" width="58" height="26" fill="#0ea5e9"/>
    <rect x="575" y="375" rx="12" ry="12" width="58" height="26" fill="#0ea5e9"/>
    <text x="474" y="393" text-anchor="middle" class="pill">PPTP</text>
    <text x="539" y="393" text-anchor="middle" class="pill">L2TP</text>
    <text x="604" y="393" text-anchor="middle" class="pill">SSTP</text>
  </g>

  <text x="895" y="255" text-anchor="middle" class="boxTitle">3) Exploitation</text>
  <text x="895" y="285" text-anchor="middle" class="boxText">Malicious network packets</text>
  <text x="895" y="307" text-anchor="middle" class="boxText">trigger memory corruption</text>
  <text x="895" y="342" text-anchor="middle" class="boxText">Outcome:</text>
  <text x="895" y="364" text-anchor="middle" class="boxText">RCE as SYSTEM</text>

  <text x="1235" y="255" text-anchor="middle" class="boxTitle">4) Post-Exploitation</text>
  <text x="1235" y="285" text-anchor="middle" class="boxText">Credential dump / pivot</text>
  <text x="1235" y="307" text-anchor="middle" class="boxText">persistence / tooling</text>
  <text x="1235" y="342" text-anchor="middle" class="boxText">Common children:</text>
  <text x="1235" y="364" text-anchor="middle" class="boxText">cmd • powershell • rundll32</text>

  <text x="1470" y="255" text-anchor="middle" class="boxTitle">5) Impact</text>
  <text x="1470" y="330" text-anchor="middle" class="boxText">Network</text>
  <text x="1470" y="352" text-anchor="middle" class="boxText">Compromise</text>

  <line x1="355" y1="305" x2="395" y2="305" stroke="#ff4d4d" stroke-width="10" marker-end="url(#arrow)"/>
  <line x1="705" y1="305" x2="745" y2="305" stroke="#ff4d4d" stroke-width="10" marker-end="url(#arrow)"/>
  <line x1="1045" y1="305" x2="1085" y2="305" stroke="#ff4d4d" stroke-width="10" marker-end="url(#arrow)"/>
  <line x1="1385" y1="305" x2="1425" y2="305" stroke="#ff4d4d" stroke-width="10" marker-end="url(#arrow)"/>

  <g filter="url(#shadow)">
    <rect x="210" y="520" rx="26" ry="26" width="1180" height="190" fill="#b91c1c"/>
  </g>
  <text x="800" y="575" text-anchor="middle" class="title" style="font-size:34px;">SOC Detection Focus</text>
  <text x="800" y="615" text-anchor="middle" class="hint">High-signal behavior to alert on:</text>
  <text x="800" y="650" text-anchor="middle" class="boxText" style="font-size:18px;">
    svchost.exe hosting <tspan font-weight="700">RemoteAccess (RRAS)</tspan> spawning a shell / LOLBIN as <tspan font-weight="700">SYSTEM</tspan>
  </text>
  <text x="800" y="685" text-anchor="middle" class="boxText" style="font-size:18px;">
    Examples: cmd.exe, powershell.exe, pwsh.exe, rundll32.exe, mshta.exe, wscript.exe
  </text>

  <text x="800" y="820" text-anchor="middle" class="subtitle">
    Tip: Use BROAD (process) + STRICT (command line) for confidence-based response.
  </text>
</svg>
