# R√®gles de d√©tection RRAS - CVE-2025-62549

 üëâüèæ [ **English version available here** ](README.md)
 
## Pr√©sentation
Ce dossier contient **deux r√®gles Sigma compl√©mentaires** permettant de d√©tecter l‚Äôexploitation ou la post‚Äëexploitation de **CVE-2025-62549**, une vuln√©rabilit√© critique de type **RCE** affectant le service **Windows RRAS (Routing and Remote Access Service)**.

Ces r√®gles sont con√ßues pour les **analystes SOC (N1 / N2 / N3)** et suivent une **approche progressive et p√©dagogique** :
- Une r√®gle **large (BROAD)** pour la d√©tection pr√©coce
- Une r√®gle **stricte (STRICT)** pour la confirmation d‚Äôincident

---

## Pourquoi deux r√®gles ?
Une exploitation RRAS peut :
- d√©marrer de fa√ßon discr√®te
- √©voluer rapidement vers une compromission compl√®te

Utiliser deux r√®gles permet :
- une **d√©tection anticip√©e**
- une **r√©duction des faux positifs**
- une **r√©ponse SOC adapt√©e au niveau de confiance**

---

## R√®gle 1 - D√©tection BROAD
**Fichier :**  
[cve-2025-62549_RRAS_svchost_spawns_lolbin_BROAD_SYSTEM.yml](./rules/cve-2025-62549_RRAS_svchost_spawns_lolbin_BROAD_SYSTEM.yml)

### Objectif
D√©tecter **tout processus anormal lanc√© par le service RRAS**.

### Logique de d√©tection
- Processus parent : `svchost.exe`
- Service h√©berg√© : `RemoteAccess` (RRAS)
- Contexte : `SYSTEM`
- Processus enfant suspect :
  - `cmd.exe`
  - `powershell.exe`
  - `rundll32.exe`
  - `mshta.exe`
  - autres LOLBins

### Pourquoi c‚Äôest suspect
RRAS est un **service r√©seau** qui **ne doit jamais ex√©cuter de shell ou de script**.

### Usage SOC
- Triage analyste SOC N1
- D√©tection large / hunting
- Signal d‚Äôalerte pr√©coce
- Validation analyste requise

---

## R√®gle 2 - D√©tection STRICT
**Fichier :**  
[cve-2025-62549_RRAS_svchost_spawns_suspicious_cli_STRICT_SYSTEM.yml](./rules/cve-2025-62549_RRAS_svchost_spawns_suspicious_cli_STRICT_SYSTEM.yml)
### Objectif
Confirmer une **exploitation RRAS ou post-exploitation active**.

### Logique de d√©tection
Inclut les conditions de la r√®gle BROAD **et ajoute** :
- Indicateurs en ligne de commande :
  - `-enc`
  - `Invoke-WebRequest`
  - `curl` / `wget`
  - commandes de persistance (`schtasks`, `sc create`)

### Pourquoi le niveau de confiance est √©lev√©
Cette r√®gle capture des **actions offensives concr√®tes**.

### Usage SOC
- Escalade analyste SOC N2 / N3
- Incident confirm√©
- Containment imm√©diat + IR

---

## Utilisation combin√©e
| R√®gle | Niveau | Action |
|----|----|----|
| BROAD | Moyen | Investigation |
| STRICT | √âlev√© | Containment & escalade |

---

## Message cl√© pour le SOC
> **Tout shell lanc√© par `svchost.exe (RemoteAccess)` en SYSTEM est malveillant jusqu‚Äô√† preuve du contraire.**

---

## Mapping MITRE ATT&CK
- T1059 - Interpr√©teur de commandes
- T1105 - Transfert d‚Äôoutils
- T1071 - Protocole applicatif
- T1190 - Exploitation de service expos√©

---

## Note finale
Ces r√®gles sont **bas√©es sur le comportement**, donc :
- r√©sistantes aux changements d‚Äôexploit
- r√©utilisables pour de futures failles RRAS
- adapt√©es √† un SOC moderne
## Auteur

‚úçüèø  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

