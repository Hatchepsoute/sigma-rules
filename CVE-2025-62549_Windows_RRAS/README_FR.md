# Règles de détection RRAS - CVE-2025-62549

## Présentation
Ce dossier contient **deux règles Sigma complémentaires** permettant de détecter l’exploitation ou la post‑exploitation de **CVE-2025-62549**, une vulnérabilité critique de type **RCE** affectant le service **Windows RRAS (Routing and Remote Access Service)**.

Ces règles sont conçues pour les **analystes SOC (N1 / N2 / N3)** et suivent une **approche progressive et pédagogique** :
- Une règle **large (BROAD)** pour la détection précoce
- Une règle **stricte (STRICT)** pour la confirmation d’incident

---

## Pourquoi deux règles ?
Une exploitation RRAS peut :
- démarrer de façon discrète
- évoluer rapidement vers une compromission complète

Utiliser deux règles permet :
- une **détection anticipée**
- une **réduction des faux positifs**
- une **réponse SOC adaptée au niveau de confiance**

---

## Règle 1 - Détection BROAD
**Fichier :**  
`cve-2025-62549_RRAS_svchost_spawns_lolbin_BROAD_SYSTEM.yml`

### Objectif
Détecter **tout processus anormal lancé par le service RRAS**.

### Logique de détection
- Processus parent : `svchost.exe`
- Service hébergé : `RemoteAccess` (RRAS)
- Contexte : `SYSTEM`
- Processus enfant suspect :
  - `cmd.exe`
  - `powershell.exe`
  - `rundll32.exe`
  - `mshta.exe`
  - autres LOLBins

### Pourquoi c’est suspect
RRAS est un **service réseau** qui **ne doit jamais exécuter de shell ou de script**.

### Usage SOC
- Triage analyste SOC N1
- Détection large / hunting
- Signal d’alerte précoce
- Validation analyste requise

---

## Règle 2 - Détection STRICT
**Fichier :**  
`cve-2025-62549_RRAS_svchost_spawns_suspicious_cli_STRICT_SYSTEM.yml`

### Objectif
Confirmer une **exploitation RRAS ou post-exploitation active**.

### Logique de détection
Inclut les conditions de la règle BROAD **et ajoute** :
- Indicateurs en ligne de commande :
  - `-enc`
  - `Invoke-WebRequest`
  - `curl` / `wget`
  - commandes de persistance (`schtasks`, `sc create`)

### Pourquoi le niveau de confiance est élevé
Cette règle capture des **actions offensives concrètes**.

### Usage SOC
- Escalade analyste SOC N2 / N3
- Incident confirmé
- Containment immédiat + IR

---

## Utilisation combinée
| Règle | Niveau | Action |
|----|----|----|
| BROAD | Moyen | Investigation |
| STRICT | Élevé | Containment & escalade |

---

## Message clé pour le SOC
> **Tout shell lancé par `svchost.exe (RemoteAccess)` en SYSTEM est malveillant jusqu’à preuve du contraire.**

---

## Mapping MITRE ATT&CK
- T1059 - Interpréteur de commandes
- T1105 - Transfert d’outils
- T1071 - Protocole applicatif
- T1190 - Exploitation de service exposé

---

## Note finale
Ces règles sont **basées sur le comportement**, donc :
- résistantes aux changements d’exploit
- réutilisables pour de futures failles RRAS
- adaptées à un SOC moderne

