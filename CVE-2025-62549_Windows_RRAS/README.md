# RRAS Detection Rules â€“ CVE-2025-62549
[ğŸ‘‰ğŸ¾ **French version available here**](./README_FR.md)
## Overview
This folder contains **two complementary Sigma rules** designed to detect exploitation attempts or post-exploitation activity related to **CVE-2025-62549**, a critical Remote Code Execution vulnerability affecting **Windows RRAS (Routing and Remote Access Service)**.

The rules are written for **SOC analysts (L1/L2/L3)** and follow a **progressive detection strategy**:
- One **broad rule** for early detection and hunting
- One **strict rule** for high-confidence incident confirmation

---

## Why two rules?
RRAS exploitation does not always look the same in its early phase.  
Using two rules allows the SOC to:
- Detect suspicious behavior **as early as possible**
- Confirm exploitation with **minimal false positives**
- Apply different response actions depending on confidence level

---

## Rule 1 â€“ BROAD Detection
**File:**  
[cve-2025-62549_RRAS_svchost_spawns_lolbin_BROAD_SYSTEM.yml](./rules/cve-2025-62549_RRAS_svchost_spawns_lolbin_BROAD_SYSTEM.yml)

### Purpose
Detect **any abnormal child process** spawned by the RRAS service.

### Detection logic
- Parent process: `svchost.exe`
- Parent service: `RemoteAccess` (RRAS)
- Execution context: `SYSTEM`
- Child process:
  - `cmd.exe`
  - `powershell.exe`
  - `rundll32.exe`
  - `mshta.exe`
  - other LOLBins

### Why this is suspicious
RRAS is a **network service** and should **never spawn a shell or script interpreter**.

### SOC usage
- SOC L1 triage
- Threat hunting
- Early warning signal
- Requires analyst validation

---

## Rule 2 - STRICT Detection
**File:**  
[cve-2025-62549_RRAS_svchost_spawns_suspicious_cli_STRICT_SYSTEM.yml](./rules/cve-2025-62549_RRAS_svchost_spawns_suspicious_cli_STRICT_SYSTEM.yml)

### Purpose
Confirm **probable exploitation or post-exploitation** activity.

### Detection logic
Includes everything from the BROAD rule **plus**:
- Suspicious command-line patterns:
  - `-enc`
  - `Invoke-WebRequest`
  - `curl` / `wget`
  - persistence commands (`schtasks`, `sc create`)

### Why this is high confidence
This rule detects **active attacker behavior**, not just abnormal process creation.

### SOC usage
- SOC L2/L3 escalation
- Incident confirmation
- Immediate containment and IR

---

## How to use both rules together
| Rule | Confidence | Action |
|----|----|----|
| BROAD | Medium | Investigate |
| STRICT | High | Contain & escalate |

---

## Key SOC takeaway
> **Any shell spawned by `svchost.exe (RemoteAccess)` running as SYSTEM should be treated as malicious until proven otherwise.**

---

## MITRE ATT&CK Mapping
- T1059 â€“ Command and Scripting Interpreter
- T1105 â€“ Ingress Tool Transfer
- T1071 â€“ Application Layer Protocol
- T1190 â€“ Exploit Public-Facing Application

---

## Final note
These rules are **behavior-based**, reusable, and remain effective even if:
- the exploit code changes
- the CVE is re-used in future attacks
## Author

âœğŸ¿  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

