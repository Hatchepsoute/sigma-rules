ðŸ‘‰ðŸ¾ **French version available here:** [README_FR.md](README_FR.md)
# CVE-2025-50165 â€“ Windows Graphics Component Client-Side Exploitation (Sigma Rules)

## Status
- **Experimental**
- Detection Engineering / SOC Production Ready (with tuning)

---

## Overview

This directory contains **two correlated Sigma rules** designed to detect **real client-side exploitation patterns** associated with **CVE-2025-50165** affecting the **Windows Graphics Component (`windowscodecs.dll`)**.

The detection strategy follows the **official sigma-rules philosophy**:
- A **BROAD+ rule** for early visibility with controlled noise
- A **STRICT rule** for high-confidence exploitation detection

These rules are designed to be **deployed together**.

---

## Vulnerability Context

| Item | Details |
|------|--------|
| CVE | CVE-2025-50165 |
| CVSS | 9.8 (Critical) |
| Component | Windows Graphics Component |
| Affected DLL | windowscodecs.dll |
| Exploitation Vector | Malicious image (JPEG) |
| Context | Office / PDF / Email / Preview / Explorer |
| Impact | Client-side RCE |

Attackers can embed a **crafted image** into a document or previewable file.  
When rendered, the Windows graphics stack is triggered and exploitation occurs **without further user interaction**.

---

## Threat Model

Post-exploitation activity typically includes:
- Execution of **Windows LOLBins**
- Encoded or in-memory PowerShell
- Remote script or payload execution
- Transition to malware deployment or C2

Sigma rules do not detect memory corruption directly but reliably detect **observable exploitation effects**.

---

## Rule 1 - BROAD+

### File
[cve-2025-50165_BROAD_renderer_spawns_lolbin.yml](./rules/cve-2025-50165_BROAD_renderer_spawns_lolbin.yml)

### Purpose
Detect **early suspicious client-side exploitation behavior** with reduced false positives compared to classic BROAD rules.

### Detection Logic
- **Parent process**: document or image rendering context (Office, PDF reader, email client, Explorer, Photos)
- **Child process**: non-graphical executable / LOLBin
- **Command line**: suspicious execution patterns (encoded PowerShell, IEX, remote URLs, DLL execution)

### SOC Interpretation
- Suspicious exploitation attempt
- Early-stage visibility
- Requires contextual validation

### Recommended Usage
- Threat hunting
- SOC analyst L1 / L2 triage
- Correlation precursor

---

## Rule 2 - STRICT

### File
[cve-2025-50165_STRICT_renderer_spawns_lolbin_with_malicious_cli.yml](./rules/cve-2025-50165_STRICT_renderer_spawns_lolbin_with_malicious_cli.yml)

### Purpose
Detect **highly probable exploitation** with **low false-positive rate**.

### Detection Logic
- Rendering context as parent process
- Specific LOLBins as child processes
- **Clearly malicious command-line indicators**:
  - Encoded PowerShell
  - `mshta` with URL
  - `rundll32` DLL execution
  - Remote script execution

### SOC Interpretation
- Exploitation very likely
- Incident-ready signal

### Recommended Usage
- SOC analyst L2 / L3 escalation
- Incident declaration
- SOAR automation trigger

---

## Correlation Strategy (Required)

These rules are designed to be **correlated**.

| Trigger Pattern | SOC Meaning |
|---------------|------------|
| BROAD+ only | Suspicious activity |
| STRICT only | Highly probable exploitation |
| **BROAD+ + STRICT** | ðŸš¨ **Confirmed exploitation** |

Correlation can be implemented in:
- SIEM
- SOAR platforms (TheHive, Shuffle, XSOAR)

---

## SOC Comparison Table

| Criteria | BROAD+ | STRICT |
|--------|--------|--------|
| Coverage | Medium / Broad | Narrow |
| False positives | Low | Very low |
| Confidence | Medium | High |
| CLI inspection | âœ… | âœ… |
| Incident-ready | âŒ | âœ… |
| SOC analyst | L1 / L2 | L2 / L3 |

---

## Best Practice

> Always deploy **both rules together**.
>
> - **BROAD+** provides early exploitation visibility  
> - **STRICT** confirms malicious intent  
>
> This layered approach delivers **robust detection for CVE-2025-50165 client-side exploitation chains**.
**Author:** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
