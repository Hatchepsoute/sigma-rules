title: CVE-2025-50165 (BROAD+) - Renderer Spawns Suspicious Process with Suspicious CLI
id: 0f2b9c8a-3f2b-4f5b-a4e1-8f9c6d1a2b33
status: experimental
description: |-
  [EN] Broad+ detection for CVE-2025-50165-related client-side exploitation patterns.
  Detects suspicious non-graphical child processes spawned by a document or image rendering context
  (Office applications, PDF readers, email clients, or Windows preview/Photos),
  AND requires the child command line to contain common suspicious execution patterns (encoded PowerShell, IEX, WebClient/iwr, or http(s)).
  This significantly reduces false positives compared to pure parent->child broad detections, while keeping good coverage.

  [FR] Détection Broad+ pour des scénarios d’exploitation côté client liés à CVE-2025-50165.
  Détecte des processus enfants non graphiques suspects lancés par un contexte de rendu de document ou d’image
  (applications Office, lecteurs PDF, clients mail, prévisualisation Windows/Photos),
  ET exige la présence de motifs suspects dans la ligne de commande (PowerShell encodé, IEX, WebClient/iwr, ou http(s)).
  Cette approche réduit nettement les faux positifs par rapport à une détection large parent->child, tout en conservant une bonne couverture.
author: |-
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025/12/18
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-50165
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-50165
  - https://www.zscaler.com/blogs/security-research/cve-2025-50165-critical-flaw-windows-graphics-component
  - https://github.com/encrypter15/CVE-2025-50165-x64-Exploit
tags:
  - cve.2025-50165
  - attack.t1203
  - attack.t1059
logsource:
  product: windows
  category: process_creation
detection:
  parent_renderers:
    ParentImage|endswith:
      - '\explorer.exe'
      - '\dllhost.exe'
      - '\prevhost.exe'
      - '\outlook.exe'
      - '\thunderbird.exe'
      - '\winword.exe'
      - '\excel.exe'
      - '\powerpnt.exe'
      - '\msaccess.exe'
      - '\onenote.exe'
      - '\acrord32.exe'
      - '\acrobat.exe'
      - '\sumatrapdf.exe'
      - '\foxitpdfreader.exe'
      - '\pdfxcview.exe'
      - '\microsoft.photos.exe'

  suspicious_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\schtasks.exe'
      - '\bitsadmin.exe'
      - '\certutil.exe'
      - '\wmic.exe'
      - '\curl.exe'
      - '\wget.exe'

  suspicious_cli:
    CommandLine|contains:
      # PowerShell encoded / common in-memory patterns
      - ' -enc '
      - ' -encodedcommand '
      - 'FromBase64String'
      - 'IEX'
      - 'Invoke-Expression'
      - 'DownloadString'
      - 'Invoke-WebRequest'
      - 'iwr '
      - 'New-Object Net.WebClient'
      # Generic remote indicators
      - 'http://'
      - 'https://'
      # mshta remote execution
      - 'mshta http'
      - 'mshta https'
      # rundll32 / regsvr32 patterns often seen in abuse
      - 'rundll32 '
      - '.dll'
      - 'regsvr32 '
      - '/i:'
      - 'scrobj.dll'

  condition: parent_renderers and suspicious_child and suspicious_cli
falsepositives:
  - "Rare enterprise automation or add-ins spawning system utilities with remote/encoded patterns; tune by signer/path/parent command line."
  - "[FR] Automatisations ou add-ins d’entreprise rares lançant des utilitaires système avec motifs encodés/distants ; affiner via signataire/chemin/parent."
level: medium

