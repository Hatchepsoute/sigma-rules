ðŸ‘‰ðŸ¾ **Version anglaise disponible ici :** [README.md](README.md)
# CVE-2025-50165 â€“ Exploitation cÃ´tÃ© client du composant graphique Windows (RÃ¨gles Sigma)

## Statut
- **ExpÃ©rimental**
- PrÃªt SOC / Detection Engineering (aprÃ¨s tuning)

---

## PrÃ©sentation

Ce rÃ©pertoire contient **deux rÃ¨gles Sigma corrÃ©lÃ©es** visant Ã  dÃ©tecter des **scÃ©narios rÃ©els dâ€™exploitation cÃ´tÃ© client** liÃ©s Ã  **CVE-2025-50165**, affectant le **composant graphique Windows (`windowscodecs.dll`)**.

La stratÃ©gie suit la **philosophie officielle sigma-rules** :
- Une rÃ¨gle **BROAD+** pour une visibilitÃ© prÃ©coce maÃ®trisÃ©e
- Une rÃ¨gle **STRICT** pour une dÃ©tection Ã  haute confiance

ðŸ‘‰ Ces rÃ¨gles doivent Ãªtre **dÃ©ployÃ©es conjointement**.

---

## Contexte de la vulnÃ©rabilitÃ©

| Ã‰lÃ©ment | DÃ©tail |
|------|-------|
| CVE | CVE-2025-50165 |
| CVSS | 9.8 (Critique) |
| Composant | Windows Graphics |
| DLL | windowscodecs.dll |
| Vecteur | Image malveillante (JPEG) |
| Contexte | Office / PDF / Mail / Preview |
| Impact | RCE cÃ´tÃ© client |

Un attaquant peut intÃ©grer une **image spÃ©cialement forgÃ©e** dans un document ou un fichier prÃ©visualisable.  
Lors du rendu, lâ€™exploitation est dÃ©clenchÃ©e **sans action supplÃ©mentaire de lâ€™utilisateur**.

---

## ModÃ¨le de menace

AprÃ¨s exploitation, on observe gÃ©nÃ©ralement :
- Lâ€™exÃ©cution de **LOLBins Windows**
- PowerShell encodÃ© ou en mÃ©moire
- Scripts ou payloads distants
- DÃ©ploiement de malware ou C2

Sigma ne dÃ©tecte pas la corruption mÃ©moire, mais dÃ©tecte efficacement les **effets observables de lâ€™exploitation**.

---

## RÃ¨gle 1 â€“ BROAD+

### Fichier
[cve-2025-50165_BROAD_renderer_spawns_lolbin.yml](./rules/cve-2025-50165_BROAD_renderer_spawns_lolbin.yml)

### Objectif
DÃ©tecter **prÃ©cocement** une exploitation cÃ´tÃ© client suspecte avec un bruit maÃ®trisÃ©.

### Logique de dÃ©tection
- **Processus parent** : contexte de rendu (Office, PDF, mail, Explorer, Photos)
- **Processus enfant** : exÃ©cutable non graphique / LOLBin
- **Ligne de commande** : motifs suspects (PowerShell encodÃ©, IEX, URL, DLL)

### InterprÃ©tation SOC
- Tentative dâ€™exploitation probable
- VisibilitÃ© prÃ©coce
- Validation analyste requise

### Usage recommandÃ©
- Threat hunting
- Triage SOC L1 / L2
- PrÃ©-corrÃ©lation

---

## RÃ¨gle 2 - STRICT

### Fichier
[cve-2025-50165_STRICT_renderer_spawns_lolbin_with_malicious_cli.yml](./rules/cve-2025-50165_STRICT_renderer_spawns_lolbin_with_malicious_cli.yml)
### Objectif
DÃ©tecter une **exploitation hautement probable** avec **peu de faux positifs**.

### Logique de dÃ©tection
- Contexte de rendu comme parent
- LOLBins spÃ©cifiques comme enfants
- **Ligne de commande clairement malveillante** :
  - PowerShell encodÃ©
  - `mshta` avec URL
  - `rundll32` avec DLL
  - Scripts distants

### InterprÃ©tation SOC
- Exploitation trÃ¨s probable
- Signal prÃªt incident

### Usage recommandÃ©
- Escalade SOC L2 / L3
- DÃ©claration dâ€™incident
- DÃ©clenchement SOAR

---

## CorrÃ©lation des rÃ¨gles (ESSENTIEL)

| DÃ©clenchement | InterprÃ©tation SOC |
|-------------|-------------------|
| BROAD+ seul | ActivitÃ© suspecte |
| STRICT seul | Exploitation trÃ¨s probable |
| **BROAD+ + STRICT** | ðŸš¨ **Exploitation confirmÃ©e** |

La corrÃ©lation peut Ãªtre implÃ©mentÃ©e dans :
- un SIEM,
- un SOAR (TheHive, Shuffle, XSOAR).

---

## Tableau comparatif SOC

| CritÃ¨re | BROAD+ | STRICT |
|--------|--------|--------|
| Couverture | Moyenne / Large | CiblÃ©e |
| Faux positifs | Faibles | TrÃ¨s faibles |
| Confiance | Moyenne | Ã‰levÃ©e |
| Analyse CLI | âœ… | âœ… |
| PrÃªt incident | âŒ | âœ… |
| Niveau SOC | L1 / L2 | L2 / L3 |

---

## Bonne pratique

> Toujours dÃ©ployer **les deux rÃ¨gles ensemble**.
>
> - **BROAD+** = visibilitÃ© prÃ©coce  
> - **STRICT** = confirmation dâ€™exploitation  
>
> Cette approche en couches assure une **dÃ©tection robuste de CVE-2025-50165**.
**Author:** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
