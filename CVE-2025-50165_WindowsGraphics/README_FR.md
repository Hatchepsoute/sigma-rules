# CVE-2025-50165 ‚Äì Exploitation c√¥t√© client du composant graphique Windows (R√®gles Sigma)

## Statut
- **Exp√©rimental**
- Pr√™t SOC / Detection Engineering (apr√®s tuning)

---

## Pr√©sentation

Ce r√©pertoire contient **deux r√®gles Sigma corr√©l√©es** visant √† d√©tecter des **sc√©narios r√©els d‚Äôexploitation c√¥t√© client** li√©s √† **CVE-2025-50165**, affectant le **composant graphique Windows (`windowscodecs.dll`)**.

La strat√©gie suit la **philosophie officielle sigma-rules** :
- Une r√®gle **BROAD+** pour une visibilit√© pr√©coce ma√Ætris√©e
- Une r√®gle **STRICT** pour une d√©tection √† haute confiance

üëâ Ces r√®gles doivent √™tre **d√©ploy√©es conjointement**.

---

## Contexte de la vuln√©rabilit√©

| √âl√©ment | D√©tail |
|------|-------|
| CVE | CVE-2025-50165 |
| CVSS | 9.8 (Critique) |
| Composant | Windows Graphics |
| DLL | windowscodecs.dll |
| Vecteur | Image malveillante (JPEG) |
| Contexte | Office / PDF / Mail / Preview |
| Impact | RCE c√¥t√© client |

Un attaquant peut int√©grer une **image sp√©cialement forg√©e** dans un document ou un fichier pr√©visualisable.  
Lors du rendu, l‚Äôexploitation est d√©clench√©e **sans action suppl√©mentaire de l‚Äôutilisateur**.

---

## Mod√®le de menace

Apr√®s exploitation, on observe g√©n√©ralement :
- L‚Äôex√©cution de **LOLBins Windows**
- PowerShell encod√© ou en m√©moire
- Scripts ou payloads distants
- D√©ploiement de malware ou C2

Sigma ne d√©tecte pas la corruption m√©moire, mais d√©tecte efficacement les **effets observables de l‚Äôexploitation**.

---

## R√®gle 1 ‚Äì BROAD+

### Fichier
`cve-2025-50165_BROAD_renderer_spawns_lolbin.yml`

### Objectif
D√©tecter **pr√©cocement** une exploitation c√¥t√© client suspecte avec un bruit ma√Ætris√©.

### Logique de d√©tection
- **Processus parent** : contexte de rendu (Office, PDF, mail, Explorer, Photos)
- **Processus enfant** : ex√©cutable non graphique / LOLBin
- **Ligne de commande** : motifs suspects (PowerShell encod√©, IEX, URL, DLL)

### Interpr√©tation SOC
- Tentative d‚Äôexploitation probable
- Visibilit√© pr√©coce
- Validation analyste requise

### Usage recommand√©
- Threat hunting
- Triage SOC L1 / L2
- Pr√©-corr√©lation

---

## R√®gle 2 ‚Äì STRICT

### Fichier
`cve-2025-50165_STRICT_renderer_spawns_lolbin_with_malicious_cli.yml`

### Objectif
D√©tecter une **exploitation hautement probable** avec **peu de faux positifs**.

### Logique de d√©tection
- Contexte de rendu comme parent
- LOLBins sp√©cifiques comme enfants
- **Ligne de commande clairement malveillante** :
  - PowerShell encod√©
  - `mshta` avec URL
  - `rundll32` avec DLL
  - Scripts distants

### Interpr√©tation SOC
- Exploitation tr√®s probable
- Signal pr√™t incident

### Usage recommand√©
- Escalade SOC L2 / L3
- D√©claration d‚Äôincident
- D√©clenchement SOAR

---

## Corr√©lation des r√®gles (ESSENTIEL)

| D√©clenchement | Interpr√©tation SOC |
|-------------|-------------------|
| BROAD+ seul | Activit√© suspecte |
| STRICT seul | Exploitation tr√®s probable |
| **BROAD+ + STRICT** | üö® **Exploitation confirm√©e** |

La corr√©lation peut √™tre impl√©ment√©e dans :
- un SIEM,
- un SOAR (TheHive, Shuffle, XSOAR).

---

## Tableau comparatif SOC

| Crit√®re | BROAD+ | STRICT |
|--------|--------|--------|
| Couverture | Moyenne / Large | Cibl√©e |
| Faux positifs | Faibles | Tr√®s faibles |
| Confiance | Moyenne | √âlev√©e |
| Analyse CLI | ‚úÖ | ‚úÖ |
| Pr√™t incident | ‚ùå | ‚úÖ |
| Niveau SOC | L1 / L2 | L2 / L3 |

---

## Bonne pratique

> Toujours d√©ployer **les deux r√®gles ensemble**.
>
> - **BROAD+** = visibilit√© pr√©coce  
> - **STRICT** = confirmation d‚Äôexploitation  
>
> Cette approche en couches assure une **d√©tection robuste de CVE-2025-50165**.
