title: Suspicious LOLBin Execution with High-Risk Command Patterns (CVE-2025-54100)
id: c04f0616-4205-416c-884b-8b2d0c958603
status: experimental
description: |
  Detects Windows LOLBins with high-risk command patterns including network downloads, obfuscation, and execution. Broad coverage for exploitation detection.
  
  Détecte le téléchargement de contenu via PowerShell depuis le Web, suivi du lancement de processus fils suspects. Détection à haut niveau de confiance pour les activités post-exploitation, incluant l'exploitation de la vulnérabilité CVE-2025-54100.
author:  Adama Assiongbon (SOC/CTI Consultant)   |  https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025-12-22
modified: 2026-02-06
references:
  - https://www.cve.org/CVERecord?id=CVE-2025-54100
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54100
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100
  - https://github.com/ThemeHackers/CVE-2025-54100
tags:
  - attack.t1059
  - attack.t1105
  - attack.t1218
  - attack.t1027
  - cve.2025-54100
logsource:
  product: windows
  category: process_creation
detection:
  # Living-off-the-land binaries
  selection_lolbin:
    Image|endswith:
      - \powershell.exe
      - \pwsh.exe
      - \cmd.exe
      - \mshta.exe
      - \rundll32.exe
      - \regsvr32.exe
      - \wscript.exe
      - \cscript.exe
      - \bitsadmin.exe
      - \certutil.exe
  
  # Network/Download indicators
  selection_network:
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - 'ftp://'
      - '.ps1'
      - '.exe'
      - '.dll'
      - '.vbs'
      - '.js'
      - '.hta'
  
  # Obfuscation/Execution indicators
  selection_execution:
    CommandLine|contains:
      # PowerShell obfuscation
      - '-enc '
      - '-EncodedCommand'
      - 'FromBase64String'
      - 'Invoke-Expression'
      - 'IEX'
      # Script engine obfuscation
      - 'eval('
      - 'exec('
      - 'javascript:'
      # LOLBin specific patterns
      - 'regsvr32 /s /n /u /i:'
      - 'rundll32 javascript:'
      - 'mshta javascript:'
      - 'wscript /e:'
      - 'cscript /e:'
  
  # Single high-risk indicators
  selection_high_risk_single:
    CommandLine|contains:
      # PowerShell evasion
      - '-ExecutionPolicy Bypass'
      - '-WindowStyle Hidden'
      - '-NoProfile -NonInteractive -NoLogo'
      # Download execution
      - 'DownloadString('
      - 'DownloadFile('
      - ' iwr '
      - 'Invoke-WebRequest'
      # Certutil abuse
      - 'certutil -urlcache -split -f'
      - 'certutil -decode'
      # Bitsadmin abuse
      - 'bitsadmin /transfer '
      # Hidden execution
      - 'Start-Process -WindowStyle Hidden'
  
  # Context-aware exclusions
  filter_whitelist:
    - CommandLine|contains:
        - 'Windows Update'
        - 'Microsoft Update'
        - 'WSUS'
        - 'SCCM'
        - 'Intune'
        - 'Chocolatey'
        - 'NuGet'
    - ImagePath|contains:
        - 'Program Files'
        - 'Program Files (x86)'
    - User|endswith:
        - '$'
        - 'SYSTEM'
    - CommandLine|re: 'https?://(update\.microsoft\.com|go\.microsoft\.com|download\.windowsupdate\.com)'
  
  # Main detection logic
  condition: 
    selection_lolbin 
    and (
      (selection_network and selection_execution) or    
      selection_high_risk_single                        
    )
    and not filter_whitelist

falsepositives:
  - Enterprise software deployment with approved change tickets
  - Patch management systems downloading updates
  - Security tools performing authorized remote operations
  - Development/CI/CD pipelines with proper governance
  - System management tools (Ansible, Chef, Puppet)

level: medium
