title: PowerShell Web Download with Suspicious Child Execution (High Confidence - CVE-2025-54100)
id: 2b51c3c7-ba03-47a3-8354-d18cc83aacf6
status: experimental
description: |
  Detects PowerShell downloading content from web then spawning suspicious child processes. High-confidence detection for post-exploitation activity including CVE-2025-54100 exploitation.
  
  Détecte le téléchargement de contenu via PowerShell depuis le Web, suivi du lancement de processus fils suspects. Détection à haut niveau de confiance pour les activités post-exploitation, incluant l'exploitation de la vulnérabilité CVE-2025-54100.
author:   Adama Assiongbon (SOC/CTI Consultant) | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: '2025-12-22'
modified: 2026-02-06
references:
  - https://www.cve.org/CVERecord?id=CVE-2025-54100
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54100
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100
  - https://github.com/ThemeHackers/CVE-2025-54100
tags:
  - attack.t1059.001
  - attack.t1105
  - attack.t1204.002
  - cve.2025-54100
logsource:
  product: windows
  category: process_creation
detection:
  # Parent must be PowerShell
  selection_parent_powershell:
    ParentImage|endswith:
      - \powershell.exe
      - \pwsh.exe
  
  # Parent command line contains download indicators
  selection_parent_download:
    ParentCommandLine|contains:
      # Explicit download commands
      - 'Invoke-WebRequest'
      - ' iwr '
      - 'DownloadFile'
      - 'DownloadString'
      - 'DownloadData'
      # WebClient usage
      - 'Net.WebClient'
      - 'System.Net.WebClient'
      # Common parameters
      - '-Uri '
      - '-OutFile '
  
  # Child is a suspicious execution binary
  selection_child_suspicious:
    Image|endswith:
      - \cmd.exe
      - \powershell.exe
      - \pwsh.exe
      - \rundll32.exe
      - \regsvr32.exe
      - \mshta.exe
      - \wscript.exe
      - \cscript.exe
      - \certutil.exe
      - \bitsadmin.exe
      - \msiexec.exe
  
  # Exclusions for common legitimate use cases
  filter_legitimate:
    - ParentCommandLine|contains|all:
        - '-Help'
        - 'Get-'
    - ParentCommandLine|startswith:
        - 'powershell -Command "Get-'
        - 'pwsh -Command "Get-'
    - User|endswith:
        - '$'
        - 'SYSTEM'
        - 'LOCAL SERVICE'
        - 'NETWORK SERVICE'
    - ParentCommandLine|contains:
        - 'WindowsPowerShell\v1.0\Modules\'
        - 'Program Files\'
        - 'Update-'
        - 'Install-'
  
  condition: 
    selection_parent_powershell 
    and selection_parent_download 
    and selection_child_suspicious
    and not filter_legitimate

falsepositives:
  - Software deployment tools (SCCM, Intune, PDQ Deploy)
  - Legitimate administrative scripts with proper change control
  - Development/build pipelines downloading and executing code
  - Security tools performing authorized remote operations

level: high
