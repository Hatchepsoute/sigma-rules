title: PowerShell Invoke-WebRequest Followed by Suspicious Child Process (CVE-2025-54100 Pattern)
id: 2b4d8e4a-6c33-4f67-bf41-4f0d6b8dbe7b
status: experimental
description: >
  Detects suspicious process creation where the parent is PowerShell and the parent command line
  contains Invoke-WebRequest (IWR). This is consistent with post-exploitation execution patterns
  observed in CVE-2025-54100 scenarios where HTML parsing can lead to unintended code execution.
  
author: |-
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
  
references:
  - https://nvd.nist.gov/vuln/detail/cve-2025-54100
  - https://socprime.com/fr/blog/cve-2025-62221-and-cve-2025-54100-vulnerabilities/
  - https://github.com/ThemeHackers/CVE-2025-54100
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100
tags:
  - attack.t1059
  - attack.t1105
  - cve.2025-54100
logsource:
  product: windows
  category: process_creation
detection:
  selection_parent_powershell:
    ParentImage|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
  selection_parent_iwr:
    ParentCommandLine|contains:
      - 'Invoke-WebRequest'
      - ' iwr '
      - 'wget '
      - 'curl '
  selection_child_exec:
    Image|endswith:
      - '\cmd.exe'
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\rundll32.exe'
      - '\regsvr32.exe'
      - '\mshta.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\calc.exe'
  condition: selection_parent_powershell and selection_parent_iwr and selection_child_exec
falsepositives:
  - Admin automation scripts using Invoke-WebRequest and legitimately spawning child processes
  - Software deployment tooling that stages scripts via PowerShell
level: high

