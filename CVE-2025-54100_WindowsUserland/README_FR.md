<!-- Badges (edit the links if you rename the repo/branch) -->
![Sigma](https://img.shields.io/badge/Sigma-rules-blue)
![SOC](https://img.shields.io/badge/SOC-ready-success)
![SOAR](https://img.shields.io/badge/SOAR-playbooks-important)
![MITRE](https://img.shields.io/badge/MITRE-ATT%26CK-lightgrey)
![License](https://img.shields.io/badge/License-MIT-informational)

# RCE Userland Windows - LOLBins & PowerShell IWR (RÃ¨gles Sigma)

 [ğŸ‘‰ğŸ¾  **English version favailable here**](README.md)
---

## PrÃ©sentation

Ce rÃ©pertoire contient **deux rÃ¨gles Sigma corrÃ©lÃ©es** visant Ã  dÃ©tecter des **comportements post-exploitation liÃ©s Ã  une RCE userland sur Windows**.

Ces rÃ¨gles sont **basÃ©es sur les comportements** et couvrent plusieurs scÃ©narios dâ€™exploitation, notamment **CVE-2025-54100** et des vulnÃ©rabilitÃ©s similaires.

Elles respectent la **philosophie officielle sigma-rules** :
- Une rÃ¨gle **BROAD** pour une couverture large â¡ï¸ [windows_userland_rce_lolbin_execution_broad_cve-2025-54100.yml](./rules/windows_userland_rce_lolbin_execution_broad_cve-2025-54100.yml)
- Une rÃ¨gle **STRICT** pour une confirmation Ã  haute confiance â¡ï¸ [windows_powershell_iwr_child_process_execution_strict_cve-2025-54100.yml](./rules/windows_powershell_iwr_child_process_execution_strict_cve-2025-54100.yml)

ğŸ‘‰ğŸ¾  Elles doivent Ãªtre **dÃ©ployÃ©es ensemble**.

---

## Contexte de menace

AprÃ¨s une RCE userland (navigateur, Office, document, scriptâ€¦), les attaquants utilisent frÃ©quemment :

- Des **LOLBins Windows** (PowerShell, cmd, mshta, rundll32â€¦)
- Le tÃ©lÃ©chargement de payloads distants
- Lâ€™exÃ©cution de loaders ou de stagers
- La prÃ©paration de la persistance ou dâ€™un ransomware

Sigma ne dÃ©tecte pas la vulnÃ©rabilitÃ©, mais dÃ©tecte efficacement les **comportements dangereux post-exÃ©cution**.

---

## RÃ¨gle 1 â€“ BROAD

### Nom
**ExÃ©cution suspecte de LOLBins avec ligne de commande risquÃ©e (BROAD)**

### Objectif
DÃ©tecter lâ€™exÃ©cution de LOLBins Windows combinÃ©e Ã  des **patterns de ligne de commande risquÃ©s**.

### Logique de dÃ©tection
- **Image du processus** : LOLBins courants
- **Ligne de commande** : accÃ¨s rÃ©seau, encodage, exÃ©cution
- **Sans contrainte sur le parent**

### InterprÃ©tation SOC
- ActivitÃ© suspecte
- Exploitation ou staging possible
- Validation analyste requise

### Usage recommandÃ©
- Triage SOC N1 / N2
- Threat hunting
- DÃ©tection comportementale de base

---

## RÃ¨gle 2 â€“ STRICT

### Nom
**PowerShell Invoke-WebRequest suivi dâ€™une exÃ©cution enfant (STRICT)**

### Objectif
DÃ©tecter un **schÃ©ma tÃ©lÃ©chargement â†’ exÃ©cution Ã  haute confiance**.

### Logique de dÃ©tection
- **Processus parent** : PowerShell
- **Commande parent** : Invoke-WebRequest / iwr / curl / wget
- **Processus enfant** : LOLBins exÃ©cutables

### InterprÃ©tation SOC
- **ActivitÃ© hautement malveillante**
- ChaÃ®ne de post-exploitation Ã©vidente

### Usage recommandÃ©
- Escalade SOC L2 / L3
- DÃ©claration dâ€™incident
- Containment automatisÃ© (SOAR)

---

## CorrÃ©lation des rÃ¨gles (ESSENTIEL)

Ces rÃ¨gles sont conÃ§ues pour Ãªtre **corrÃ©lÃ©es**.

### Logique recommandÃ©e

1. **DÃ©clenchement BROAD**
   - ExÃ©cution LOLBin suspecte dÃ©tectÃ©e
   - Contexte Ã©tabli

2. **DÃ©clenchement STRICT**
   - TÃ©lÃ©chargement et exÃ©cution confirmÃ©s
   - Incident validÃ©

Cette corrÃ©lation :
- RÃ©duit les faux positifs
- Conserve une visibilitÃ© prÃ©coce

---

## Tableau comparatif SOC

| CritÃ¨re | BROAD | STRICT |
|------|------|------|
| PortÃ©e | Large | CiblÃ©e |
| Faux positifs | Possibles | TrÃ¨s rares |
| Niveau de confiance | Moyen | Ã‰levÃ© |
| Analyse parent-enfant | âŒ | âœ… |
| DÃ©tection tÃ©lÃ©chargement | âœ… | âœ… |
| ExÃ©cution explicite | âŒ | âœ… |
| Niveau SOC | L1 / L2 | L2 / L3 |
| Incident confirmÃ© | âŒ | âœ… |

---

## Bonne pratique

> Toujours dÃ©ployer **les deux rÃ¨gles ensemble**.
>
> - BROAD = couverture comportementale large  
> - STRICT = confirmation dâ€™intention malveillante  
>
> Cette combinaison assure une **dÃ©tection robuste des chaÃ®nes RCE userland Windows**.
