# CVE-2025-68947 - D√©tection BYOVD li√©e √† la campagne ransomware Black Basta

üëâüèæ **English version favailable here**](README.md)

## Pr√©sentation

Ce d√©p√¥t fournit **deux r√®gles Sigma** destin√©es √† d√©tecter la **phase d‚Äô√©vasion d√©fensive** d‚Äôune campagne ransomware exploitant la technique **BYOVD (Bring Your Own Vulnerable Driver)**, telle que d√©crite dans l‚Äôarticle de threat intelligence suivant :

- https://www.security.com/threat-intelligence/black-basta-ransomware-byovd

La campagne est attribu√©e au **groupe ransomware Black Basta** et repose sur l‚Äôabus d‚Äôun pilote noyau l√©gitime mais vuln√©rable (**NSecKrnl.sys ‚Äì CVE-2025-68947**) afin de **neutraliser les solutions EDR/AV avant le chiffrement**.

Les r√®gles propos√©es sont **techniques et comportementales**, sans d√©pendance √† une attribution rigide, afin de garantir leur **p√©rennit√© et leur r√©utilisabilit√©** par la communaut√© SOC.

---

## R√©sum√© du sc√©nario d‚Äôattaque

D‚Äôapr√®s l‚Äôanalyse de l‚Äôarticle :

1. Les attaquants d√©posent un pilote noyau vuln√©rable (`NSecKrnl.sys`)
2. Ils exploitent **CVE-2025-68947** pour obtenir des privil√®ges kernel (BYOVD)
3. Le pilote est utilis√© pour **arr√™ter ou tuer les processus de s√©curit√©**
4. Le ransomware est ensuite ex√©cut√© (chiffrement avec extension `.locked`)

Ce d√©p√¥t se concentre volontairement sur les **√©tapes 2 et 3**, qui constituent la **derni√®re fen√™tre de d√©tection avant l‚Äôimpact ransomware**.

---

## Strat√©gie de d√©tection

La d√©tection est volontairement divis√©e en **deux r√®gles Sigma compl√©mentaires**, conform√©ment aux bonnes pratiques SOC.

### R√®gle 1 - BROAD (Alerte pr√©coce / Hunting)

**Objectif**  
D√©tecter le chargement du pilote vuln√©rable associ√© √† CVE-2025-68947 depuis des **r√©pertoires non standards**, ce qui est anormal en environnement d‚Äôentreprise.

**Ce qui est d√©tect√©**
- Chargement de pilote via Sysmon (Event ID 6)
- `NSecKrnl.sys` charg√© depuis Temp, ProgramData ou Users

**Int√©r√™t SOC**
- D√©tection pr√©coce d‚Äôun abus BYOVD potentiel
- Adapt√©e au threat hunting et au triage N1/N2

---

### R√®gle 2 - STRICT (Haute confiance)

**Objectif**  
D√©tecter un **abus BYOVD confirm√©** en corr√©lant le chargement du pilote vuln√©rable avec la **neutralisation de processus de s√©curit√©**.

**Ce qui est d√©tect√©**
- Chargement du pilote vuln√©rable
- Arr√™t ou terminaison de solutions EDR / AV

**Int√©r√™t SOC**
- Indicateur fort d‚Äô√©vasion d√©fensive active
- G√©n√©ralement observ√© **juste avant le chiffrement**
- √Ä traiter comme un **incident critique**

---

## Pourquoi deux r√®gles distinctes ?

Sigma est un format de d√©tection **d√©claratif et portable**.  
S√©parer la logique permet :

- Une meilleure compatibilit√© SIEM
- Un tuning plus simple
- Une int√©gration naturelle dans les workflows SOC

Les corr√©lations avanc√©es (temps, cha√Ænes d‚Äôattaque, impact ransomware) doivent √™tre g√©r√©es via :
- le moteur de corr√©lation du SIEM
- des playbooks SOC
- les proc√©dures de r√©ponse √† incident

---

## Mapping MITRE ATT&CK

- **T1068** - Exploitation for Privilege Escalation
- **T1562.001** - Impair Defenses: Disable or Modify Tools

---

## Public cible

- Analystes SOC
- Detection Engineers
- Threat Hunters
- √âquipes Blue Team

---

## Avertissement

Ces r√®gles visent √† d√©tecter **la phase d‚Äô√©vasion d√©fensive pr√©c√©dant le chiffrement**.  
Elles ne cherchent pas √† d√©tecter l‚Äôimpact final, afin de favoriser une **r√©ponse pr√©ventive et rapide**.

---

## Auteur

‚úçüèø  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)


