title: CVE-2025-68947 - BYOVD Kernel Driver Service Installation (NSecKrnl) - Strict
id: 1c2d7b2e-9f1a-4a2e-8d9b-3f1d2c4a6b8e
status: experimental
description: |
  High-confidence detection of BYOVD (Bring Your Own Vulnerable Driver) preparation related to CVE-2025-68947 by identifying creation/configuration of a kernel driver service associated with the NSecSoft vulnerable driver (NSecKrnl.sys), often loaded via the  Service Control Manager. This rule focuses on strong behavioral signals (driver-service install) rather than IoCs.
  
  Détection à haut niveau de confiance de la préparation d'une attaque BYOVD liée à la CVE-2025-68947, en identifiant la création ou la configuration d'un service de pilote noyau associé au pilote vulnérable de NSecSoft (NSecKrnl.sys), souvent chargé via le Gestionnaire de contrôle des services (SCM). Cette règle se concentre sur des signaux comportementaux forts (installation d'un service de pilote) plutôt que sur de simples indicateurs de compromission (IoCs).
references:
  - https://www.security.com/threat-intelligence/black-basta-ransomware-byovd
  - https://github.com/ANYLNK/NSecSoftBYOVD
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68947
author: Adama ASSIONGBON - SOC & CTI Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-02-06
modified: 2026-02-07
logsource:
  category: process_creation
detection:
  selection_sc_create:
    Image|endswith: '\sc.exe'
    CommandLine|contains|all:
      - 'create'
      - 'type='
    CommandLine|contains:
      - 'kernel'
      - ' driver'
      - 'NSecKrnl'

  selection_sc_binpath_driver:
    CommandLine|contains:
      - 'binPath='
      - 'NSecKrnl.sys'
      - '402.sys'

  selection_powershell_service:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
    CommandLine|contains:
      - 'New-Service'
      - 'Set-Service'
      - 'sc.exe'
    CommandLine|contains:
      - 'NSecKrnl'
      - 'NSecKrnl.sys'
      - '402.sys'
      - 'type= kernel'
      - 'kernel'

  filter_legit_admin_tooling:
    ParentImage|endswith:
      - '\sccmexec.exe'
      - '\ccmexec.exe'
      - '\pdqdeploy.exe'
      - '\intuneManagementExtension.exe'
      - '\chocolatey.exe'

  condition: ((selection_sc_create and selection_sc_binpath_driver) or selection_powershell_service) and not filter_legit_admin_tooling
falsepositives:
  - Legitimate driver/service deployment by enterprise software management tools (SCCM/Intune/PDQ) in rare cases
  - Driver testing by administrators in controlled environments
level: high
tags:
  - attack.persistence
  - attack.defense-evasion
  - attack.privilege-escalation
  - attack.t1543.003
  - attack.t1068
  - attack.t1562.001
  - cve.2025-68947
