# CVE-2025-68947 - BYOVD Detection for Black Basta ( Cardinal) ransomware Campaign

 [ğŸ‘‰ğŸ¾**French version available here**](README_FR.md)
 
This detection pack focuses on identifying **Bring Your Own Vulnerable Driver (BYOVD)** abuse related to **CVE-2025-68947**, as observed in recent **Black Basta (Cardinal)** ransomware campaigns.

The attack abuses the legitimate but vulnerable kernel driver **NSecKrnl.sys (NsecSoft)** to gain kernel privileges and disable security products before ransomware deployment.

---

## ğŸ¯ Detection Strategy

This pack intentionally uses **generic, behavior-based Sigma rules**:

- No dependency on Sysmon
- No static IoCs required
- No multi-event correlation inside Sigma

Correlation is expected to be performed at the **SIEM / SOAR / playbook level**.

---

## ğŸ§© Included Sigma Rules

### ğŸ”¹ BROAD - Suspicious BYOVD Driver Load (Early Warning)

**Purpose**
- Detects suspicious loading of the vulnerable driver:
  - `NSecKrnl.sys`
  - or renamed variants such as `402.sys`
- From user-writable or non-standard directories

**Why it matters**
- Driver loading from non-system paths is rare and abnormal
- Provides **early visibility** into potential BYOVD staging

**Logsource**
- `category: driver_load` (generic)
[CVE-2025-68947_byovd_driver_load_broad.yml](./rules/CVE-2025-68947_byovd_driver_load_broad.yml)
---

### ğŸ”¹ STRICT - Kernel Driver Service Installation (High Confidence)

**Purpose**
- Detects creation or configuration of a **kernel driver service**
- Associated with `NSecKrnl.sys` via:
  - `sc.exe`
  - PowerShell service creation

**Why it matters**
- Installing a kernel driver service is a **strong BYOVD signal**
- False positives are very limited

**Logsource**
- `category: process_creation` (generic)

[CVE-2025-68947_byovd_driver_service_install_strict.yml](./rules/CVE-2025-68947_byovd_driver_service_install_strict.yml)
---

## ğŸ”— Related Generic Detection (Out of Scope)

This pack is designed to be correlated with a **generic defense evasion rule** detecting
termination of EDR / anti-malware processes.

That rule is intentionally **not included here**, as it is:
- reusable across multiple ransomware families
- not specific to CVE-2025-68947

---

## ğŸ§  SOC Correlation Recommendation

High-confidence **pre-ransomware detection** is achieved by correlating:

1. BROAD - Suspicious driver load  
2. STRICT - Kernel driver service installation  
3. Generic rule - Security / EDR process termination  

Within a short time window on the same host.

---

## ğŸ“š References

- https://www.security.com/threat-intelligence/black-basta-ransomware-byovd
- https://github.com/ANYLNK/NSecSoftBYOVD
- https://nvd.nist.gov/vuln/detail/CVE-2025-68947

---

## âš ï¸ Disclaimer

These rules are **behavior-based** and do not rely on static IoCs.
They are intended for **defensive detection and threat hunting only**.

## Author

âœğŸ¿  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

