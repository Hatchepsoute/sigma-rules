# CVE-2025-68947 - BYOVD Detection for Black Basta ransomware Campaign

 [üëâüèæ**French version favailable here**](README_FR.md)
 
## Overview

This repository provides **two Sigma detection rules** designed to identify the **defense evasion stage** of a ransomware campaign leveraging the **Bring Your Own Vulnerable Driver (BYOVD)** technique, as documented in the following threat intelligence report:

- https://www.security.com/threat-intelligence/black-basta-ransomware-byovd

The campaign is attributed to the **Black Basta ransomware group** and abuses a legitimate but vulnerable kernel driver (**NSecKrnl.sys ‚Äì CVE-2025-68947**) to **disable endpoint security solutions prior to encryption**.

The rules are intentionally **technical and behavior-based**, without hard attribution logic, to ensure durability and reuse by the SOC community.

---

## Threat Scenario Summary

According to the referenced analysis, Black Basta operators:

1. Deploy a legitimate but vulnerable kernel driver (`NSecKrnl.sys`)
2. Exploit **CVE-2025-68947** to gain kernel-level privileges (BYOVD)
3. Use the driver to **terminate or disable EDR/AV processes**
4. Proceed with ransomware deployment and file encryption (`.locked` extension)

This repository focuses on **steps 2 and 3**, which represent the **last defensive window** before ransomware impact.

---

## Detection Strategy

The detection logic is split into **two complementary Sigma rules**, following SOC best practices.

### Rule 1 - BROAD (Early Warning / Hunting)

[CVE-2025-68947_byovd_driver_load_broad.yml](./rules/CVE-2025-68947_byovd_driver_load_broad.yml)

**Purpose**  
Detects the loading of the vulnerable kernel driver associated with CVE-2025-68947 from **non-standard directories**, which is uncommon in legitimate enterprise environments.

**What it detects**
- Kernel driver load via Sysmon (Event ID 6)
- `NSecKrnl.sys` loaded from user-writable or temporary paths

**Why it matters**
- Provides **early visibility** into potential BYOVD abuse
- Suitable for threat hunting and N1/N2 SOC triage

---

### Rule 2 - STRICT (High Confidence Detection)

[CVE-2025-68947_byovd_kill_edr_strict.yml](./rules/CVE-2025-68947_byovd_kill_edr_strict.yml)

**Purpose**  
Detects **confirmed BYOVD abuse** by correlating the vulnerable driver load with the **termination of endpoint security processes**.

**What it detects**
- Vulnerable driver loaded
- Immediate termination of security tools (Defender, CrowdStrike, etc.)

**Why it matters**
- Strong indicator of **active defense evasion**
- Commonly observed **immediately before ransomware execution**
- Should be treated as a **critical incident**

---

## Why Two Separate Rules?

Sigma is a **declarative and portable detection format**.  
Splitting detection logic into two rules ensures:

- Better portability across SIEMs
- Easier tuning and maintenance
- Alignment with real SOC workflows (early warning ‚Üí confirmation)

Advanced correlation (timing, chaining, ransomware impact) should be handled by:
- The SIEM correlation engine
- SOC playbooks
- Incident response procedures

---

## MITRE ATT&CK Mapping

- **T1068** - Exploitation for Privilege Escalation
- **T1562.001** - Impair Defenses: Disable or Modify Tools

---

## Intended Audience

- SOC Analysts
- Detection Engineers
- Threat Hunters
- Blue Teams seeking early ransomware detection

---

## Disclaimer

These rules are designed to detect **defense evasion behavior prior to ransomware encryption**.  
They do **not** attempt to detect the encryption phase itself, as prevention and early response are the primary objectives.

---

## Author

‚úçüèø  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

