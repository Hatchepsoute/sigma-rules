## ðŸ›¡ï¸ CVE-2025-68947 - BYOVD Detection (BROAD vs STRICT)

[ðŸ‘‰ðŸ¾ **French version available here**](README_FR.md)

**Scenario:** Black Basta ransomware abusing BYOVD via a vulnerable kernel driver (NSecKrnl.sys)  
**Goal:** Detect defense evasion activity *before* ransomware encryption

```mermaid
flowchart TD
  %% GitHub-compatible Mermaid (no HTML tags in labels)

  classDef broad fill:#FFF3BF,stroke:#F08C00,stroke-width:2px,color:#5C3A00;
  classDef strict fill:#FFE3E3,stroke:#C92A2A,stroke-width:2px,color:#5A1A1A;
  classDef decision fill:#E7F5FF,stroke:#1C7ED6,stroke-width:2px,color:#0B3B66;
  classDef action fill:#E6FCF5,stroke:#12B886,stroke-width:2px,color:#064D3B;
  classDef note fill:#F1F3F5,stroke:#868E96,stroke-dasharray: 5 3,color:#343A40;

  T0["CVE-2025-68947 â€” BYOVD Detection Overview\n(BROAD vs STRICT)"]:::note

  subgraph S0["Threat Scenario (Black Basta / Cardinal)"]
    direction TB
    S0A["Stage vulnerable driver\n(NSecKrnl.sys / renamed e.g. 402.sys)"]:::note
    S0B["Load driver (BYOVD) -> kernel privileges"]:::note
    S0C["Neutralize defenses (EDR/AV)\n(optional but common)"]:::note
    S0D["Ransomware execution & encryption\n(.locked)"]:::note
    S0A --> S0B --> S0C --> S0D
  end

  T0 --> S0A

  subgraph S1["BROAD â€” Early Warning / Hunting (Generic)"]
    direction TB
    B1["Driver Load telemetry\n(category: driver_load)"]:::broad
    B2["Driver name match\nNSecKrnl.sys OR 402.sys"]:::broad
    B3["Non-standard path heuristic\nTemp / ProgramData / Users / AppData / Public"]:::broad
    B4["BROAD Alert\nSuspicious vulnerable driver load"]:::broad
    B1 --> B2 --> B3 --> B4
  end

  subgraph S2["STRICT â€” High Confidence (Generic)"]
    direction TB
    S2A["Process creation telemetry\n(category: process_creation)"]:::strict
    S2B["Install/configure kernel driver service\n(sc.exe / PowerShell)\nService: NSecKrnl\nBinPath: NSecKrnl.sys / 402.sys"]:::strict
    S2C["STRICT Alert\nBYOVD driver service installation"]:::strict
    S2A --> S2B --> S2C
  end

  subgraph S3["Related Rule (Separate) â€” Defense Evasion"]
    direction TB
    D1["Kill/Stop security tools\n(EDR/AV process termination or service stop)\nRule is generic and reusable"]:::decision
  end

  subgraph S4["SOC Response (Recommended)"]
    direction TB
    A1["Isolate host / contain"]:::action
    A2["Collect artifacts\n(driver path, service name, parent process, user)"]:::action
    A3["Hunt lateral movement & persistence"]:::action
    A4["Trigger IR playbook (pre-ransomware)"]:::action
    A1 --> A2 --> A3 --> A4
  end

  S0B --> B1
  B4 --> S2A
  S2C --> D1
  D1 --> A1
```
