## ðŸ›¡ï¸ CVE-2025-68947 - DÃ©tection BYOVD (BROAD vs STRICT)

[ðŸ‘‰ðŸ¾ **English version available here**](README.md)

**ScÃ©nario :** Campagne ransomware Black Basta exploitant BYOVD via le pilote vulnÃ©rable NSecKrnl.sys  
**Objectif :** DÃ©tecter lâ€™Ã©vasion dÃ©fensive *avant* le chiffrement ransomware

```mermaid
flowchart TD
  %% Mermaid compatible GitHub (pas de tags HTML dans les labels)

  classDef broad fill:#FFF3BF,stroke:#F08C00,stroke-width:2px,color:#5C3A00;
  classDef strict fill:#FFE3E3,stroke:#C92A2A,stroke-width:2px,color:#5A1A1A;
  classDef decision fill:#E7F5FF,stroke:#1C7ED6,stroke-width:2px,color:#0B3B66;
  classDef action fill:#E6FCF5,stroke:#12B886,stroke-width:2px,color:#064D3B;
  classDef note fill:#F1F3F5,stroke:#868E96,stroke-dasharray: 5 3,color:#343A40;

  T0["CVE-2025-68947 â€” Vue dâ€™ensemble dÃ©tection BYOVD\n(BROAD vs STRICT)"]:::note

  subgraph S0["ScÃ©nario de menace (Black Basta / Cardinal)"]
    direction TB
    S0A["DÃ©pÃ´t du pilote vulnÃ©rable\n(NSecKrnl.sys / renommÃ© ex: 402.sys)"]:::note
    S0B["Chargement du pilote (BYOVD) -> privilÃ¨ges kernel"]:::note
    S0C["Neutralisation des dÃ©fenses (EDR/AV)\n(optionnel mais frÃ©quent)"]:::note
    S0D["ExÃ©cution ransomware & chiffrement\n(.locked)"]:::note
    S0A --> S0B --> S0C --> S0D
  end

  T0 --> S0A

  subgraph S1["BROAD â€” Alerte prÃ©coce / Hunting (GÃ©nÃ©rique)"]
    direction TB
    B1["TÃ©lÃ©mÃ©trie chargement pilote\n(category: driver_load)"]:::broad
    B2["Match nom pilote\nNSecKrnl.sys OU 402.sys"]:::broad
    B3["Heuristique chemin non standard\nTemp / ProgramData / Users / AppData / Public"]:::broad
    B4["Alerte BROAD\nChargement suspect du pilote vulnÃ©rable"]:::broad
    B1 --> B2 --> B3 --> B4
  end

  subgraph S2["STRICT â€” Haute confiance (GÃ©nÃ©rique)"]
    direction TB
    S2A["TÃ©lÃ©mÃ©trie crÃ©ation de processus\n(category: process_creation)"]:::strict
    S2B["Installation/configuration service driver kernel\n(sc.exe / PowerShell)\nService: NSecKrnl\nBinPath: NSecKrnl.sys / 402.sys"]:::strict
    S2C["Alerte STRICT\nInstallation du service pilote BYOVD"]:::strict
    S2A --> S2B --> S2C
  end

  subgraph S3["RÃ¨gle associÃ©e (sÃ©parÃ©e) â€” Ã‰vasion dÃ©fensive"]
    direction TB
    D1["Kill/Stop outils de sÃ©curitÃ©\n(terminaison process EDR/AV ou arrÃªt service)\nRÃ¨gle gÃ©nÃ©rique rÃ©utilisable"]:::decision
  end

  subgraph S4["RÃ©ponse SOC (recommandÃ©e)"]
    direction TB
    A1["Isoler lâ€™hÃ´te / contenir"]:::action
    A2["Collecter les artefacts\n(chemin driver, nom service, parent, utilisateur)"]:::action
    A3["Hunt mouvement latÃ©ral & persistance"]:::action
    A4["DÃ©clencher playbook IR (prÃ©-ransomware)"]:::action
    A1 --> A2 --> A3 --> A4
  end

  S0B --> B1
  B4 --> S2A
  S2C --> D1
  D1 --> A1

```
