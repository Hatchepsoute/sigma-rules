# Playbook SOC - CVE-2025-68947 (BYOVD) √âvasion D√©fensive

[üëâüèæ **English version available here**](./README.md)

## Objectif
Ce playbook guide les analystes SOC dans **l‚Äôinvestigation, la validation et la r√©ponse** lorsque les r√®gles Sigma li√©es √† l‚Äôabus BYOVD de **CVE-2025-68947** sont d√©clench√©es.
L‚Äôaccent est mis sur **l‚Äô√©vasion d√©fensive pr√©c√©dant un ransomware**.

---

## P√©rim√®tre
- Postes et serveurs Windows
- D√©tections bas√©es sur Sysmon
- Activit√© pr√©-ransomware (sc√©nario Black Basta)

---

## Sources de d√©tection
- **R√®gle BROAD**  
  CVE-2025-68947 - Chargement suspect de pilote BYOVD (NSecKrnl.sys)

- **R√®gle STRICT**  
  CVE-2025-68947 - Abus BYOVD suivi de la neutralisation des outils de s√©curit√©

---

## Phase 1 - Triage de l‚Äôalerte

### Cas A - R√®gle BROAD seule
**Confiance :** Moyenne  
**Objectif :** Distinguer un usage l√©gitime d‚Äôun abus BYOVD pr√©coce

**Actions analyste**
1. Identifier le chemin et le nom du pilote  
   - Confirmer `NSecKrnl.sys`
   - V√©rifier le r√©pertoire (Temp / ProgramData / Users)
2. R√©cup√©rer le hash du pilote (SHA256 si disponible)
3. Identifier le processus ayant charg√© le pilote
4. Identifier l‚Äôutilisateur et le r√¥le de la machine
5. V√©rifier la signature du pilote

**D√©cision**
- Logiciel l√©gitime ‚Üí cl√¥ture ou whitelist
- Activit√© suspecte ‚Üí escalade Phase 2

---

### Cas B - R√®gle STRICT d√©clench√©e
**Confiance :** √âlev√©e / Critique  
**Objectif :** Confirmer une √©vasion d√©fensive active

**Actions imm√©diates**
- Traiter comme un **incident de s√©curit√©**
- Alerter le responsable SOC / IR
- Passer au confinement

---

## Phase 2 - Confinement

**Actions**
1. Isoler imm√©diatement l‚Äôh√¥te du r√©seau
2. Emp√™cher tout chargement de pilote suppl√©mentaire
3. Pr√©server les donn√©es volatiles si possible
   - Processus en cours
   - Pilotes charg√©s
   - Connexions r√©seau

---

## Phase 3 - Investigation

**Questions cl√©s**
- Quand le pilote a-t-il √©t√© d√©pos√© ?
- Quel processus a charg√© le pilote ?
- Quels outils de s√©curit√© ont √©t√© cibl√©s ?
- Y a-t-il un mouvement lat√©ral ?
- Existe-t-il une persistance (services, t√¢ches, pilotes) ?

**Artefacts √† collecter**
- Logs Sysmon (EID 1, 6, 10)
- Fichier du pilote et m√©tadonn√©es
- Binaires parents
- Logs des solutions de s√©curit√©

---

## Phase 4 - √âradication & R√©tablissement

**Actions**
1. Supprimer le pilote malveillant et les binaires associ√©s
2. Restaurer / r√©parer les outils de s√©curit√©
3. R√©initialiser les identifiants utilis√©s sur l‚Äôh√¥te
4. Appliquer les correctifs ou blocages n√©cessaires
5. Surveiller l‚Äôenvironnement

---

## Phase 5 - Retour d‚Äôexp√©rience

- Ajuster les r√®gles Sigma si n√©cessaire
- Ajouter des exclusions l√©gitimes (hash / chemin)
- Mettre √† jour les proc√©dures SOC
- Partager les enseignements avec la communaut√©

---

## Notes analyste
- La d√©tection intervient **avant le chiffrement**
- C‚Äôest la **derni√®re fen√™tre d‚Äôintervention**
- La rapidit√© de r√©ponse est essentielle

---

## Mapping MITRE ATT&CK
- T1068 - Exploitation pour √©l√©vation de privil√®ges
- T1562.001 - Alt√©ration des d√©fenses

