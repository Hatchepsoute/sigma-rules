# Playbook SOC - CVE-2025-68947 (BYOVD) √âvasion D√©fensive

[üëâüèæ **English version available here**](README.md)

## Objectif
Ce playbook guide les analystes SOC dans **le triage, l‚Äôinvestigation et la r√©ponse** lorsque des **r√®gles Sigma comportementales** li√©es √† l‚Äôabus BYOVD de **CVE-2025-68947** sont d√©clench√©es.

L‚Äôobjectif est de d√©tecter une **activit√© pr√©-ransomware**, avant le chiffrement, comme observ√© dans les campagnes Black Basta (Cardinal).

---

## P√©rim√®tre
- Postes et serveurs Windows
- D√©tections Sigma g√©n√©riques (ind√©pendantes des outils)
- Phase pr√©-ransomware

---

## Sources de d√©tection

- **R√®gle BROAD**  
  *Chargement suspect de pilote BYOVD*  
  D√©tection de `NSecKrnl.sys` (ou variante renomm√©e) depuis des chemins non standards  
  Logsource : `driver_load`

- **R√®gle STRICT**  
  *Installation d‚Äôun service de pilote kernel*  
  Cr√©ation ou configuration d‚Äôun service driver via `sc.exe` ou PowerShell  
  Logsource : `process_creation`

- **R√®gle associ√©e (s√©par√©e)**  
  *Kill EDR / Anti-Malware*  
  Neutralisation des processus ou services de s√©curit√©

---

## Phase 1 - Triage de l‚Äôalerte

### Cas A - R√®gle BROAD seule
**Confiance :** Moyenne  
**Objectif :** Distinguer une activit√© l√©gitime d‚Äôune pr√©paration BYOVD

**Actions analyste**
1. Identifier le nom et le chemin du pilote  
   - `NSecKrnl.sys` ou variante renomm√©e
   - V√©rifier les r√©pertoires non standards
2. Identifier le processus ayant charg√© le pilote
3. Identifier l‚Äôutilisateur et le r√¥le de la machine
4. V√©rifier la signature et l‚Äô√©diteur du pilote
5. Valider si le pilote est autoris√© en interne

**D√©cision**
- Activit√© l√©gitime ‚Üí cl√¥ture / exclusion
- Activit√© suspecte ‚Üí escalade

---

### Cas B - R√®gle STRICT d√©clench√©e
**Confiance :** √âlev√©e  
**Objectif :** Confirmer une pr√©paration d‚Äôabus BYOVD

**Actions imm√©diates**
- Traiter comme un **incident de s√©curit√©**
- Alerter le SOC / IR
- Passer imm√©diatement au confinement

---

## Phase 2 - Confinement

**Actions**
1. Isoler l‚Äôh√¥te du r√©seau
2. Bloquer toute installation suppl√©mentaire de services/pilotes
3. Pr√©server les preuves volatiles :
   - Pilotes charg√©s
   - Processus actifs
   - Services configur√©s

---

## Phase 3 - Investigation

**Questions cl√©s**
- Quand le pilote a-t-il √©t√© d√©pos√© sur le disque ?
- Quel processus a cr√©√© ou modifi√© le service driver ?
- Le pilote a-t-il √©t√© renomm√© ?
- Y a-t-il une √©l√©vation de privil√®ges ?
- Existe-t-il un mouvement lat√©ral ou une persistance ?

**Artefacts √† collecter**
- Fichier du pilote et m√©tadonn√©es
- Configuration du service driver
- Lignes de commande et processus parents
- Logs des solutions de s√©curit√©

---

## Phase 4 - √âradication & R√©tablissement

**Actions**
1. Supprimer le pilote et le service kernel malveillant
2. Restaurer les outils de s√©curit√©
3. R√©initialiser les comptes utilis√©s
4. Bloquer ou patcher les vecteurs BYOVD
5. Surveiller l‚Äôenvironnement

---

## Phase 5 - Retour d‚Äôexp√©rience

- Ajuster les r√®gles BROAD / STRICT
- Ajouter des exclusions l√©gitimes si n√©cessaire
- Mettre √† jour les proc√©dures SOC
- Partager les enseignements avec la communaut√©

---

## Notes analyste
- La d√©tection intervient **avant le chiffrement**
- C‚Äôest la **derni√®re fen√™tre de pr√©vention**
- La rapidit√© de r√©ponse est d√©terminante

---

## Mapping MITRE ATT&CK
- T1068 - Exploitation pour √©l√©vation de privil√®ges
- T1543.003 - Cr√©ation / modification d‚Äôun service Windows
- T1562.001 - Alt√©ration des d√©fenses

