# SOC Playbook - CVE-2025-68947 (BYOVD) Defense Evasion Detection

[üëâüèæ **French version available here**](README_FR.md)

## Purpose
This playbook guides SOC analysts through **triage, investigation, and response** when **behavior-based Sigma rules** related to **BYOVD abuse of CVE-2025-68947** are triggered.

The focus is on **defense evasion and pre-ransomware activity**, as observed in Black Basta (Cardinal) campaigns.

---

## Scope
- Windows endpoints (workstations & servers)
- Generic Sigma detections (tool-agnostic)
- Pre-ransomware phase (before encryption)

---

## Detection Inputs

- **BROAD Rule**  
  *Suspicious BYOVD Driver Load*  
  Detection of `NSecKrnl.sys` (or renamed variants) loaded from non-standard paths  
  Logsource: `driver_load`

- **STRICT Rule**  
  *Kernel Driver Service Installation*  
  Detection of kernel driver service creation/configuration  
  (sc.exe / PowerShell ‚Äì NSecKrnl)  
  Logsource: `process_creation`

- **Related Generic Rule (separate)**  
  *Kill EDR / Anti-Malware*  
  Detection of security process termination or service stop

---

## Phase 1 - Alert Triage

### Case A - BROAD Triggered Only
**Confidence:** Medium  
**Objective:** Identify legitimate driver activity vs. early BYOVD staging

**Analyst Actions**
1. Identify driver filename and full path  
   - `NSecKrnl.sys` or renamed variant (e.g. `402.sys`)
   - Check for non-standard directories (Temp, ProgramData, Users, AppData)
2. Identify process responsible for loading the driver
3. Identify user context and host role
4. Verify driver signature and publisher
5. Check if the driver is known/approved internally

**Decision**
- Legitimate activity ‚Üí close or whitelist
- Unknown or suspicious ‚Üí escalate

---

### Case B - STRICT Triggered
**Confidence:** High  
**Objective:** Confirm BYOVD abuse preparation

**Immediate Actions**
- Treat as **security incident**
- Notify SOC lead / IR team
- Proceed immediately to containment

---

## Phase 2 - Containment

**Actions**
1. Isolate the affected host from the network
2. Prevent additional driver or service installation if possible
3. Preserve volatile evidence if feasible:
   - Loaded drivers
   - Running processes
   - Active services

---

## Phase 3 - Investigation

**Key Questions**
- When was the driver written to disk?
- Which process created or configured the driver service?
- Was a renamed driver used?
- Is there evidence of privilege escalation?
- Are there signs of lateral movement or persistence?

**Artifacts to Collect**
- Driver file and metadata
- Service configuration (name, binPath)
- Parent process command lines
- Security product telemetry

---

## Phase 4 - Eradication & Recovery

**Actions**
1. Remove malicious driver and kernel service
2. Restore or repair security tools
3. Rotate credentials used on the host
4. Patch vulnerable drivers or block loading
5. Monitor environment for recurrence

---

## Phase 5 - Lessons Learned

- Tune BROAD/STRICT rules if needed
- Add legitimate exclusions where justified
- Update SOC detection models and playbooks
- Share detection insights with the community

---

## Analyst Notes
- Detection occurs **before ransomware encryption**
- This phase represents the **last realistic prevention window**
- Fast response is critical

---

## MITRE ATT&CK
- T1068 - Exploitation for Privilege Escalation
- T1543.003 - Create or Modify System Process: Windows Service
- T1562.001 - Impair Defenses

