# SOC Playbook - CVE-2025-68947 (BYOVD) Defense Evasion Detection

 [üëâüèæ  **French version favailable here**](README_FR.md)
 
## Purpose
This playbook guides SOC analysts through **investigation, validation, and response** when Sigma rules related to **BYOVD abuse of CVE-2025-68947** are triggered.
The focus is on **defense evasion prior to ransomware execution**.

---

## Scope
- Windows endpoints (Workstations & Servers)
- Sysmon-based detections
- Pre-ransomware activity (Black Basta scenario)

---

## Detection Inputs
- **BROAD Rule**  
  CVE-2025-68947 - BYOVD Suspicious Driver Load (NSecKrnl.sys)

- **STRICT Rule**  
  CVE-2025-68947 - BYOVD Abuse Followed by Security Tool Termination

---

## Phase 1 - Alert Triage

### Case A - BROAD Triggered Only
**Confidence:** Medium  
**Objective:** Determine legitimacy vs. early-stage BYOVD abuse

**Analyst Actions**
1. Identify driver path and filename  
   - Confirm `NSecKrnl.sys`
   - Check directory (Temp / ProgramData / Users)
2. Collect driver hash (SHA256 if available)
3. Identify process that loaded the driver
4. Identify user context and host role
5. Check if the driver is signed and by whom

**Decision**
- Legitimate software ‚Üí close or whitelist
- Unknown / suspicious ‚Üí escalate to Phase 2

---

### Case B - STRICT Triggered
**Confidence:** High / Critical  
**Objective:** Confirm active defense evasion

**Immediate Actions**
- Treat as **security incident**
- Notify SOC Lead / IR team
- Proceed to containment

---

## Phase 2 - Containment

**Actions**
1. Isolate the affected host from the network
2. Block further driver loading if possible
3. Preserve volatile data if feasible
   - Process list
   - Loaded drivers
   - Network connections

---

## Phase 3 - Investigation

**Key Questions**
- When was the driver first written to disk?
- Which process dropped or loaded the driver?
- Which security tools were targeted or terminated?
- Are there signs of lateral movement?
- Is there persistence (services, scheduled tasks, drivers)?

**Artifacts to Collect**
- Sysmon logs (EID 1, 6, 10)
- Driver file and metadata
- Parent process binaries
- Security product logs

---

## Phase 4 - Eradication & Recovery

**Actions**
1. Remove malicious driver and associated binaries
2. Restore / repair security tools
3. Rotate credentials used on the affected host
4. Patch or block exploitation paths
5. Monitor environment for recurrence

---

## Phase 5 - Lessons Learned

- Tune Sigma rules if needed
- Add driver hash or path exclusions (if legitimate)
- Update SOC runbooks and threat models
- Share detection insights with the community

---

## Analyst Notes
- Detection occurs **before ransomware encryption**
- This stage represents the **last defensive window**
- Speed of response is critical

---

## MITRE ATT&CK
- T1068 - Exploitation for Privilege Escalation
- T1562.001 - Impair Defenses: Disable or Modify Tools

