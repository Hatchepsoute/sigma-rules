name: CVE-2025-68947 - BYOVD Defense Evasion (Pre-Ransomware)
description: >
  Incident response playbook for detecting and responding to BYOVD abuse exploiting CVE-2025-68947 (NSecKrnl.sys). Focuses on defense evasion activity prior to ransomware execution.
severity: 3
tlp: AMBER
pap: AMBER
status: ENABLED
tags:
  - cve-2025-68947
  - byovd
  - defense-evasion
  - pre-ransomware
  - windows
  - sysmon

tasks:

  - title: "Initial Triage — Validate Alert Context"
    description: >
      Confirm the alert source (Sigma BROAD or STRICT) and collect initial context.
    order: 1
    status: WAITING
    flag: false
    assignee: soc_l1
    actions:
      - description: "Identify triggering Sigma rule (BROAD or STRICT)"
      - description: "Identify affected host and user"
      - description: "Check alert timestamp and correlation window"

  - title: "Check Driver Load — NSecKrnl.sys"
    description: >
      Validate the presence and legitimacy of the vulnerable driver involved in BYOVD abuse.
    order: 2
    status: WAITING
    flag: false
    assignee: soc_l1
    actions:
      - description: "Confirm driver name: NSecKrnl.sys"
      - description: "Identify driver load path (Temp / ProgramData / Users)"
      - description: "Collect driver hash (SHA256 if available)"
      - description: "Verify digital signature and signer"

  - title: "Assess Detection Confidence"
    description: >
      Determine whether the activity represents early staging or confirmed defense evasion.
    order: 3
    status: WAITING
    flag: false
    assignee: soc_l2
    actions:
      - description: "BROAD only: assess likelihood of legitimate driver usage"
      - description: "STRICT triggered: assume active defense evasion"
      - description: "Decide escalation to incident response"

  - title: "Containment — Isolate Host (STRICT)"
    description: >
      Immediate containment actions when defense evasion is confirmed.
    order: 4
    status: WAITING
    flag: true
    assignee: soc_l2
    actions:
      - description: "Isolate host from the network"
      - description: "Block further driver loading if possible"
      - description: "Preserve volatile data (processes, drivers, connections)"

  - title: "Investigate Defense Evasion Activity"
    description: >
      Identify how the vulnerable driver was introduced and which security tools were targeted.
    order: 5
    status: WAITING
    flag: false
    assignee: soc_l2
    actions:
      - description: "Identify process that loaded the driver"
      - description: "Identify parent process and execution chain"
      - description: "List terminated or stopped security tools"
      - description: "Review Sysmon logs (EID 1, 6, 10)"

  - title: "Hunt for Lateral Movement and Persistence"
    description: >
      Ensure the activity did not progress beyond defense evasion.
    order: 6
    status: WAITING
    flag: false
    assignee: soc_l3
    actions:
      - description: "Search for lateral movement indicators"
      - description: "Check for persistence mechanisms (services, scheduled tasks, drivers)"
      - description: "Review authentication and network activity"

  - title: "Eradication and Recovery"
    description: >
      Remove malicious artifacts and restore normal security posture.
    order: 7
    status: WAITING
    flag: false
    assignee: soc_l3
    actions:
      - description: "Remove malicious driver and associated binaries"
      - description: "Restore or repair security tools"
      - description: "Rotate credentials used on the affected host"
      - description: "Apply hardening and preventive controls"

  - title: "Post-Incident Review"
    description: >
      Capture lessons learned and improve detection and response capabilities.
    order: 8
    status: WAITING
    flag: false
    assignee: soc_manager
    actions:
      - description: "Document root cause and attack timeline"
      - description: "Tune Sigma rules if required"
      - description: "Update SOC documentation and threat models"
      - description: "Share findings with the detection engineering community"

