# Decision Table - CVE-2025-68947 (BYOVD) Black Basta Campaign

[üëâüèæ **French version available here**](./README_FR.md)

## Purpose

This decision table explains how to interpret alerts generated by the **BROAD** and **STRICT** Sigma rules related to **BYOVD abuse of CVE-2025-68947**, as observed in the Black Basta ransomware campaign.

It also shows how to correlate these signals with a **separate generic ‚ÄúKill EDR / Anti-Malware‚Äù rule**, commonly observed in pre-ransomware phases.

---

## Detection Logic Overview

| Stage | Detection Signal | Rule | Confidence |
|------|-----------------|------|------------|
| 1 | Vulnerable driver load (NSecKrnl.sys / renamed e.g. 402.sys) from suspicious paths | BROAD | Medium |
| 2 | Kernel driver service installation/configuration (NSecKrnl) via sc.exe / PowerShell | STRICT | High |
| 3 | Security tool termination / service stop (EDR/AV) | GENERIC ‚ÄúKill EDR‚Äù (separate rule) | High |
| 4 | Ransomware execution & encryption (.locked) | Out of scope | Critical |

---

## Decision Matrix

| # | BROAD Triggered | STRICT Triggered | KILL-EDR Triggered | Interpretation | SOC Action |
|---|----------------|------------------|--------------------|----------------|------------|
| 1 | ‚ùå | ‚ùå | ‚ùå | No suspicious activity detected | No action |
| 2 | ‚úÖ | ‚ùå | ‚ùå | Potential BYOVD staging or early exploitation | Investigate driver origin, path, context |
| 3 | ‚ùå | ‚úÖ | ‚ùå | Highly suspicious (possible logging gap for driver load) | Immediate investigation |
| 4 | ‚ùå | ‚ùå | ‚úÖ | Security tooling tampering detected (generic) | Validate legitimacy, increase monitoring |
| 5 | ‚úÖ | ‚úÖ | ‚ùå | BYOVD likely confirmed (driver load + driver service install) | **Contain host, begin IR triage** |
| 6 | ‚úÖ | ‚ùå | ‚úÖ | Potential BYOVD + defense evasion (service install missing/blocked) | **Contain host, validate BYOVD artifacts** |
| 7 | ‚ùå | ‚úÖ | ‚úÖ | Strong pre-ransomware signal (service install + kill EDR) | **Declare incident, isolate host immediately** |
| 8 | ‚úÖ | ‚úÖ | ‚úÖ | Confirmed pre-ransomware activity (BYOVD + defense evasion) | **Declare incident, isolate host immediately** |

---

## SOC Response Guidance

### Case 2 - BROAD only
- Validate legitimacy of the driver and its origin
- Check execution context (user, parent process)
- Increase host monitoring
- Prepare containment actions

### Case 5 - BROAD + STRICT
- Isolate/contain the endpoint
- Treat as **likely BYOVD preparation**
- Collect artifacts (driver path, service name, parent process, user)
- Hunt for lateral movement and persistence

### Case 8 - BROAD + STRICT + KILL-EDR
- Isolate immediately
- Assume **pre-ransomware activity**
- Trigger Incident Response procedures
- Hunt for privilege escalation, lateral movement, and persistence

---

## Analyst Notes

- These rules focus on **defense evasion and BYOVD preparation**, not encryption.
- Detection at this stage provides the **last opportunity to stop ransomware impact**.
- Correlation timing should be handled by the SIEM or SOC playbooks.

---

## MITRE ATT&CK

- T1068 - Exploitation for Privilege Escalation  
- T1543.003 - Create or Modify System Process: Windows Service  
- T1562.001 - Impair Defenses: Disable or Modify Tools
## Author

‚úçüèø  Adama ASSIONGBON - SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

