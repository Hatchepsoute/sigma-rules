![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Microsoft Office](https://img.shields.io/badge/Microsoft-Office-blue)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
![Microsoft Security](https://img.shields.io/badge/Microsoft-Security-blue)

# üõ°Ô∏è CVE-2026-21509 - D√©tection du contournement de s√©curit√© Microsoft Office

üëâüèæ **[Version anglaise disponible ici](README.md)**

---

## Pr√©sentation

Ce d√©p√¥t propose **une r√®gle Sigma unique √† forte confiance** pour la vuln√©rabilit√© **CVE-2026-21509**, affectant Microsoft Office.

Cette faille est class√©e comme un **Security Feature Bypass** et permet de contourner les m√©canismes de protection OLE / COM de Microsoft Office.

La d√©tection repose sur un **invariant de s√©curit√© fort**, explicitement document√© par Microsoft.

---

## üìë Sc√©nario d‚Äôattaque : de l‚Äôexploitation √† la d√©tection

Pour comprendre la logique de la r√®gle, voici le d√©roulement typique d‚Äôune attaque bas√©e sur un PoC public.

### 1. Pr√©paration et livraison

L‚Äôattaquant g√©n√®re un document Microsoft Office malveillant (par exemple `.docx`) √† l‚Äôaide d‚Äôun script Python.

Ce document contient un objet **OLE** r√©f√©renc√© par le CLSID suivant :

```
{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

Ce CLSID est **explicitement mentionn√© dans les avis de s√©curit√© Microsoft** relatifs √† CVE-2026-21509.

Le document est ensuite transmis √† la victime, g√©n√©ralement via une campagne de **phishing**.

---

### 2. Ex√©cution (exploitation)

Lorsque la victime ouvre le document :

- En fonctionnement normal, Microsoft Office devrait bloquer l‚Äôinstanciation ou afficher une alerte de s√©curit√©.
- En exploitant **CVE-2026-21509**, le document force l‚Äôinstanciation du composant COM **sans d√©clencher les protections attendues**.

Il s‚Äôagit donc d‚Äôun **contournement de m√©canisme de s√©curit√©**.

---

### 3. Trace syst√®me observable (point de d√©tection)

Pour instancier un objet COM, **Windows doit interroger le Registre** afin de r√©soudre le CLSID.

Cela g√©n√®re un acc√®s √† la cl√© suivante :

```
HKCR\CLSID\{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

üìå **C‚Äôest pr√©cis√©ment ce comportement que la r√®gle Sigma surveille.**

Sur un syst√®me :
- corrig√©,
- ou correctement mitig√© (kill-bit COM appliqu√©),

üëâüèæ **tout acc√®s √† ce CLSID constitue une anomalie critique**, quel que soit le processus √† l‚Äôorigine de la requ√™te.

---

## üéØ Pourquoi cette approche est robuste

- Le CLSID est **explicitement nomm√© par Microsoft**
- Il est **directement li√© √† la vuln√©rabilit√©**
- Il est **bloqu√© apr√®s correctif**
- Son acc√®s viole un **invariant de s√©curit√©**

‚û°Ô∏è La d√©tection est :
- simple
- portable
- √† forte confiance
- ind√©pendante des noms de processus

---

## R√©sum√© SOC

| √âl√©ment | Valeur |
|---|---|
| Vuln√©rabilit√© | CVE-2026-21509 |
| Type | Security Feature Bypass |
| Signal d√©tect√© | Acc√®s au CLSID vuln√©rable |
| Source de logs | Registre Windows |
| D√©pendance au processus | Non |
| Niveau d‚Äôalerte | √âlev√© |

---
## Logique de d√©tection (Diagramme final)

```mermaid
graph TD
    A["√âv√©nement registre Windows"] --> B{"Acc√®s √† un CLSID COM ?"}
    B -- "{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}" --> C["Violation d'un invariant de s√©curit√©"]
    C --> D[["ALERTE √Ä FORTE CONFIANCE"]]

    subgraph Contexte
        D --> E["CVE-2026-21509"]
        D --> F["Contournement des protections OLE / COM"]
        D --> G["Acc√®s CLSID anormal\n(post-correctif ou post-mitigation)"]
    end
```
---
## R√©f√©rences

- Avis Microsoft : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509
- NVD : https://nvd.nist.gov/vuln/detail/CVE-2026-21509
- PoC public : https://github.com/Ashwesker/Ashwesker-CVE-2026-21509

---

Auteur : **Adama ASSIONGBON** -Consultant SOC & CTI
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
