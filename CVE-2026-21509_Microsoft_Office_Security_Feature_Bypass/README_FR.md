![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Microsoft Office](https://img.shields.io/badge/Microsoft-Office-blue)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
![Microsoft Security](https://img.shields.io/badge/Microsoft-Security-blue)

# ğŸ›¡ï¸ CVE-2026-21509 - DÃ©tection du contournement de sÃ©curitÃ© Microsoft Office

ğŸ‘‰ğŸ¾ **[Version anglaise disponible ici](README.md)**

---

## PrÃ©sentation

Ce dÃ©pÃ´t propose **une rÃ¨gle Sigma unique Ã  forte confiance** pour la vulnÃ©rabilitÃ© **CVE-2026-21509**, affectant Microsoft Office.

Cette faille est classÃ©e comme un **Security Feature Bypass** et permet de contourner les mÃ©canismes de protection OLE / COM de Microsoft Office.

La dÃ©tection repose sur un **invariant de sÃ©curitÃ© fort**, explicitement documentÃ© par Microsoft.

---

## ğŸ“‘ ScÃ©nario dâ€™attaque : de lâ€™exploitation Ã  la dÃ©tection

Pour comprendre la logique de la rÃ¨gle, voici le dÃ©roulement typique dâ€™une attaque basÃ©e sur un PoC public.

### 1. PrÃ©paration et livraison

Lâ€™attaquant gÃ©nÃ¨re un document Microsoft Office malveillant (par exemple `.docx`) Ã  lâ€™aide dâ€™un script Python.

Ce document contient un objet **OLE** rÃ©fÃ©rencÃ© par le CLSID suivant :

```
{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

Ce CLSID est **explicitement mentionnÃ© dans les avis de sÃ©curitÃ© Microsoft** relatifs Ã  CVE-2026-21509.

Le document est ensuite transmis Ã  la victime, gÃ©nÃ©ralement via une campagne de **phishing**.

---

### 2. ExÃ©cution (exploitation)

Lorsque la victime ouvre le document :

- En fonctionnement normal, Microsoft Office devrait bloquer lâ€™instanciation ou afficher une alerte de sÃ©curitÃ©.
- En exploitant **CVE-2026-21509**, le document force lâ€™instanciation du composant COM **sans dÃ©clencher les protections attendues**.

Il sâ€™agit donc dâ€™un **contournement de mÃ©canisme de sÃ©curitÃ©**.

---

### 3. Trace systÃ¨me observable (point de dÃ©tection)

Pour instancier un objet COM, **Windows doit interroger le Registre** afin de rÃ©soudre le CLSID.

Cela gÃ©nÃ¨re un accÃ¨s Ã  la clÃ© suivante :

```
HKCR\CLSID\{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

ğŸ“Œ **Câ€™est prÃ©cisÃ©ment ce comportement que la rÃ¨gle Sigma surveille.**

Sur un systÃ¨me :
- corrigÃ©,
- ou correctement mitigÃ© (kill-bit COM appliquÃ©),

ğŸ‘‰ğŸ¾ **tout accÃ¨s Ã  ce CLSID constitue une anomalie critique**, quel que soit le processus Ã  lâ€™origine de la requÃªte.

---

## ğŸ¯ Pourquoi cette approche est robuste

- Le CLSID est **explicitement nommÃ© par Microsoft**
- Il est **directement liÃ© Ã  la vulnÃ©rabilitÃ©**
- Il est **bloquÃ© aprÃ¨s correctif**
- Son accÃ¨s viole un **invariant de sÃ©curitÃ©**

â¡ï¸ La dÃ©tection est :
- simple
- portable
- Ã  forte confiance
- indÃ©pendante des noms de processus

---

## RÃ©sumÃ© SOC

| Ã‰lÃ©ment | Valeur |
|---|---|
| VulnÃ©rabilitÃ© | CVE-2026-21509 |
| Type | Security Feature Bypass |
| Signal dÃ©tectÃ© | AccÃ¨s au CLSID vulnÃ©rable |
| Source de logs | Registre Windows |
| DÃ©pendance au processus | Non |
| Niveau dâ€™alerte | Ã‰levÃ© |

## ğŸ“„ RÃ¨gle de dÃ©tection
ğŸ‘‰ğŸ¾ **[Microsoft Office COM CLSID Security Feature Bypass â€“ CVE-2026-21509](./rules/office_com_clsid_security_feature_bypass_cve_2026_21509.yml)**
---
## RÃ©fÃ©rences

- Avis Microsoft : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509
- NVD : https://nvd.nist.gov/vuln/detail/CVE-2026-21509
- PoC public : https://github.com/Ashwesker/Ashwesker-CVE-2026-21509

---

* Auteur : **Adama ASSIONGBON** -Consultant SOC & CTI
* **Contact:** [LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
