version: 1.0
playbook:
  name: Playbook_CVE-2026-21509_Generic
  title: "CVE-2026-21509 - Microsoft Office OLE/COM Security Feature Bypass (CLSID Detection)"
  description: >
    Generic SOC incident response playbook triggered when a monitored Windows endpoint accesses the COM CLSID {EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B} in the registry, a strong indicator of attempted exploitation of CVE-2026-21509 (Microsoft Office security feature bypass affecting OLE mitigations).
  created: "2026-02-02"
  owner: "Adama ASSIONGBON"
  scope:
    platforms:
      - windows
    products:
      - "Microsoft Office (2016/2019/LTSC/365)"
  references:
    - "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509"
    - "https://nvd.nist.gov/vuln/detail/CVE-2026-21509"
  mitre_attack:
    tactics:
      - "Execution"
      - "Defense Evasion"
      - "Initial Access"
    techniques:
      - id: "T1203"
        name: "Exploitation for Client Execution"
  classification:
    type: "Security Feature Bypass"
    severity_default: "high"
    user_interaction_required: true
    preview_pane_attack_vector: false

  trigger:
    rule_name: "Microsoft Office COM CLSID Security Feature Bypass Attempt - CVE-2026-21509"
    condition: >
      Registry event contains CLSID {EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
    artifacts_expected:
      - TargetObject
      - Image
      - EventType
      - Details
      - User
      - Hostname
      - EventTime

  objectives:
    - "Confirm whether the CLSID access is linked to Office document opening activity."
    - "Contain potential compromise if strong evidence exists."
    - "Identify the initial vector (phishing/email/download/share)."
    - "Ensure patching/mitigation is applied to prevent further exploitation."
    - "Hunt for follow-up activity (payload execution, persistence, C2)."

  workflow:
    - phase: "Triage"
      steps:
        - id: TRIAGE-01
          name: "Validate alert quality"
          actions:
            - "Verify TargetObject contains \\CLSID\\{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}"
            - "Check EventType (SetValue/CreateKey/DeleteKey/QueryValue if available)"
            - "Confirm host, user, timestamp, and frequency (single vs repeated)"
          output:
            - "triage.validated: true/false"
            - "triage.notes"

        - id: TRIAGE-02
          name: "Identify process context (best-effort)"
          actions:
            - "If Image/ProcessName is present: capture it (Office process vs COM host like dllhost.exe)"
            - "If parent process is available in your telemetry: capture ParentImage/ParentCommandLine"
          output:
            - "context.process_image"
            - "context.parent_process (optional)"

        - id: TRIAGE-03
          name: "Decide handling path"
          decision:
            when:
              - "If repeated events on same host within 5-15 minutes OR correlated suspicious activity -> treat as Confirmed Incident"
              - "If single event with no supporting signals -> treat as Suspicious and proceed with focused investigation"
          output:
            - "case.status: suspicious|confirmed"

    - phase: "Investigation"
      steps:
        - id: INV-01
          name: "Confirm user interaction (document opened)"
          actions:
            - "Interview user (or consult ticket): did they open a Word/Excel/PowerPoint/Outlook attachment or downloaded document?"
            - "Collect suspected file path(s) from Downloads, Temp, email cache, or recent files list (if available)"
          output:
            - "evidence.user_confirmed_open: true/false"
            - "evidence.suspected_file_paths[]"

        - id: INV-02
          name: "Collect file & compute hashes (if accessible)"
          actions:
            - "Acquire the suspected Office file(s) from endpoint (avoid executing it)"
            - "Compute SHA256 and store as evidence"
            - "Preserve original filename and source (email/web/share)"
          output:
            - "evidence.file.sha256"
            - "evidence.file.name"
            - "evidence.file.source"

        - id: INV-03
          name: "Check for post-exploitation signals (minimum set)"
          actions:
            - "Process creation around alert time: unusual children (rundll32, regsvr32, mshta, powershell, wscript/cscript)"
            - "Persistence checks: Run keys, Scheduled Tasks, Startup folders"
            - "Network: new outbound connections, unusual DNS, proxy anomalies"
          output:
            - "hunt.process_anomalies: true/false"
            - "hunt.persistence_anomalies: true/false"
            - "hunt.network_anomalies: true/false"

        - id: INV-04
          name: "Assess exposure: Office version & patch state (operational)"
          actions:
            - "Determine Office family/version (2016/2019 vs 2021+/M365/LTSC)"
            - "Verify security update applied for Office 2016/2019 where applicable"
            - "Confirm Office apps restarted on 2021+/M365 environments if relying on service-side protection"
          output:
            - "exposure.office_version"
            - "exposure.patched: true/false"
            - "exposure.restart_confirmed: true/false"

    - phase: "Containment"
      steps:
        - id: CON-01
          name: "Contain host (conditional)"
          condition: "case.status == 'confirmed' OR hunt.process_anomalies == true OR hunt.network_anomalies == true"
          actions:
            - "Isolate endpoint from network (EDR/SO policy) OR apply network quarantine"
            - "Block suspected file hash in EDR/email gateway if available"
          output:
            - "containment.isolated: true/false"

        - id: CON-02
          name: "Prevent lateral impact"
          actions:
            - "Search for same CLSID alerts across fleet (24-72h)"
            - "Search for same file hash/name across endpoints and mailboxes"
          output:
            - "containment.related_hosts[]"
            - "containment.related_users[]"

    - phase: "Eradication & Remediation"
      steps:
        - id: REM-01
          name: "Apply vendor remediation"
          actions:
            - "Install Microsoft security updates for affected Office versions (2016/2019 must be updated to be protected)"
            - "Where patching cannot be immediate: apply Microsoft-recommended mitigation (COM Compatibility kill-bit) following official guidance"
          output:
            - "remediation.patched: true/false"
            - "remediation.mitigation_applied: true/false"

        - id: REM-02
          name: "Clean up artifacts (if any)"
          condition: "case.status == 'confirmed'"
          actions:
            - "Remove malicious Office files from endpoint and email repositories"
            - "Remove any dropped binaries/scripts found during investigation"
            - "Reset credentials if evidence suggests compromise (high-risk user or suspicious auth)"
          output:
            - "remediation.cleaned: true/false"
            - "remediation.credential_reset: true/false"

    - phase: "Recovery"
      steps:
        - id: REC-01
          name: "Restore operations"
          actions:
            - "Reconnect endpoint after validation"
            - "Monitor host for recurrence (24-72h): repeated CLSID access, new process/network anomalies"
          output:
            - "recovery.completed: true/false"

    - phase: "Lessons Learned"
      steps:
        - id: LL-01
          name: "Detection tuning"
          actions:
            - "If false positive: record the legitimate tool/process and add a scoped filter (by Image/Publisher/host group)"
            - "If true positive: keep rule strict and consider adding a BROAD companion (image_load) for hunting"
          output:
            - "lessons.tuning_notes"

        - id: LL-02
          name: "Prevent recurrence"
          actions:
            - "Strengthen email attachment controls and user awareness for Office documents"
            - "Ensure patch SLAs for Office are enforced"
            - "Validate mitigation/patch coverage reporting"
          output:
            - "lessons.preventive_actions[]"

  closure_criteria:
    - "No further CLSID detections for the host for 72h"
    - "Office patched or mitigation applied per Microsoft guidance"
    - "No post-exploitation indicators found (process/persistence/network)"
    - "Suspected file contained and blocked (hash/path/email)"

  notes:
    - "This playbook is designed for a STRICT, single-rule detection strategy based on registry CLSID access."
    - "Preview Pane is not an attack vector for CVE-2026-21509 per Microsoft guidance."

