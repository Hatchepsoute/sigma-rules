![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Microsoft Office](https://img.shields.io/badge/Microsoft-Office-blue)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
![Microsoft Security](https://img.shields.io/badge/Microsoft-Security-blue)

# ğŸ›¡ï¸ CVE-2026-21509 - Microsoft Office Security Feature Bypass Detection

[ğŸ‘‰ğŸ¾ **French version available here**](./README_FR.md)

---

## Overview

This repository provides a **single, high-confidence Sigma detection rule** for **CVE-2026-21509**, a Microsoft Office vulnerability classified as a **Security Feature Bypass**.

The detection logic focuses on a **strong and deterministic technical invariant** explicitly documented by Microsoft:  
the access to a specific **COM CLSID** that must never be instantiated on patched or properly mitigated systems.

---

## ğŸ“‘ Attack Scenario: From Exploitation to Detection

To understand the detection logic, below is a typical attack flow based on public proof-of-concept material.

### 1. Preparation and Delivery

An attacker crafts a malicious Microsoft Office document (e.g. `.docx`) using a Python script.

The document embeds an **OLE object** referencing the following CLSID:

```
{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

This CLSID is **explicitly referenced in Microsoft security advisories** related to CVE-2026-21509.

The document is then delivered to the victim, most commonly via **phishing**.

---

### 2. Execution (Exploitation)

When the victim opens the document:

- Under normal conditions, Microsoft Office should block or warn the user before loading a risky OLE / ActiveX component.
- By exploiting **CVE-2026-21509**, the attacker forces Office to instantiate the COM object **without triggering the expected security warning**.

This results in a **security feature bypass** at the Office application level.

---

### 3. Observable System Trace (Detection Point)

To instantiate any COM object, **Windows must resolve the CLSID through the Registry**.

This generates a registry access to:

```
HKCR\CLSID\{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}
```

ğŸ“Œ **This registry access is the exact signal monitored by the Sigma rule.**

On a system that is:
- patched, or
- properly mitigated via Microsoft COM Compatibility kill-bits,

ğŸ‘‰ğŸ¾ **any access to this CLSID represents a strong security anomaly**, regardless of the originating process.

---

## ğŸ¯ Why This Detection Strategy Works

- The CLSID is **explicitly identified by Microsoft**
- It is **directly tied to the vulnerability**
- It is **blocked after patching or mitigation**
- Its access violates a **security invariant**

â¡ï¸ This makes the detection:
- simple  
- portable across SIEMs  
- high-confidence  
- independent of process name assumptions  

---

## Sigma Rule Summary

| Item | Value |
|------|-------|
| Vulnerability | CVE-2026-21509 |
| Type | Security Feature Bypass |
| Signal | Registry access to vulnerable CLSID |
| Log source | Windows Registry |
| Process dependency | No |
| Alert level | High |


## ğŸ“„ Detection rule
ğŸ‘‰ğŸ¾ **[Microsoft Office COM CLSID Security Feature Bypass â€“ CVE-2026-21509](./rules/office_com_clsid_security_feature_bypass_cve_2026_21509.yml)**

---

## References

- Microsoft Advisory: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509  
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2026-21509  
- Public PoC: https://github.com/Ashwesker/Ashwesker-CVE-2026-21509  

---

âœğŸ¾ **Author:** Adama ASSIONGBON - SOC & CTI Consultant  
**Contact:** [LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
