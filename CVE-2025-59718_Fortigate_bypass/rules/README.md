# Sigma Rules: CVE-2025-59718 detection
‚û°Ô∏è [French version available here](README_FR.md)
## üìà Detection levels & roles

### **üîµ SUPPORT Signal** - Correlative indicator for SIEM Playbooks  
- **File**:  [fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml](fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)
- **Detection Role**: Detects **two key post-exploitation indicators occurring in the same log event**: (1) an administrative login AND (2) a configuration export/backup action. This is a **support signal** that does NOT perform time-based correlation. Designed to be used **alongside BROAD/STRICT rules** within SIEM correlation playbooks or as a high-fidelity secondary indicator.

### **üü° BROAD** - Initial HTTP request detection  
- **File**:  [web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml](web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)
- **Detection Role**: Detects **HTTP POST requests to the Fortinet SAML admin endpoint** (`/remote/saml/login`). This serves as a **broad, initial signal** for potential exploitation attempts of CVE-2025-59718, capturing all relevant authentication traffic to the vulnerable endpoint for baseline monitoring and investigation.

### **üî¥ STRICT** - Specific exploitation pattern detection  
- **File**:  [web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml](web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)
- **Detection Role**: Detects **HTTP POST requests to the vulnerable SAML endpoint with specific exploitation fingerprints in the request body**. It requires the presence of both `SAMLResponse=` and `RelayState=` parameters, and a heuristic for an unusually large Base64-encoded `SAMLResponse` (‚â•1500 chars). This rule targets **the specific exploit pattern** with high confidence, requiring detailed HTTP body logging.

## üéØ Detected behavior & attack chain

**Initial Access (BROAD/STRICT)**:
`Attacker` ‚Üí **Sends POST request to** ‚Üí `https://<target>/remote/saml/login` ‚Üí **with** ‚Üí `Malicious SAML payload (exploiting SSO bypass)`

**Post-Exploitation / Pivot (SUPPORT)**:
`Successful Attacker` ‚Üí **1. Logs in as admin** ‚Üí **&** ‚Üí **2. Exports config** ‚Üí **Within the same log event**

## üöÄ Recommended deployment strategy

1.  **Infrastructure Prerequisite**: Ensure **HTTP body/payload logging** is enabled (e.g., WAF, reverse proxy, mod_security) to feed the **STRICT** rule.
2.  **Initial Monitoring**: Deploy the **BROAD** rule to establish a baseline of legitimate authentication traffic to `/remote/saml/login`.
3.  **High-Fidelity Alerting**: Activate the **STRICT** rule for **high-priority alerts** targeting the specific exploit pattern.
4.  **Correlation & Hunting**: Use the **SUPPORT** rule **in conjunction** with the others in SIEM correlation rules or as a hunting query to identify sessions where login was immediately followed by config export.

## ‚ö†Ô∏è Important notes & false positives
*   **BROAD Rule**: Will trigger on **all legitimate FortiCloud SSO authentications**. Tuning by source IP or user agent may be required.
*   **STRICT Rule**: May trigger on **legitimate, large SAML responses**. Correlate with unusual source IPs or timing.
*   **SUPPORT Rule**: Can be triggered by **legitimate admin maintenance** (login + config backup). Context from other rules (BROAD/STRICT) is key.

## üìö References
- üîó [CVE-2025-59718 @ NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-59718)
- üîó [CISA Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-59718)

## üë§ Author
**Adama Assiongbon** - [SOC & CTI Consultant](https://www.linkedin.com/in/adama-assiongbon-9029893a)
