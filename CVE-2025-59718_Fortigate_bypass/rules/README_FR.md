â¡ï¸ [English version available here](README.md)
# RÃ¨gles Sigma : DÃ©tection CVE-2025-59718

## ğŸ“ˆ Niveaux & RÃ´les de DÃ©tection

### **ğŸ”µ Signal SUPPORT** - Indicateur de corrÃ©lation pour playbooks SIEM  
**Fichier** :  [fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml](fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)
**RÃ´le de dÃ©tection** : DÃ©tecte **deux indicateurs clÃ©s de post-exploitation dans le MÃŠME Ã©vÃ©nement de log** : (1) une authentification administrative ET (2) une action d'export/sauvegarde de configuration. C'est un **signal de support** qui n'effectue PAS de corrÃ©lation temporelle. ConÃ§u pour Ãªtre utilisÃ© **en complÃ©ment des rÃ¨gles BROAD/STRICT** dans des playbooks de corrÃ©lation SIEM ou comme indicateur secondaire Ã  haute fidÃ©litÃ©.

### **ğŸŸ¡ BROAD** - DÃ©tection initiale des requÃªtes HTTP  
**Fichier** :  [web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml](web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)
**RÃ´le de dÃ©tection** : DÃ©tecte **les requÃªtes HTTP POST vers l'endpoint SAML admin de Fortinet** (`/remote/saml/login`). Cela sert de **signal large et initial** pour les tentatives d'exploitation de la CVE-2025-59718, capturant tout le trafic d'authentification pertinent vers l'endpoint vulnÃ©rable pour une surveillance de base et l'investigation.

### **ğŸ”´ STRICT** - DÃ©tection spÃ©cifique du pattern d'exploitation  
**Fichier** :  [web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml](web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)
**RÃ´le de dÃ©tection** : DÃ©tecte **les requÃªtes HTTP POST vers l'endpoint SAML vulnÃ©rable avec des empreintes spÃ©cifiques d'exploitation dans le corps de la requÃªte**. Elle requiert la prÃ©sence des paramÃ¨tres `SAMLResponse=` ET `RelayState=`, ainsi qu'une heuristique pour une `SAMLResponse` encodÃ©e en Base64 anormalement volumineuse (â‰¥1500 caractÃ¨res). Cette rÃ¨gle cible **le pattern d'exploit spÃ©cifique** avec une haute confiance, nÃ©cessitant une journalisation dÃ©taillÃ©e du corps HTTP.

## ğŸ¯ Comportement DÃ©tectÃ© & Chaine d'Attaque

**AccÃ¨s Initial (BROAD/STRICT)** :
`Attaquant` â†’ **Envoie une requÃªte POST vers** â†’ `https://<cible>/remote/saml/login` â†’ **Avec** â†’ `Charge utile SAML malveillante (exploitant le bypass SSO)`

**Post-Exploitation / Pivot (SUPPORT)** :
`Attaquant RÃ©ussi` â†’ **1. Se connecte en tant qu'admin** â†’ **&** â†’ **2. Exporte la config** â†’ **Dans le mÃªme Ã©vÃ©nement de log**

## ğŸš€ StratÃ©gie de DÃ©ploiement RecommandÃ©e

1.  **PrÃ©requis Infrastructure** : Assurez-vous que la **journalisation du corps/payload HTTP** est activÃ©e (ex : WAF, reverse proxy, mod_security) pour alimenter la rÃ¨gle **STRICT**.
2.  **Surveillance Initiale** : DÃ©ployez la rÃ¨gle **BROAD** pour Ã©tablir une baseline du trafic d'authentification lÃ©gitime vers `/remote/saml/login`.
3.  **Alerte Haute FidÃ©litÃ©** : Activez la rÃ¨gle **STRICT** pour des **alertes haute prioritÃ©** ciblant le pattern d'exploit spÃ©cifique.
4.  **CorrÃ©lation & Hunting** : Utilisez la rÃ¨gle **SUPPORT** **conjointement** avec les autres dans des rÃ¨gles de corrÃ©lation SIEM ou comme requÃªte de hunting pour identifier les sessions oÃ¹ la connexion a Ã©tÃ© immÃ©diatement suivie d'un export de config.

## âš ï¸ Notes Importantes & Faux Positifs
*   **RÃ¨gle BROAD** : DÃ©clenchera **toutes les authentifications FortiCloud SSO lÃ©gitimes**. Un ajustement par IP source ou user agent peut Ãªtre nÃ©cessaire.
*   **RÃ¨gle STRICT** : Peut Ãªtre dÃ©clenchÃ©e par des **rÃ©ponses SAML lÃ©gitimes mais volumineuses**. CorrÃ©lez avec des IP sources ou des horaires inhabituels.
*   **RÃ¨gle SUPPORT** : Peut Ãªtre dÃ©clenchÃ©e par une **maintenance administrative lÃ©gitime** (connexion + sauvegarde config). Le contexte des autres rÃ¨gles (BROAD/STRICT) est crucial.

## ğŸ“š RÃ©fÃ©rences
- ğŸ”— [CVE-2025-59718 @ NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-59718)
- ğŸ”— [Catalogue CISA des VulnÃ©rabilitÃ©s ExploitÃ©es](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-59718)

## ğŸ‘¤ Auteur
**Adama Assiongbon** - [Consultant Analyste SOC & CTI](https://www.linkedin.com/in/adama-assiongbon-9029893a)
