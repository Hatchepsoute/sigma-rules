name: CVE-2025-59718 - Fortinet SAML Authentication Bypass (SOAR)
description: >
  Automated SOAR playbook for detecting and responding to Fortinet FortiCloud SSO  authentication bypass attempts (CVE-2025-59718).
severity: Critical
tags:
  - CVE-2025-59718
  - Fortinet
  - SAML
  - SOAR
  - AuthenticationBypass

workflow:
  - step: Triage
    actions:
      - Check triggered Sigma rule (BROAD / STRICT / CORRELATION)
      - Identify affected Fortinet device
      - Extract source IP, user, endpoint
  - step: Automated Enrichment
    actions:
      - Enrich source IP (GeoIP, ASN, reputation)
      - Check IP against threat intelligence feeds
      - Correlate with recent admin logins
  - step: Validation
    actions:
      - Verify if FortiCloud SSO is enabled
      - Check if device is patched
      - Confirm presence of post-auth actions (config export)
  - step: Containment
    automated_actions:
      - Disable FortiCloud SSO admin login (API / script)
      - Restrict admin interface to VPN / allowlist
      - Block source IP on firewall (temporary)
  - step: Eradication
    automated_actions:
      - Force admin password rotation
      - Revoke active sessions
      - Apply Fortinet security patch
  - step: Recovery
    actions:
      - Restore trusted configuration
      - Monitor admin access for 72h
  - step: Lessons Learned
    actions:
      - Update detection rules
      - Document IoCs and timeline
      - Improve SOC runbooks
