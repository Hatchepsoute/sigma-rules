# CVE-2025-59718 – Fortinet FortiCloud SSO Authentication Bypass

➡️ **French version available here:** [README_FR.md](README_FR.md)

---
## Why you can trust these rules (SOC perspective)

Public Proof-of-Concept (PoC) exploits for **CVE-2025-59718** are publicly available and
demonstrate a **real, repeatable attack chain** against Fortinet devices when
FortiCloud SSO (SAML) is enabled.

These rules are **directly derived from real exploit behavior**, not theoretical assumptions.

---
## Attack scenario (based on public PoCs)

1. Attacker sends an unauthenticated HTTP **POST** request to:
   `/remote/saml/login`
2. Request contains:
   - `SAMLResponse=` (Base64-encoded, unsigned)
   - `RelayState=`
3. Device accepts the forged SAML response
4. Attacker gains **admin / super_admin** access
5. Post-authentication actions follow (dashboard access, config export)

This exact chain is translated into **layered Sigma detections**.
---
## Detection layers explained

### 1️⃣ BROAD – Early visibility

**What attackers do (PoC):**
- Probe or access the SAML admin endpoint

**What the rule detects:**
- HTTP POST requests to `/remote/saml/login`

**Required logs:**
- Web / HTTP access logs
- Method and URI fields only

**SOC value:**
- Safe to deploy
- Excellent for hunting and early warning
- May include legitimate admin SSO access

---
### 2️⃣ STRICT – Exploitation attempt

**What attackers do (PoC):**
- Submit a large Base64 `SAMLResponse`
- Include `RelayState` parameter

**What the rule detects:**
- POST + SAML endpoint + SAML parameters
- Size heuristics aligned with real exploits

**Required logs:**
- Web / HTTP access logs
- Request body visibility (or parsed parameters)

**SOC value:**
- High-confidence signal
- Low false-positive rate
- Strong indicator of exploitation attempt

---
### 3️⃣ SUPPORT – Same-event post-authentication indicator

**What attackers do (post-auth):**
- Access admin functions
- Export or backup configuration

**What the rule detects:**
- Admin login indicators AND config export indicators
- **Within the same log event only**

**Important:**
This rule does **NOT** implement time-based correlation.
It is an **optional support signal** for mature SOCs.

**Required logs:**
- Fortinet system / admin logs
- Verbose logging recommended

---
## Time-based correlation (5 minutes)

Public PoCs show that configuration export usually follows authentication within minutes.

To remain **SIEM-agnostic** and CI-safe, time-based correlation is **documented, not coded**.

See:
```
correlation/Correlation_CVE-2025-59718_5m_EN.md
```

---
## SOC deployment guidance

| SOC Level | Recommended Rules |
|---------|------------------|
| L1 | BROAD |
| L2 | BROAD + STRICT |
| L3 | BROAD + STRICT + SUPPORT + SIEM correlation |

---
## Limitations & false positives

- **BROAD** may trigger on legitimate FortiCloud SSO admin access
- **STRICT** requires request body or parameter visibility
- **SUPPORT** depends on Fortinet log verbosity and configuration

---
## Conclusion

These rules:
- Are based on **real-world exploits**
- Are safe to deploy incrementally
- Work with **any SIEM**
- Provide clarity and confidence to SOC analysts

Author: **Adama ASSIONGBON** – [Consultant Analyste SOC & CTI](https://www.linkedin.com/in/adama-assiongbon-9029893a)
