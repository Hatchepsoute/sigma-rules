# CVE-2025-59718 â€“ Fortinet FortiCloud SSO Authentication Bypass
âž¡ï¸ [French version available here](README_FR.md)
# Detection of CVE-2025-59718 (Fortinet SAML Auth Bypass) â€“ Sigma Rules

This repository contains three Sigma rules designed to detect exploitation attempts and post-exploitation indicators related to vulnerability **CVE-2025-59718** (SAML authentication bypass on Fortinet devices).

## Detection Objectives

These rules cover different aspects of the attack chain:
1.  **Broad exploitation attempt**: Detection of HTTP POST requests to the vulnerable SAML endpoint.
2.  **Strict exploitation attempt**: More precise detection based on request parameters and size (requires request body logging).
3.  **Compromise indicator (Post-exploitation)**: Detection of a single event combining admin login and config export, indicating potential data exfiltration.

---

## ðŸ“ Rules

### 1. Support Rule (Post-Exploitation)

*   **Name**: [`fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml`](./rules/fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)
*   **Role**: Detects a single Fortinet log event containing **both** an administrative login indicator and a configuration export/backup indicator. This may indicate that an attacker exported the configuration after bypassing authentication.
*   **Note**: This rule does not correlate events over time; it is based on the content of a single log entry.

### 2. Broad Rule (Exploitation Attempt)

*   **Name**: [`web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml`](./rules/web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)
*   **Role**: Detects any **HTTP POST** request to the `/remote/saml/login` URI. This is a broad signal to identify any interaction with the vulnerable SAML endpoint, whether legitimate or malicious.

### 3. Strict Rule (Exploitation)

*   **Name**: [`web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml`](./rules/web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)
*   **Role**: More precise detection of exploitation attempts. It looks for POST requests to the SAML endpoint containing `SAMLResponse` and `RelayState` parameters, with an abnormally long `SAMLResponse` parameter (base64 > 1500 characters), characteristic of a malicious payload.
*   **Prerequisite**: HTTP request body logging (`request_body`) must be enabled.

---

## ðŸ“¥  Rules

Click on the links below to download each rule file.

*   **[Support Rule (Post-Exploitation)](./rules/fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)**
*   **[Broad Rule (Exploitation Attempt)](./rules/web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)**
*   **[Strict Rule (Exploitation)](./rules/web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)**

---

## ðŸš€ Usage

1.  **Download** the rule files.
2.  **Import** them into your Sigma-compatible SIEM tool (e.g., Sekoia.io, Microsoft Sentinel, Elastic Security, etc.).
3.  **Activate** the rules according to your detection strategy.
    *   Start with the **broad rule** for visibility.
    *   Use the **strict rule** if you have request body logging enabled to reduce false positives.
    *   The **support rule** will help identify potentially compromised machines after successful exploitation.

## ðŸ”— References

*   [CVE-2025-59718 on NIST NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-59718)
*   [CVE-2025-59718 on CISA KEV Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-59718)
*   [Proof of Concept (PoC) Repositories](https://github.com/exfil0/CVE-2025-59718-PoC/tree/main)

## ðŸ‘¤ Author

**Adama ASSIONGBON**  
SOC / CTI Analyst  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a)

--- 
