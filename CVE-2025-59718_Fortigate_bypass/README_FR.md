➡️ [English version available here](README.md)
# CVE-2025-59718 – Contournement d’authentification Fortinet FortiCloud SSO

## Pourquoi ces règles sont fiables (vision SOC)

Des Proof-of-Concept (PoC) publics pour la **CVE-2025-59718** démontrent une **chaîne d’attaque réelle et exploitable** lorsque FortiCloud SSO (SAML) est activé.

Ces règles sont **directement basées sur le comportement réel des exploits**.

---
## Scénario d’attaque (basé sur les PoC publics)

1. Envoi d’une requête HTTP **POST** non authentifiée vers :
   `/remote/saml/login`
2. Présence des paramètres :
   - `SAMLResponse=` (Base64 non signée)
   - `RelayState=`
3. Authentification acceptée
4. Accès **admin / super_admin**
5. Actions post-authentification (dashboard, export configuration)

Cette chaîne est traduite en **détections Sigma en couches**.

---

## Rôle des règles

### 1️⃣ BROAD – Visibilité précoce

**Comportement attaquant (PoC) :**
- Accès à l’endpoint SAML admin

**Détection :**
- Requêtes POST vers `/remote/saml/login`

**Logs requis :**
- Logs HTTP / web
- Méthode + URI uniquement

**Valeur SOC :**
- Déploiement sans risque
- Hunting et alerte précoce
- Peut inclure des accès légitimes

---
### 2️⃣ STRICT – Tentative d’exploitation

**Comportement attaquant (PoC) :**
- `SAMLResponse` Base64 volumineuse
- Paramètre `RelayState`

**Détection :**
- POST + endpoint SAML + paramètres
- Heuristiques alignées sur les exploits réels

**Logs requis :**
- Logs HTTP
- Visibilité du corps ou des paramètres

**Valeur SOC :**
- Signal fort
- Très faible taux de faux positifs

---
### 3️⃣ SUPPORT – Indicateur post-auth (même événement)

**Comportement attaquant :**
- Actions administratives
- Export ou sauvegarde de configuration

**Détection :**
- Indicateurs login admin ET export config
- **Dans un même événement de log uniquement**

⚠️ Pas de corrélation temporelle.
Règle **optionnelle** pour SOC matures.

**Logs requis :**
- Logs système / admin Fortinet
- Verbosité recommandée

---
## Corrélation temporelle (5 minutes)

Les PoC montrent que l’export de configuration suit l’authentification rapidement.

La corrélation est **documentée hors Sigma** pour garantir la compatibilité multi-SIEM.

Voir :
[correlation/Correlation_CVE-2025-59718_5m_FR.md](./correlation/Correlation_CVE-2025-59718_5m_FR.md)

---
## Recommandations de déploiement SOC

| Niveau SOC | Règles recommandées |
|----------|--------------------|
| L1 | BROAD |
| L2 | BROAD + STRICT |
| L3 | BROAD + STRICT + SUPPORT + corrélation SIEM |

---
## Limites & faux positifs

- **BROAD** peut détecter des accès SSO légitimes
- **STRICT** nécessite la visibilité du corps HTTP
- **SUPPORT** dépend de la configuration des logs Fortinet

---
## Conclusion

Ces règles :
- S’appuient sur des exploits réels
- Sont sûres à déployer progressivement
- Fonctionnent avec tout SIEM
- Rassurent l’analyste SOC
---
Auteur : **Adama ASSIONGBON** – [Consultant Analyste SOC & CTI](https://www.linkedin.com/in/adama-assiongbon-9029893a)
