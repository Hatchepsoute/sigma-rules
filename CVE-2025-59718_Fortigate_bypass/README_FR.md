# CVE-2025-59718 ‚Äì Contournement d‚Äôauthentification Fortinet FortiCloud SSO
‚û°Ô∏è [English version available here](README.md)
# D√©tection de la CVE-2025-59718 (Fortinet SAML Auth Bypass) ‚Äì R√®gles Sigma

Ce d√©p√¥t contient trois r√®gles Sigma con√ßues pour d√©tecter les tentatives d'exploitation et les indicateurs post-exploitation li√©s √† la vuln√©rabilit√© **CVE-2025-59718** (contournement de l'authentification SAML sur les √©quipements Fortinet).

## Objectif des r√®gles

Ces r√®gles couvrent diff√©rents aspects de la cha√Æne d'attaque :
1.  **Tentative d'exploitation large** : D√©tection des requ√™tes HTTP POST vers l'endpoint SAML vuln√©rable.
2.  **Tentative d'exploitation stricte** : D√©tection plus pr√©cise bas√©e sur la taille et les param√®tres de la requ√™te (n√©cessite le logging du corps de la requ√™te).
3.  **Indicateur de compromission (Post-exploitation)** : D√©tection d'un √©v√©nement unique combinant une connexion admin et un export de configuration, signe d'une exfiltration de donn√©es.

---

## üìÅ R√®gles

### 1. R√®gle Support (Post-Exploitation)

*   **Nom** : [`fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml`](./rules/fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)
*   **R√¥le** : D√©tecte un √©v√©nement de log Fortinet contenant **√† la fois** un indicateur de connexion administrative et un indicateur d'export de configuration. Cela peut indiquer qu'un attaquant a export√© la configuration apr√®s avoir contourn√© l'authentification.
*   **Remarque** : Cette r√®gle ne corr√®le pas les √©v√©nements dans le temps ; elle se base sur le contenu d'un seul log.

### 2. R√®gle Large (Tentative d'exploitation)

*   **Nom** : [`web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml`](./rules/web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)
*   **R√¥le** : D√©tecte toute requ√™te **HTTP POST** adress√©e √† l'URI `/remote/saml/login`. C'est un signal large pour identifier des tentatives d'interaction avec l'endpoint SAML vuln√©rable, qu'elles soient l√©gitimes ou malveillantes.

### 3. R√®gle Stricte (Exploitation)

*   **Nom** : [`web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml`](./rules/web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)
*   **R√¥le** : D√©tection plus pr√©cise des tentatives d'exploitation. Elle recherche des requ√™tes POST vers l'endpoint SAML contenant les param√®tres `SAMLResponse` et `RelayState`, avec un param√®tre `SAMLResponse` anormalement long (base64 > 1500 caract√®res), ce qui est caract√©ristique d'une charge utile malveillante.
*   **Pr√©requis** : L'activation du logging du corps des requ√™tes HTTP (`request_body`) est n√©cessaire.

---

## üì• Les r√®gles

Cliquez sur les liens ci-dessous pour t√©l√©charger chaque fichier de r√®gle.

*   **[R√®gle Support (Post-Exploitation)](./rules/fortinet_admin_and_config_export_same_event_cve_2025_59718_support.yml)**
*   **[R√®gle Large (Tentative d'Exploitation)](./rules/web_fortinet_saml_auth_attempt_cve_2025_59718_broad.yml)**
*   **[R√®gle Stricte (Exploitation)](./rules/web_fortinet_saml_bypass_exploitation_cve_2025_59718_strict.yml)**

---

## üöÄ Utilisation

1.  **T√©l√©chargez** les fichiers de r√®gles.
2.  **Importez-les** dans votre outil SIEM compatible Sigma (ex : Sekoia.io, Microsoft Sentinel, Elastic Security, etc.).
3.  **Activez** les r√®gles selon votre strat√©gie de d√©tection.
    *   Commencez par la **r√®gle large** pour la visibilit√©.
    *   Utilisez la **r√®gle stricte** si vous avez le logging du corps des requ√™tes pour r√©duire les faux positifs.
    *   La **r√®gle support** vous aidera √† identifier les machines potentiellement compromises apr√®s une exploitation r√©ussie.

## üîó R√©f√©rences

*   [CVE-2025-59718 sur le NIST NVD](https://nvd.nist.gov/vuln/detail/CVE-2025-59718)
*   [CVE-2025-59718 sur le catalogue CISA KEV](https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-59718)
*   [D√©p√¥ts de preuves de concept (PoC)](https://github.com/exfil0/CVE-2025-59718-PoC/tree/main)

## üë§ Auteur

**Adama ASSIONGBON**  
SOC / CTI Analyst  
[Profil LinkedIn](https://www.linkedin.com/in/adama-assiongbon-9029893a)

