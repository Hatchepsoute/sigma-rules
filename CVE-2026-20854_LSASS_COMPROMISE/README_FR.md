# üõ°Ô∏è R√®gles Sigma pour la D√©tection de CVE-2026-20854

## Aper√ßu
Ce d√©p√¥t contient **3 r√®gles Sigma** con√ßues pour identifier l'exploitation et l'activit√© post-exploitation li√©es √† **CVE-2026-20854**, une vuln√©rabilit√© Use-After-Free dans le service LSASS de Windows permettant l'ex√©cution de code √† distance.

## Les R√®gles

| Fichier de R√®gle | Niveau | Objectif |
|------------------|--------|----------|
| `win_process_access_lsass_memory_access_cve_2026_20854_strict.yml` | **Haut** | D√©tecte les acc√®s m√©moire suspects √† LSASS (patterns de credential dumping) |
| `win_process_creation_lsass_child_process_cv_2026_20854_critical.yml` | **Critique** | D√©tecte LSASS cr√©ant des processus enfants (indicateur d'exploitation active) |
| `win_process_creation_lsass_post_exploit_cve_2026_20854_broad.yml` | **Bas** | R√®gle de hunting large pour les processus High/System integrity (activit√© post-exploitation) |

## Strat√©gie de D√©tection
```
Cha√Æne d'exploitation CVE-2026-20854
‚îú‚îÄ‚îÄ Phase 1 : RCE dans LSASS
‚îÇ ‚îî‚îÄ‚îÄ üî¥ R√®gle CRITIQUE : processus enfant LSASS
‚îÇ
‚îú‚îÄ‚îÄ Phase 2 : Credential Dumping
‚îÇ ‚îî‚îÄ‚îÄ üü† R√®gle HAUTE : acc√®s m√©moire LSASS
‚îÇ
‚îî‚îÄ‚îÄ Phase 3 : Mouvement Lat√©ral / Persistance
‚îî‚îÄ‚îÄ üü° R√®gle HUNTING : processus haute int√©grit√©
```

## Recommandations de D√©ploiement

### üö® **Pour l'Alerte en Production**
Activez imm√©diatement ces r√®gles :
- `*_strict.yml`
- `*_critical.yml`

### üîç **Pour le Threat Hunting**
Utilisez cette r√®gle pour des recherches proactives hebdomadaires :
- `*_broad.yml` **(NE PAS alerter sur cette r√®gle)**

## D√©tail des R√®gles

### 1. STRICT - Acc√®s M√©moire LSASS
**Fichier :**`[win_process_access_lsass_memory_access_cve_2026_20854_strict.yml](./rules/win_process_access_lsass_memory_access_cve_2026_20854_strict.yml)`  
**Niveau :** Haut  
**Source de Log :** Process Access Windows  
**Description :** D√©tecte les processus acc√©dant √† la m√©moire LSASS avec des masks d'acc√®s suspects (`0x10`, `0x30`, `0x1410`) couramment utilis√©s pour le credential dumping.

### 2. CRITIQUE - Processus Enfant LSASS
**Fichier :** `[win_process_creation_lsass_child_process_cv_2026_20854_critical.yml](./rules/win_process_creation_lsass_child_process_cv_2026_20854_critical.yml)`    
**Niveau :** Critique  
**Source de Log :** Process Creation Windows  
**Description :** D√©tecte LSASS.exe cr√©ant des processus enfants - un indicateur fort d'ex√©cution de code dans LSASS (exploitation active).

### 3. BROAD - Hunting Haute Int√©grit√©
**Fichier :** `[win_process_creation_lsass_post_exploit_cve_2026_20854_broad.yml](./rules/win_process_creation_lsass_post_exploit_cve_2026_20854_broad.yml)`  
**Niveau :** Bas  
**Source de Log :** Process Creation Windows  
**Description :** R√®gle de hunting large pour les processus High/System integrity. Identifie l'activit√© post-exploitation potentielle.

## Guide de Tuning

### R√®gle Strict (Acc√®s M√©moire)
- Surveillez le champ `CallTrace` pour identifier les patterns d'acc√®s l√©gitimes
- Ajoutez vos solutions EDR/AV √† la section `filter_legitimate` avec les chemins appropri√©s
- V√©rifiez `SignatureStatus` et `SignatureProductName` pour les outils sign√©s Microsoft
- Outils l√©gitimes courants : `taskmgr.exe`, `perfmon.exe`, `mmc.exe`

### R√®gle Critique (Processus Enfant LSASS)
- **Presque z√©ro faux positif** - investiguez imm√©diatement
- Seule exception connue : `WerFault.exe` lors de crashs syst√®me (d√©j√† filtr√©)
- Documentez tout processus enfant sign√© Microsoft l√©gitime (extr√™mement rare)
- Cr√©ez un playbook d'investigation sp√©cifique pour cette alerte

### R√®gle Broad (Hunting)
- **NE PAS activer en alerte** - utiliser uniquement pour le hunting
- Personnalisez les filtres selon votre environnement (outils RMM, logiciels de gestion)
- Examinez les r√©sultats hebdomadairement et ajustez les exclusions
- Recherchez les anomalies comme :
  - PowerShell/cmd.exe depuis des parents inattendus
  - Interpr√©teurs de script avec connexions r√©seau
  - Processus s'ex√©cutant depuis des emplacements temporaires

## Gestion des Faux Positifs

| R√®gle | Taux de FP | Sources Courantes | Mitigation |
|-------|------------|-------------------|------------|
| Strict | Faible | Scans de s√©curit√©, EDR/AV | Ajouter √† la liste blanche avec v√©rification de signature |
| Critique | Quasi nul | Crash syst√®me (WerFault) | D√©j√† filtr√© |
| Broad | Tr√®s √©lev√© | Outils IT, mises √† jour | Tuning sp√©cifique √† l'environnement requis |

## Installation

### Pr√©requis
- SIEM compatible Sigma (Splunk, Elastic, QRadar, Sentinel, etc.)
- Logging de cr√©ation de processus Windows activ√©
- Logging d'acc√®s processus Windows activ√©
- Script block logging PowerShell (recommand√©)

