# CVE-2026-20854 : Pack de d√©tection Compromission LSASS

üåê **English version available here:** [README.md](README.md)

---

## 1. Pr√©sentation

Ce pack de d√©tection est d√©di√© √† **CVE-2026-20854**, une vuln√©rabilit√© affectant **LSASS (Local Security Authority Subsystem Service)** sur Windows.

‚ö†Ô∏è **Point essentiel**

Cette vuln√©rabilit√© **ne peut pas √™tre d√©tect√©e directement au moment de l‚Äôexploitation** via des logs classiques.  
La d√©tection repose sur **les comportements observables apr√®s compromission**, en utilisant des **logsources Sigma g√©n√©riques**.

---

## 2. √Ä propos de CVE-2026-20854

- **Composant :** LSASS
- **Type :** Corruption m√©moire (use-after-free)
- **Impact :** √âl√©vation de privil√®ges / ex√©cution de code
- **Risque :** Compromission SYSTEM, dumping d‚Äôidentifiants, mouvements lat√©raux

L‚Äôexploitation LSASS se produisant **en m√©moire**, aucune signature directe d‚Äôexploit n‚Äôexiste dans les journaux standards.

---

## 3. Philosophie de d√©tection (STRICT)

Ce pack impl√©mente une **d√©tection corr√©l√©e**, bas√©e sur **trois signaux ind√©pendants et compl√©mentaires**.

| R√®gle | Objectif | Logsource | R√¥le |
|----|--------|-----------|------|
| Acc√®s m√©moire LSASS | D√©tecter le dumping | process_access | STRICT |
| Processus High/System | D√©tecter l‚Äô√©l√©vation | process_creation | STRICT |
| Logon SYSTEM suspect | Confirmer l‚Äôabus | security | SUPPORT |

üëâ **Une r√®gle seule n‚Äôest jamais suffisante.**  
La confiance vient de la **corr√©lation SOC**.

---

## 4. Description des r√®gles

### üîπ R√®gle 1 : Acc√®s m√©moire LSASS (G√©n√©rique)

**Fichier :**  
`process_access_win_lsass_memory_access_cve_2026_20854.yml`

**MITRE ATT&CK :**  
T1003.001 - Credential Dumping (LSASS)

**Logsource :**
- `category: process_access`
- Compatible Sysmon, EDR, frameworks d‚Äôaudit

**D√©clenchement :**
- Acc√®s m√©moire direct √† `lsass.exe`
- Droits suspects (ex: `0x1410`, `PROCESS_VM_READ`)

**Interpr√©tation :**
- Tentative probable de dumping d‚Äôidentifiants
- Signal post-exploitation fort

**Faux positifs possibles :**
- Produits de s√©curit√© endpoint
- Outils de diagnostic administrateur
- Outils de monitoring

---

### üîπ R√®gle 2 : Processus enfant High/System

**Fichier :**  
`process_creation_win_lsass_high_integrity_child_cve_2026_20854.yml`

**MITRE ATT&CK :**  
T1134 ‚Äì Manipulation de token

**D√©clenchement :**
- Processus enfant avec int√©grit√© High ou SYSTEM
- Contexte parent inhabituel

**Interpr√©tation :**
- √âl√©vation de privil√®ges r√©ussie
- Fortement compatible avec une compromission LSASS

**Faux positifs possibles :**
- D√©ploiement logiciel (SCCM, Intune)
- T√¢ches planifi√©es SYSTEM

---

### üîπ R√®gle 3 : Logon SYSTEM suspect

**Fichier :**  
`security_system_logon_anomaly_cve_2026_20854.yml`

**MITRE ATT&CK :**  
T1134 ‚Äì Abus de token

**D√©clenchement :**
- Connexion SYSTEM avec type de logon inhabituel (3, 9, 10)

**Interpr√©tation :**
- Utilisation anormale d‚Äôun token SYSTEM
- Signal de confirmation

**Faux positifs possibles :**
- D√©marrages l√©gitimes de services
- Op√©rations de maintenance

---

## 5. Logique de corr√©lation SOC

üö® **Incident confirm√© si au moins deux r√®gles se d√©clenchent sur le m√™me h√¥te dans un intervalle court (‚â§ 10 minutes).**

| Acc√®s LSASS | Proc SYSTEM | Logon SYSTEM | Verdict |
|-----------|------------|-------------|--------|
| ‚ùå | ‚ùå | ‚ùå | Ignorer |
| ‚úÖ | ‚ùå | ‚ùå | Investigation |
| ‚ùå | ‚úÖ | ‚ùå | Investigation |
| ‚úÖ | ‚úÖ | ‚ùå | Incident |
| ‚úÖ | ‚ùå | ‚úÖ | Incident |
| ‚ùå | ‚úÖ | ‚úÖ | Incident |

---

## 6. Recommandations SOC

- Isoler imm√©diatement l‚Äôh√¥te concern√©
- Analyser les acc√®s m√©moire LSASS
- Rechercher des outils de dumping
- V√©rifier l‚Äôapplication du correctif CVE-2026-20854
- Analyser les mouvements lat√©raux

---

## 7. Points cl√©s

‚úîÔ∏è Logsources Sigma g√©n√©riques  
‚úîÔ∏è D√©tection ind√©pendante des outils  
‚úîÔ∏è Corr√©lation robuste  
‚úîÔ∏è D√©tection contextualis√©e CVE  

Ce pack est destin√© aux **SOC matures** et aux √©quipes **CTI / Threat Hunting**.


