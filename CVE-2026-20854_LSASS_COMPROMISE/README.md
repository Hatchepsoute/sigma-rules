# CVE-2026-20854 - LSASS Exploitation Detection Pack

ğŸ‘‰ğŸ¾ [**French version available**](./README_FR.md)  

---

## ğŸ¯ Overview

This production-ready detection pack provides **high-confidence Sigma rules** to detect exploitation attempts targeting **LSASS**, including abuse scenarios related to **CVE-2026-20854**.

Designed for:

- Production SOC environments
- Low false positive rate
- Clear L1 / L2 / L3 triage workflow
- Immediate detection of credential access and code execution inside LSASS

---

## ğŸ“‚ Included Rules

### ğŸ”´ CRITICAL - LSASS Spawning Child Process  
[`win_process_creation_lsass_child_process_cve_2026_20854_critical.yml`](./rules/win_process_creation_lsass_child_process_cve_2026_20854_critical.yml)

LSASS should **never** spawn child processes under normal operating conditions.  
If this occurs, it strongly indicates:

- Code execution inside LSASS
- Active exploitation
- Possible abuse of CVE-2026-20854

**Severity:** Critical  
**MITRE ATT&CK:** T1003.001  

---

### ğŸŸ  STRICT - LSASS Memory Access  
[`win_process_access_lsass_memory_access_cve_2026_20854_strict.yml`](./rules/win_process_access_lsass_memory_access_cve_2026_20854_strict.yml)

Detects suspicious access to LSASS memory using:

- Abused access masks (`0x10`, `0x30`, `0x1410`)
- Known credential dumping tools
- Signed Microsoft binaries filtering
- AV/EDR allowlist support

**Severity:** High  
**MITRE ATT&CK:** T1003.001  

---

## ğŸ›¡ SOC Triage Model

| Alert | Priority | Immediate Action |
|-------|----------|-----------------|
| ğŸ”´ CRITICAL â€“ LSASS Child | P1 | Immediate host isolation |
| ğŸŸ  STRICT â€“ LSASS Access | P1 / P2 | Credential exposure assessment + lateral movement investigation |

---

## ğŸ§  Detection Strategy

This pack follows a **signal-first detection engineering approach**:

- No noisy hunting rules
- No generic High/System anomaly detection
- Only behavior directly linked to LSASS exploitation

The BROAD hunting rule was intentionally removed to maintain a high signal-to-noise ratio.

---

## ğŸ“Š Log Requirements

Recommended telemetry:

- Sysmon Event ID 10 (ProcessAccess)
- Sysmon Event ID 1 (ProcessCreation)
- EDR process telemetry
- SignatureStatus / SignatureProductName fields

---

## ğŸ”§ Tuning Guidance

Before enabling in production:

1. Add your EDR/AV paths to allowlists
2. Validate Microsoft-signed binaries in your environment
3. Test in monitoring mode before enforcement

---

## âš  Important

If either rule triggers, treat it as:

- Active exploitation
- Credential dumping
- Privilege escalation
- Post-exploitation activity

Do not ignore these alerts.
