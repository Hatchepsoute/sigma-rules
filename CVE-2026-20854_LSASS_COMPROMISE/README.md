# CVE-2026-20854 ‚Äì LSASS Compromise Detection Pack

üåê **French version favailable here:** [README_FR.md](README_FR.md)

---

## 1. Overview

This detection pack focuses on **post-exploitation detection** related to **CVE-2026-20854**, a vulnerability affecting **Windows LSASS (Local Security Authority Subsystem Service)**.

‚ö†Ô∏è **Important note**

This vulnerability **cannot be reliably detected at exploit time** using standard logs.  
Detection must rely on **observable behaviors after exploitation**, using **generic, backend-agnostic Sigma rules**.

---

## 2. About CVE-2026-20854

- **Component:** LSASS
- **Vulnerability type:** Memory corruption (use-after-free)
- **Impact:** Privilege escalation / code execution
- **Risk:** SYSTEM compromise, credential dumping, lateral movement

Because LSASS exploitation occurs **entirely in memory**, there is no direct log signature for the exploit itself.

---

## 3. Detection Philosophy (STRICT)

This pack implements a **correlated detection strategy** based on **three independent but complementary signals**.

| Rule | Objective | Logsource | Role |
|----|---------|-----------|------|
| LSASS memory access | Detect credential dumping | process_access | STRICT |
| High/System child process | Detect privilege escalation | process_creation | STRICT |
| Suspicious SYSTEM logon | Confirm token abuse | security | SUPPORT |

‚ö†Ô∏è **No single rule proves exploitation alone.**  
Confidence comes from **correlation**.

---

## 4. Rules Description

### üîπ Rule 1 : LSASS Memory Access (Generic)

**File:**  
`process_access_win_lsass_memory_access_cve_2026_20854.yml`

**MITRE ATT&CK:**  
T1003.001 ‚Äì OS Credential Dumping (LSASS)

**Logsource:**
- `category: process_access`
- Backend-agnostic (Sysmon, EDR, audit frameworks)

**Triggers when:**
- A process accesses the memory of `lsass.exe`
- Suspicious access rights are requested (e.g. `0x1410`, `PROCESS_VM_READ`)

**What it indicates:**
- Possible credential dumping
- Strong post-exploitation signal

**False positives may include:**
- Endpoint security products
- Administrative troubleshooting tools
- Performance monitoring utilities

---

### üîπ Rule 2 : High/System Integrity Child Process

**File:**  
`process_creation_win_lsass_high_integrity_child_cve_2026_20854.yml`

**MITRE ATT&CK:**  
T1134 ‚Äì Access Token Manipulation

**Triggers when:**
- A child process runs with **High or SYSTEM integrity**
- The parent context is unusual or non-privileged

**What it indicates:**
- Successful privilege escalation
- Highly consistent with LSASS abuse

**False positives may include:**
- Software deployment tools (SCCM, Intune)
- Scheduled tasks running as SYSTEM

---

### üîπ Rule 3 : Suspicious SYSTEM Logon

**File:**  
`security_system_logon_anomaly_cve_2026_20854.yml`

**MITRE ATT&CK:**  
T1134 ‚Äì Token Abuse

**Triggers when:**
- SYSTEM account logs on using abnormal logon types (3, 9, 10)

**What it indicates:**
- SYSTEM token usage outside expected workflows
- Confirmation signal

**False positives may include:**
- Legitimate service startups
- Maintenance operations

---

## 5. Correlation Logic (SOC)

üö® **An incident is confirmed when at least two rules trigger on the same host within a short time window (‚â§ 10 minutes).**

| LSASS Access | SYSTEM Process | SYSTEM Logon | Verdict |
|------------|---------------|-------------|--------|
| ‚ùå | ‚ùå | ‚ùå | Ignore |
| ‚úÖ | ‚ùå | ‚ùå | Investigate |
| ‚ùå | ‚úÖ | ‚ùå | Investigate |
| ‚úÖ | ‚úÖ | ‚ùå | Incident |
| ‚úÖ | ‚ùå | ‚úÖ | Incident |
| ‚ùå | ‚úÖ | ‚úÖ | Incident |

---

## 6. SOC Recommendations

- Immediately isolate the affected host
- Investigate LSASS memory access events
- Search for credential dumping tools
- Verify patch status for CVE-2026-20854
- Investigate lateral movement

---

## 7. Key Takeaways

‚úîÔ∏è Generic Sigma log sources  
‚úîÔ∏è Backend-agnostic detection  
‚úîÔ∏è Correlation-based confidence  
‚úîÔ∏è CVE-aware detection logic  

This pack is designed for **mature SOC environments** and **threat hunting teams**.

---

