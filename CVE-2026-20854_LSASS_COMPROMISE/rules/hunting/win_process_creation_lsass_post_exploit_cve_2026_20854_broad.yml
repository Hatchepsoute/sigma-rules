title: BROAD - Suspicious High/System Integrity Child Process (Hunting) (CVE-2026-20854)
id: 2d171873-d0a6-4d35-a115-7db83cf4f4f9
status: experimental
description: |
  HUNTING RULE - Detects creation of High/System integrity processes for proactive threat hunting. May indicate post-exploitation activity following LSASS compromise (CVE-2026-20854). NOT INTENDED FOR ALERTING without extensive tuning.
  
  FR => RÈGLE DE HUNTING - Détecte la création de processus High/System integrity pour la chasse proactive. Peut indiquer une activité post-exploitation suite à une compromission LSASS (CVE-2026-20854). PAS DESTINÉE À L'ALERTE sans tuning approfondi.
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20854
  - https://www.cve.org/CVERecord?id=CVE-2026-20854
  - https://attack.mitre.org/techniques/T1003/001/
  - https://nvd.nist.gov/vuln/detail/CVE-2026-20854
author: Adama ASSIONGBON SOC/CTI Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-01-20
modified: 2026-02-21
logsource:
  product: windows
  category: process_creation
detection:
  # Sélection des processus enfants avec intégrité élevée
  selection_high_integrity_child:
    IntegrityLevel|contains:
      - High
      - System
  
  # Filtres larges pour les parents système normaux
  filter_core_system_parents:
    ParentImage|endswith:
      - '\services.exe'
      - '\svchost.exe'
      - '\wininit.exe'
      - '\winlogon.exe'
      - '\lsass.exe'          # Inclus pour hunting, mais nécessite investigation
      - '\csrss.exe'
      - '\smss.exe'
  
  # Filtres pour les produits de sécurité
  filter_defender_edr:
    ParentImage|endswith:
      - '\MsMpEng.exe'
      - '\SenseIR.exe'
      - '\SenseSC.exe'
      - '\SecurityHealthService.exe'
      - '\NisSrv.exe'
  
  # Filtres pour outils de gestion IT
  filter_management_tools:
    ParentImage|endswith:
      - '\CcmExec.exe'                    # SCCM
      - '\IntuneManagementExtension.exe'   # Intune
      - '\NinjaRMMAgent.exe'               # NinjaRMM
      - '\PDQDeployRunner.exe'              # PDQ
      - '\AteraAgent.exe'                   # Atera
      - '\MeshAgent.exe'                    # MeshCentral
      - '\salt-minion.exe'                  # SaltStack
      - '\ansible-runner.exe'               # Ansible
      - '\VeeamDeploymentSvc.exe'           # Veeam
      - '\MOMAgent.exe'                     # System Center Operations Manager
  
  # Filtres pour les enfants légitimes courants
  filter_common_legit_children:
    Image|endswith:
      - '\conhost.exe'
      - '\backgroundTaskHost.exe'
      - '\RuntimeBroker.exe'
      - '\sihost.exe'
      - '\taskhostw.exe'
      - '\dllhost.exe'
      - '\WmiPrvSE.exe'
  
  # Filtres pour tâches planifiées
  filter_schtasks_parent:
    ParentImage|endswith:
      - '\taskeng.exe'
      - '\schtasks.exe'
  
  # Condition : tout processus haute intégrité SAUF ceux filtrés ci-dessus
  condition: selection_high_integrity_child and not 1 of filter_*
fields:
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - IntegrityLevel
  - User
  - ProcessGuid
  - ParentProcessGuid
  - Hostname
falsepositives:
  - EXTREMELY HIGH - This rule is intentionally broad for hunting purposes.
  - Legitimate software deployment, RMM tools, security scans, and system maintenance.
  - NOT FOR PRODUCTION ALERTING without extensive environment-specific allowlisting.
level: low
tags:
  - attack.credential-access
  - attack.privilege-escalation
  - attack.t1003
  - attack.t1003.001
  - attack.t1068
