title: Suspicious High-Integrity Child Process Following LSASS Exploitation - CVE-2026-20854
id: 26e1b86e-eff6-4d05-b44d-d4953be9802b
status: experimental
description: |
  Detects suspicious post-exploitation activity that may follow a successful LSASS compromise  (e.g., CVE-2026-20854): creation of a High/System integrity child process in an unusual context.
  This rule is exploit-agnostic and focuses on observable behavior after privilege escalation.
  /
  FR => Détecte les activités suspectes post-exploitation faisant suite à une compromission réussie de LSASS (par exemple, via la faille CVE-2026-20854) : notamment la création d'un processus enfant avec un niveau d'intégrité Élevé/Système dans un contexte inhabituel. Cette règle est indépendante de l'exploit utilisé (exploit-agnostic) et se concentre sur le comportement observable après une élévation de privilèges.
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20854
  - https://nvd.nist.gov/vuln/detail/CVE-2026-20854
  - https://attack.mitre.org/techniques/T1003/001/
author: Adama ASSIONGBON SOC/CTI Analyst Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-01-20
modified: 2026-01-21
tags:
  - attack.credential-access
  - attack.t1003.001
  - attack.t1134
  - cve.2026-20854
logsource:
  category: process_creation
  product: windows

detection:
  # -----------------------------------------------------------------------------
  # SCENARIO: High/System integrity child process in potentially unusual context
  # -----------------------------------------------------------------------------
  selection_high_integrity_child:
    IntegrityLevel|contains:
      - 'High'
      - 'System'

  # OPTIONAL ENRICHMENT (if available in your telemetry):
  # If your events include ParentIntegrityLevel, this increases confidence.
  # Uncomment if your data source supports it.
  # selection_parent_not_high:
  #   ParentIntegrityLevel|not|contains:
  #     - 'High'
  #     - 'System'

  # -----------------------------------------------------------------------------
  # KNOWN GOOD FILTERS (tune to your environment)
  # -----------------------------------------------------------------------------
  filter_core_system_parents:
    ParentImage|endswith:
      - '\services.exe'
      - '\svchost.exe'
      - '\wininit.exe'
      - '\winlogon.exe'
      - '\lsass.exe'
      - '\csrss.exe'
      - '\smss.exe'

  filter_defender_edr:
    ParentImage|endswith:
      - '\MsMpEng.exe'
      - '\SenseIR.exe'
      - '\SenseSC.exe'
      - '\SecurityHealthService.exe'

  filter_management_tools:
    ParentImage|endswith:
      - '\CcmExec.exe'                 # SCCM
      - '\IntuneManagementExtension.exe' # Intune
      - '\NinjaRMMAgent.exe'
      - '\PDQDeployRunner.exe'
      - '\AteraAgent.exe'
      - '\MeshAgent.exe'
      - '\salt-minion.exe'
      - '\ansible-runner.exe'

  filter_common_legit_children:
    Image|endswith:
      - '\conhost.exe'
      - '\backgroundTaskHost.exe'
      - '\RuntimeBroker.exe'

  # Optional: reduce noise from scheduled tasks that legitimately run elevated
  # (Be careful: attackers also use schtasks.)
  filter_schtasks_parent:
    ParentImage|endswith: '\taskeng.exe'

  # -----------------------------------------------------------------------------
  # FINAL CONDITION
  # -----------------------------------------------------------------------------
  condition: selection_high_integrity_child and not 1 of filter_*

fields:
  - Image
  - CommandLine
  - ParentImage
  - ParentCommandLine
  - User
  - IntegrityLevel
  - ParentIntegrityLevel
  - LogonId
  - ProcessGuid
  - ParentProcessGuid
  - Hashes

falsepositives:
  - Legitimate software deployment via SCCM/Intune/EDR running as SYSTEM.
  - Scheduled tasks configured to run with highest privileges.
  - Backup/security products spawning elevated helper processes.
  - Administrative maintenance scripts executed by IT.

level: high

