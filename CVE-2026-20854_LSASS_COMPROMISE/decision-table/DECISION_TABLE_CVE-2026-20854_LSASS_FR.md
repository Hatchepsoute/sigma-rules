# Table de D√©cision - R√®gles de D√©tection LSASS CVE-2026-20854

üëâüèæ [English version available here](./DECISION_TABLE_CVE-2026-20854_LSASS.md)

**Objectif :** Cette table de d√©cision aide les analystes SOC et les ing√©nieurs d√©tection avec le triage, le tuning et l'optimisation des trois r√®gles Sigma cr√©√©es pour CVE-2026-20854 (vuln√©rabilit√© Use-After-Free dans LSASS Windows).

**Recommandation :** Optimiser vers **2 r√®gles** (STRICT + BROAD) pour le meilleur ratio signal/bruit.

---

## R√®gle 1 : STRICT - Acc√®s M√©moire LSASS

| Cat√©gorie | D√©tails |
|-----------|---------|
| **Nom de la R√®gle** | Suspicious LSASS Memory Access ‚Äì Possible Credential Dumping (CVE-2026-20854) |
| **Source de Log** | `windows/process_access` |
| **Statut** | Experimental |
| **Objectif SOC** | D√©tecter le credential dumping / acc√®s m√©moire LSASS (post-exploitation) |
| **Condition de D√©clenchement** | `selection_lsass and not filter_legitimate` |
| **Confiance** | **√âlev√©e** (si la t√©l√©m√©trie process_access est fiable) |
| **Niveau** | `high` |
| **Champs Cl√©s** | `SourceImage`, `TargetImage`, `GrantedAccess`, `CallTrace`, `User`, `ProcessGuid`, `Hashes`, `SignatureStatus`, `SignatureProductName` |
| **Faux Positifs Courants** | ‚Ä¢ Produits de s√©curit√© l√©gitimes<br>‚Ä¢ Outils d'administration (Task Manager, Perfmon)<br>‚Ä¢ Logiciels de sauvegarde acc√©dant √† LSASS |
| **Guidage Tuning** | ‚Ä¢ √âtendre l'allowlist des EDR/AV avec v√©rification de signature<br>‚Ä¢ Resserer les valeurs `GrantedAccess` bas√©es sur les patterns malveillants observ√©s<br>‚Ä¢ Contrainte de chemin `SourceImage` (ex: `C:\Windows\System32\`)<br>‚Ä¢ Utiliser les patterns `CallTrace` si disponibles<br>‚Ä¢ Valider les outils sign√©s Microsoft avec `SignatureStatus` et `SignatureProductName` |
| **R√©ponse Recommand√©e** | ‚Ä¢ Isoler l'h√¥te si confirm√© malveillant<br>‚Ä¢ Identifier le signataire/hash de `SourceImage`<br>‚Ä¢ Chercher des artefacts de dump LSASS (fichiers `*.dmp`)<br>‚Ä¢ Rotation des identifiants privil√©gi√©s<br>‚Ä¢ Enqu√™ter sur la cha√Æne de processus parent |

---

## R√®gle 2 : CRITIQUE - Processus Enfant LSASS

| Cat√©gorie | D√©tails |
|-----------|---------|
| **Nom de la R√®gle** | CRITICAL - LSASS Spawning Child Process (Active Exploitation CVE-2026-20854) |
| **Source de Log** | `windows/process_creation` |
| **Statut** | Experimental |
| **Objectif SOC** | D√©tecter l'exploitation active de LSASS (indicateur d'ex√©cution de code) |
| **Condition de D√©clenchement** | `ParentImage endswith '\lsass.exe' and not filter_werfault and not filter_microsoft_signed` |
| **Confiance** | **Critique** (presque z√©ro faux positif) |
| **Niveau** | `critical` |
| **Champs Cl√©s** | `Image`, `CommandLine`, `ParentImage`, `ParentCommandLine`, `IntegrityLevel`, `User`, `ProcessGuid`, `ParentProcessGuid`, `SignatureStatus` |
| **Faux Positifs Courants** | ‚Ä¢ `WerFault.exe` lors de crashs syst√®me (d√©j√† filtr√©)<br>‚Ä¢ Processus enfants sign√©s Microsoft extr√™mement rares (documenter si rencontr√©s) |
| **Guidage Tuning** | ‚Ä¢ **NE PAS affaiblir cette r√®gle** ‚Äî c'est votre d√©tection la plus forte<br>‚Ä¢ Documenter tout processus enfant l√©gitime avec contexte complet<br>‚Ä¢ Surveiller les exceptions sign√©es Microsoft (devraient √™tre quasi nulles)<br>‚Ä¢ Cr√©er un playbook d'investigation automatis√© pour cette alerte |
| **R√©ponse Recommand√©e** | ‚Ä¢ **ISOLEMENT IMM√âDIAT** de l'h√¥te<br>‚Ä¢ Traiter comme une compromission active<br>‚Ä¢ Capturer une image m√©moire pour forensic<br>‚Ä¢ Rechercher du mouvement lat√©ral depuis cet h√¥te<br>‚Ä¢ Rotation d'urgence de tous les comptes privil√©gi√©s<br>‚Ä¢ Activation de la proc√©dure compl√®te de r√©ponse √† incident |

---

## R√®gle 3 : BROAD - Hunting Haute Int√©grit√©

| Cat√©gorie | D√©tails |
|-----------|---------|
| **Nom de la R√®gle** | BROAD - Suspicious High/System Integrity Child Process (Hunting) (CVE-2026-20854) |
| **Source de Log** | `windows/process_creation` |
| **Statut** | Experimental |
| **Objectif SOC** | Alerte pr√©coce / hunting pour activit√© post-exploitation apr√®s compromission LSASS |
| **Condition de D√©clenchement** | `selection_high_integrity_child and not 1 of filter_*` |
| **Confiance** | **Moyenne** (d√©pend fortement de l'environnement) |
| **Niveau** | `low` (hunting uniquement - PAS pour l'alerte) |
| **Champs Cl√©s** | `Image`, `CommandLine`, `ParentImage`, `ParentCommandLine`, `IntegrityLevel`, `User`, `ProcessGuid`, `ParentProcessGuid`, `Hostname` |
| **Faux Positifs Courants** | ‚Ä¢ D√©ploiement logiciel l√©gitime (SCCM, Intune)<br>‚Ä¢ Outils RMM s'ex√©cutant en SYSTEM<br>‚Ä¢ T√¢ches planifi√©es avec privil√®ges √©lev√©s<br>‚Ä¢ Produits de sauvegarde/s√©curit√© cr√©ant des processus auxiliaires<br>‚Ä¢ Mises √† jour Windows et t√¢ches de maintenance |
| **Guidage Tuning** | ‚Ä¢ **NE PAS activer en alerte** ‚Äî utiliser uniquement pour le hunting<br>‚Ä¢ Ajouter des allowlists pour vos outils de gestion par `ParentImage` et `ParentCommandLine`<br>‚Ä¢ Cr√©er une variante "STRICT" ciblant les binaires enfants suspects (`cmd.exe`, `powershell.exe`, `rundll32.exe`, `wmic.exe`, `mshta.exe`)<br>‚Ä¢ Examiner les r√©sultats hebdomadairement et ajuster les exclusions<br>‚Ä¢ Se concentrer sur les anomalies : parents inattendus, chemins temporaires, connexions r√©seau |
| **R√©ponse Recommand√©e** | ‚Ä¢ Analyser la cha√Æne parent/enfant et les lignes de commande<br>‚Ä¢ Rechercher des outils de mouvement lat√©ral ou de credential dumping<br>‚Ä¢ Valider l'activit√© via la timeline EDR<br>‚Ä¢ Si suspect, passer √† une investigation compl√®te |

---

## Verdict d'Optimisation

| R√®gle | Conserver ? | Raison |
|-------|-------------|--------|
| **STRICT ‚Äî Acc√®s M√©moire** | ‚úÖ **OUI** | Signal le plus fort, proche du comportement de credential dumping |
| **CRITIQUE ‚Äî Processus Enfant** | ‚úÖ **OUI** | Presque z√©ro faux positif, indicateur d'exploitation active |
| **BROAD ‚Äî Hunting** | ‚úÖ **OUI (hunting uniquement)** | Pr√©cieux pour le hunting proactif, PAS pour l'alerte |

**Recommandation Finale :** Conserver les **3 r√®gles** avec des directives d'utilisation claires :
- **STRICT + CRITIQUE** ‚Üí Alerting en production
- **BROAD** ‚Üí Exercices de hunting hebdomadaires

---

## Optimisations Rapides

### Pour la R√®gle STRICT (Acc√®s M√©moire)
1. Ajouter vos solutions EDR/AV √† l'allowlist avec v√©rification de signature
2. Resserer `GrantedAccess` aux valeurs minimales observ√©es dans les outils malveillants
3. Utiliser les patterns `CallTrace` pour valider l'acc√®s l√©gitime
4. Exiger `SignatureStatus: Valid` pour les exceptions sign√©es Microsoft

### Pour la R√®gle CRITIQUE (Processus Enfant)
1. **Laisser telle quelle** - elle est d√©j√† optimis√©e
2. Documenter tout d√©clenchement l√©gitime pour r√©f√©rence future
3. Cr√©er un playbook de r√©ponse automatis√©e

### Pour la R√®gle BROAD (Hunting)
1. Cr√©er un calendrier de hunting hebdomadaire
2. Construire une allowlist sp√©cifique √† l'environnement au fil du temps
3. D√©velopper une variante "STRICT" avec liste de binaires suspects
4. Partager les r√©sultats avec les √©quipes IT pour am√©liorer les filtres

---

## R√©f√©rences
- [Guide des mises √† jour Microsoft](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20854)
- [MITRE ATT&CK T1003.001](https://attack.mitre.org/techniques/T1003/001/)
- [D√©tail NVD](https://nvd.nist.gov/vuln/detail/CVE-2026-20854)

---


**Auteur :** Adama ASSIONGBON - Consultant SOC/CTI
