# Decision Table - CVE-2026-20854 LSASS Detection Rules

üëâüèæ [French version available here](./DECISION_TABLE_CVE-2026-20854_LSASS_FR.md)

**Purpose:** This decision table helps SOC analysts and detection engineers with triage, tuning, and optimization of the three Sigma rules created for CVE-2026-20854 (Windows LSASS Use-After-Free vulnerability).

**Recommendation:** Optimize to **2 rules** (STRICT + BROAD) for the best signal-to-noise ratio.

---

## Rule 1: STRICT -  LSASS Memory Access

| Category | Details |
|----------|---------|
| **Rule Name** | Suspicious LSASS Memory Access ‚Äì Possible Credential Dumping (CVE-2026-20854) |
| **Log Source** | `windows/process_access` |
| **Status** | Experimental |
| **SOC Intent** | Detect credential dumping / LSASS memory access (post-exploitation) |
| **Trigger Condition** | `selection_lsass and not filter_legitimate` |
| **Confidence** | **High** (when process access telemetry is reliable) |
| **Level** | `high` |
| **Key Fields** | `SourceImage`, `TargetImage`, `GrantedAccess`, `CallTrace`, `User`, `ProcessGuid`, `Hashes`, `SignatureStatus`, `SignatureProductName` |
| **Common False Positives** | ‚Ä¢ Legitimate endpoint security products<br>‚Ä¢ Administrative troubleshooting tools (Task Manager, Perfmon)<br>‚Ä¢ Backup software accessing LSASS |
| **Tuning Guidance** | ‚Ä¢ Expand allowlist for EDR/AV tools with signature verification<br>‚Ä¢ Tighten `GrantedAccess` values based on observed malicious patterns<br>‚Ä¢ Add `SourceImage` path constraints (e.g., require expected paths like `C:\Windows\System32\`)<br>‚Ä¢ Leverage `CallTrace` patterns if available<br>‚Ä¢ Use `SignatureStatus` and `SignatureProductName` to validate Microsoft-signed tools |
| **Recommended Response** | ‚Ä¢ Isolate host if confirmed malicious<br>‚Ä¢ Identify `SourceImage` signer/hash<br>‚Ä¢ Check for LSASS dump artifacts (`*.dmp` files)<br>‚Ä¢ Rotate privileged credentials<br>‚Ä¢ Investigate parent process chain |

---

## Rule 2: CRITICAL - LSASS Child Process

| Category | Details |
|----------|---------|
| **Rule Name** | CRITICAL - LSASS Spawning Child Process (Active Exploitation CVE-2026-20854) |
| **Log Source** | `windows/process_creation` |
| **Status** | Experimental |
| **SOC Intent** | Detect active exploitation of LSASS (code execution indicator) |
| **Trigger Condition** | `ParentImage endswith '\lsass.exe' and not filter_werfault and not filter_microsoft_signed` |
| **Confidence** | **Critical** (almost zero false positives) |
| **Level** | `critical` |
| **Key Fields** | `Image`, `CommandLine`, `ParentImage`, `ParentCommandLine`, `IntegrityLevel`, `User`, `ProcessGuid`, `ParentProcessGuid`, `SignatureStatus` |
| **Common False Positives** | ‚Ä¢ `WerFault.exe` during system crashes (already filtered)<br>‚Ä¢ Extremely rare Microsoft-signed child processes (document if encountered) |
| **Tuning Guidance** | ‚Ä¢ **DO NOT weaken this rule** ‚Äî it's your strongest detection<br>‚Ä¢ Document any legitimate child processes with full context<br>‚Ä¢ Monitor for new Microsoft-signed exceptions (should be near zero)<br>‚Ä¢ Create automated investigation playbook for this alert |
| **Recommended Response** | ‚Ä¢ **IMMEDIATE ISOLATION** of the host<br>‚Ä¢ Treat as active compromise<br>‚Ä¢ Capture memory image for forensics<br>‚Ä¢ Hunt for lateral movement from this host<br>‚Ä¢ Emergency credential rotation for all privileged accounts<br>‚Ä¢ Full incident response procedure activation |

---

## Rule 3: BROAD - System Integrity Hunting

| Category | Details |
|----------|---------|
| **Rule Name** | BROAD ‚Äî Suspicious High/System Integrity Child Process (Hunting) (CVE-2026-20854) |
| **Log Source** | `windows/process_creation` |
| **Status** | Experimental |
| **SOC Intent** | Early warning / hunting for post-exploitation activity after LSASS compromise |
| **Trigger Condition** | `selection_high_integrity_child and not 1 of filter_*` |
| **Confidence** | **Medium** (highly environment-dependent) |
| **Level** | `low` (hunting only ‚Äî NOT for alerting) |
| **Key Fields** | `Image`, `CommandLine`, `ParentImage`, `ParentCommandLine`, `IntegrityLevel`, `User`, `ProcessGuid`, `ParentProcessGuid`, `Hostname` |
| **Common False Positives** | ‚Ä¢ Legitimate software deployment (SCCM, Intune)<br>‚Ä¢ RMM tools running as SYSTEM<br>‚Ä¢ Scheduled tasks with highest privileges<br>‚Ä¢ Backup/security products spawning helper processes<br>‚Ä¢ Windows updates and maintenance tasks |
| **Tuning Guidance** | ‚Ä¢ **DO NOT enable alerting** - use for hunting only<br>‚Ä¢ Add allowlists for your management tools by `ParentImage` and `ParentCommandLine`<br>‚Ä¢ Create a "STRICT" variant focusing on suspicious child binaries (`cmd.exe`, `powershell.exe`, `rundll32.exe`, `wmic.exe`, `mshta.exe`)<br>‚Ä¢ Review results weekly and tune exclusions<br>‚Ä¢ Focus on anomalies: unexpected parents, temporary paths, network connections |
| **Recommended Response** | ‚Ä¢ Review parent/child chain and command lines<br>‚Ä¢ Look for lateral movement tools or credential dumpers<br>‚Ä¢ Validate activity via EDR timeline<br>‚Ä¢ If suspicious, upgrade to full investigation |

---

## Optimization verdict

| Rule | Keep? | Rationale |
|------|-------|-----------|
| **STRICT - Memory Access** | ‚úÖ **YES** | Strongest signal, closest to credential dumping behavior |
| **CRITICAL - Child Process** | ‚úÖ **YES** | Near-zero false positives, active exploitation indicator |
| **BROAD - Hunting** | ‚úÖ **YES (for hunting only)** | Valuable for proactive threat hunting, NOT for alerting |

**Final Recommendation:** Keep all **3 rules** with clear usage guidelines:
- **STRICT + CRITICAL** ‚Üí Production alerting
- **BROAD** ‚Üí Weekly hunting exercises

---

## Quick Tuning Wins

### For STRICT Rule (Memory Access)
1. Add your EDR/AV solutions to allowlist with signature verification
2. Tighten `GrantedAccess` to the minimum set you observe in malicious tools
3. Use `CallTrace` patterns to validate legitimate access
4. Require `SignatureStatus: Valid` for Microsoft-signed exceptions

### For CRITICAL Rule (Child Process)
1. **Leave as-is** - it's already optimized
2. Document any legitimate triggers for future reference
3. Create automated response playbook

### For BROAD Rule (Hunting)
1. Create weekly hunting schedule
2. Build environment-specific allowlist over time
3. Develop "STRICT" variant with suspicious binary list
4. Share findings with IT teams to improve filters

---

## References
- [Microsoft Security Update Guide](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20854)
- [MITRE ATT&CK T1003.001](https://attack.mitre.org/techniques/T1003/001/)
- [NVD Detail](https://nvd.nist.gov/vuln/detail/CVE-2026-20854)

---

**Author:** Adama ASSIONGBON - SOC/CTI Consultant
