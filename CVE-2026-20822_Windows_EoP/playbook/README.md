French version available here: [README_FR.md](./README_FR.md)

# SOC Playbook – Windows Privilege Escalation (EoP)
> This playbook is SOAR-agnostic and intended for manual use or future automation.
## Scope
This playbook applies to detections related to **Windows privilege escalation behaviors**, including but not limited to rules associated with CVE-2026-20822.

It is designed for **SOC Tier 1 to Tier 3** operations.

---

## 1️⃣ Trigger Conditions

### Entry Points
- Sigma rule: **BROAD – Suspicious Privilege Escalation Behavior**
- Sigma rule: **STRICT – Successful Privilege Escalation to SYSTEM**
- EDR alert indicating SYSTEM execution from user context

---

## 2️⃣ Initial Triage (SOC L1)

### Objectives
- Validate alert legitimacy
- Identify false positives quickly

### Actions
- Identify:
  - Hostname
  - Username
  - Parent process
  - Child process
- Check:
  - Parent → child relationship
  - Execution time
  - Integrity level / user context

### Decision
- If BROAD only → escalate to **SOC L2 (Hunting)**
- If STRICT triggered → escalate immediately to **SOC L2/L3**

---

## 3️⃣ Context Enrichment (SOC L2)

### Host Context
- Is the host:
  - a workstation?
  - a server?
  - a privileged admin endpoint?

### User Context
- Is the user:
  - local admin?
  - standard user?
  - service account?

### Timeline Review
- Events in the last **30–60 minutes**:
  - process creation
  - service creation
  - scheduled tasks
  - registry modifications

---

## 4️⃣ Threat Validation (SOC L2)

### Indicators of Compromise
Look for:
- SYSTEM shell spawned from user application
- Use of:
  - `sc.exe`
  - `schtasks.exe`
  - `reg.exe`
  - `powershell.exe` with encoded commands
- Attempts to access:
  - LSASS
  - SAM / SECURITY registry hives

### Assessment
- If no malicious follow-up → monitor
- If post-exploitation activity detected → escalate to **SOC L3**

---

## 5️⃣ Incident Response (SOC L3)

### Containment
- Isolate host (EDR / network)
- Block user account if compromised
- Kill malicious processes

### Eradication
- Remove persistence mechanisms
- Delete malicious binaries
- Revoke credentials if needed

### Recovery
- Patch affected systems
- Reset passwords
- Re-enable security controls

---

## 6️⃣ Post-Incident Actions

### Lessons Learned
- Was the vulnerability patched?
- Were detection rules effective?
- Was response time acceptable?

### Improvements
- Tune BROAD rule filters
- Enrich STRICT correlation
- Update SOC documentation

---

## 7️⃣ Severity & Priority Guidance

| Detection | Severity | Action |
|--------|---------|--------|
| BROAD only | Medium | Hunting / Monitor |
| STRICT | High | Incident Response |

---

## 8️⃣ Key Takeaway

> Privilege escalation is a **force multiplier** for attackers.
> Detecting and responding early prevents full domain compromise.

---

**Author**  
Adama ASSIONGBON – SOC & CTI Analyst Consultant
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

