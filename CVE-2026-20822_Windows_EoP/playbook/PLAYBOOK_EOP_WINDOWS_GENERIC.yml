playbook:
  name: Windows Privilege Escalation (EoP) â€“ Generic SOC Playbook
  description: >
    Generic, SOAR-agnostic playbook for handling Windows privilege escalation detections. Applicable to CVE-2026-20822 and similar EoP vulnerabilities.
  version: 1.0
  scope:
    platform: windows
    threat: privilege_escalation
    mitre_attack:
      - T1068

  triggers:
    - detection_type: sigma
      rule_level: BROAD
    - detection_type: sigma
      rule_level: STRICT

  workflow:

    - phase: triage
      soc_level: L1
      tasks:
        - id: T1
          name: Validate Alert
          actions:
            - Collect hostname
            - Collect username
            - Identify parent and child process
            - Check integrity level / execution context
          decision:
            condition: "STRICT rule triggered"
            next_phase: investigation
          else:
            next_phase: hunting

    - phase: hunting
      soc_level: L2
      tasks:
        - id: T2
          name: Context Enrichment
          actions:
            - Review process tree (last 60 minutes)
            - Check for service or scheduled task creation
            - Review PowerShell command-line arguments
        - id: T3
          name: Threat Assessment
          decision:
            condition: "Post-exploitation activity detected"
            next_phase: response
          else:
            next_phase: monitoring

    - phase: response
      soc_level: L3
      tasks:
        - id: T4
          name: Containment
          actions:
            - Isolate host
            - Disable compromised account
            - Terminate malicious processes
        - id: T5
          name: Eradication
          actions:
            - Remove persistence mechanisms
            - Delete malicious artifacts
            - Revoke credentials
        - id: T6
          name: Recovery
          actions:
            - Apply security patches
            - Reset passwords
            - Validate system integrity

    - phase: post_incident
      soc_level: L3
      tasks:
        - id: T7
          name: Lessons Learned
          actions:
            - Review detection effectiveness
            - Tune Sigma rules
            - Update SOC documentation

  severity_mapping:
    BROAD: medium
    STRICT: high

