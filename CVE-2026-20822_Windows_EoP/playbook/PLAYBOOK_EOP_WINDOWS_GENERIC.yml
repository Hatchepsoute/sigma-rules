playbook:
  metadata:
    name: Windows Privilege Escalation (EoP) â€“ Generic SOC Playbook
    version: 1.0
    status: draft
    description: >
      Generic SOAR-agnostic playbook for handling Windows privilege escalation detections. Applicable to CVE-2026-20822 and similar Windows EoP vulnerabilities.
    author: Adama ASSIONGBON
    audience:
      - SOC Tier 1
      - SOC Tier 2
      - SOC Tier 3
    language: en
    references:
      - https://nvd.nist.gov/vuln/detail/CVE-2026-20822
      - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20822
    mitre_attack:
      tactic: Privilege Escalation
      techniques:
        - T1068

  scope:
    platform: windows
    detection_sources:
      - sigma
      - edr
      - siem

  triggers:
    - id: TRG-01
      type: sigma
      rule_type: BROAD
      description: Suspicious privilege escalation behavior detected
    - id: TRG-02
      type: sigma
      rule_type: STRICT
      description: Successful privilege escalation to SYSTEM detected

  workflow:

    - phase:
        id: PH-01
        name: Initial Triage
        soc_level: L1
      tasks:
        - id: TSK-01
          name: Alert Validation
          objective: Confirm alert legitimacy
          actions:
            - Collect hostname
            - Collect username
            - Identify parent and child processes
            - Check execution integrity level
          decision:
            condition: "Trigger == STRICT"
            on_true: PH-02
            on_false: PH-01-HUNT

    - phase:
        id: PH-01-HUNT
        name: Hunting & Context
        soc_level: L2
      tasks:
        - id: TSK-02
          name: Context Enrichment
          actions:
            - Review process tree (last 60 minutes)
            - Check for service creation
            - Check for scheduled task creation
            - Review PowerShell command-line usage
        - id: TSK-03
          name: Threat Assessment
          decision:
            condition: "Post-exploitation activity detected"
            on_true: PH-03
            on_false: PH-04

    - phase:
        id: PH-02
        name: Investigation
        soc_level: L2
      tasks:
        - id: TSK-04
          name: Privilege Escalation Validation
          actions:
            - Confirm SYSTEM or High Integrity execution
            - Identify escalation vector
            - Identify affected user account
          decision:
            condition: "Malicious activity confirmed"
            on_true: PH-03
            on_false: PH-04

    - phase:
        id: PH-03
        name: Incident Response
        soc_level: L3
      tasks:
        - id: TSK-05
          name: Containment
          actions:
            - Isolate affected host
            - Disable compromised account
            - Terminate malicious processes
        - id: TSK-06
          name: Eradication
          actions:
            - Remove persistence mechanisms
            - Delete malicious artifacts
            - Revoke exposed credentials
        - id: TSK-07
          name: Recovery
          actions:
            - Apply missing security patches
            - Reset affected credentials
            - Validate system integrity

    - phase:
        id: PH-04
        name: Post-Incident & Monitoring
        soc_level: L3
      tasks:
        - id: TSK-08
          name: Lessons Learned
          actions:
            - Review detection effectiveness
            - Tune Sigma rules
            - Update SOC documentation
            - Record MTTR and impact

  severity_mapping:
    BROAD: medium
    STRICT: high

  outputs:
    - case_creation: optional
    - metrics:
        - mttr
        - false_positive_rate
        - detection_coverage

