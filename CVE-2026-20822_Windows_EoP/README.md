
ğŸ‘‰ğŸ¾ **French version here**: [README_FR.md](README_FR.md)
# CVE-2026-20822 â€“ Windows Privilege Escalation Detection (Sigma)
These rules are designed to detect the *outcome and behavior* of a privilege escalation, not a specific exploit implementation.

This directory contains **two complementary Sigma rules** designed to detect **Windows privilege escalation (EoP) behaviors** potentially associated with **CVE-2026-20822** or similar Windows EoP vulnerabilities.

The detection strategy is **behavior-based**, not exploit-dependent.

---

## ğŸ¯ Detection Objective

Windows EoP vulnerabilities are typically exploited **after an initial foothold** (phishing, malware execution, compromised account) to obtain **SYSTEM privileges**.

These rules aim to:
- detect **early suspicious behaviors** linked to EoP attempts (**BROAD**)
- confirm a **successful privilege escalation** (**STRICT**)

###  Why two rules?
> - BROAD provides visibility and hunting capability
> - STRICT confirms a successful privilege escalation

---

## ğŸ§  Attack Scenario Covered

### Step 1 : Initial Access
An attacker gains user-level access through:
- phishing
- malicious document
- malware loader
- compromised credentials

---

### Step 2 : Suspicious Behavior (BROAD Rule  ğŸ‘‰ğŸ¾ process_creation_win_eop_cve_2026_20822_broad.yml)

The attacker attempts to escalate privileges by executing administrative or scripting binaries from a **user-context application**.

Examples:
- `winword.exe â†’ powershell.exe`
- `explorer.exe â†’ cmd.exe`
- `chrome.exe â†’ sc.exe`

ğŸ‘‰ğŸ¾ This activity is detected by the **BROAD rule**   => process_creation_win_eop_cve_2026_20822_broad.yml.

**Purpose**:
- visibility
- threat hunting
- early warning

---

### Step 3 : Successful Privilege Escalation (STRICT Rule  ğŸ‘‰ğŸ¾process_creation_win_eop_cve_2026_20822_strict.yml)

The attacker successfully escalates privileges and spawns a process running as **SYSTEM or High Integrity** from a **user-context parent**.

Examples:
- user application â†’ `cmd.exe` running as SYSTEM
- Office process â†’ `powershell.exe` with SYSTEM privileges

ğŸ‘‰ğŸ¾ This pattern is detected by the **STRICT rule**  =>process_creation_win_eop_cve_2026_20822_strict.yml.

**Purpose**:
- high-confidence alert
- incident response trigger

---

## ğŸŸ  Rule 1 : BROAD ğŸ‘‰ğŸ¾ process_creation_win_eop_cve_2026_20822_broad.yml

**Role**
- Visibility & threat hunting
- Detects suspicious but non-conclusive EoP-related behaviors

**Characteristics**
- Higher noise
- Medium severity
- Should not trigger IR alone

---

## ğŸ”´ Rule 2 : STRICT ğŸ‘‰ğŸ¾process_creation_win_eop_cve_2026_20822_strict.yml

**Role**
- Confirmed privilege escalation detection
- High-confidence alerting

**Characteristics**
- Low false positives after tuning
- High severity
- Immediate SOC response recommended

---


## ğŸ§© Recommended SOC Usage

| Rule | Usage |
|---|---|
| BROAD | Hunting, dashboards, pivoting |
| STRICT | Alerting, incident response |

Both rules are designed to be used **together**:
- BROAD increases visibility
- STRICT provides confirmation

---

## ğŸ› ï¸ Tuning Notes

- Exclude legitimate:
  - EDR agents
  - endpoint management tools (SCCM, Intune, etc.)
- Adjust parent/child process lists to your environment

---

## ğŸ“ References

- https://nvd.nist.gov/vuln/detail/CVE-2026-20822  
- https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20822  

---

**Author :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

