# README.md (EN)

# CVE-2026-21509 — Microsoft Office Security Feature Bypass

## Overview

This repository provides a **single, high-confidence Sigma detection rule** for **CVE-2026-21509**, a Microsoft Office vulnerability that allows attackers to **bypass built-in OLE/COM security protections** using untrusted inputs.

Unlike traditional Office exploit detections that rely on multiple noisy indicators, this project intentionally focuses on **one strict and deterministic signal** explicitly documented by Microsoft.

---

## Detection Logic (Final Diagram)

```mermaid
graph TD
    A[Windows Registry Event] --> B{Access to COM CLSID?}

    B -- "{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}" --> C[Security Invariant Violated]

    C --> D[[HIGH CONFIDENCE ALERT]]

    subgraph Context
        D --> E[CVE-2026-21509]
        D --> F[OLE / COM Security Feature Bypass]
        D --> G[Unexpected CLSID Access<br/>(Post-Patch or Post-Mitigation)]
    end
```

This diagram illustrates that **any access to the vulnerable CLSID represents a violation of a Microsoft security invariant** on patched or mitigated systems.

---

## Why only ONE detection rule?

Microsoft explicitly identifies the **core technical indicator** of this vulnerability:

- A **specific COM CLSID** `{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}`
- Referenced in Microsoft advisories
- Used in public proof-of-concept exploits
- Explicitly blocked via the official COM Compatibility kill-bit

On a protected system, **this CLSID must never be accessed**.

As a result, monitoring this single signal provides a **low-noise, high-confidence detection** of exploitation attempts.

---

## Included Content

```text
CVE-2026-21509_Microsoft_Office_Security_Feature_Bypass/
├── rules/
│   └── office_com_clsid_security_feature_bypass_cve_2026_21509.yml
├── playbook/
│   └── Playbook_CVE-2026-21509_Generic.yml
├── README.md
└── README_FR.md
```

---

## References

- Microsoft Security Advisory: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509
- CVE Record: https://www.cve.org/CVERecord?id=CVE-2026-21509
- Public PoC: https://github.com/Ashwesker/Ashwesker-CVE-2026-21509

---

# README_FR.md (FR)

# CVE-2026-21509 — Contournement des mécanismes de sécurité Microsoft Office

## Présentation

Ce dépôt fournit **une règle Sigma unique, stricte et à forte confiance** pour la vulnérabilité **CVE-2026-21509**, affectant Microsoft Office.

Cette vulnérabilité permet à un attaquant de **contourner les protections OLE/COM** via un document Office piégé nécessitant une interaction utilisateur.

---

## Logique de détection (Diagramme final)

```mermaid
graph TD
    A[Événement Registre Windows] --> B{Accès à un CLSID COM ?}

    B -- "{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}" --> C[Violation d’un invariant de sécurité]

    C --> D[[ALERTE À FORTE CONFIANCE]]

    subgraph Contexte
        D --> E[CVE-2026-21509]
        D --> F[Contournement des protections OLE / COM]
        D --> G[Accès CLSID anormal<br/>(Post-correctif ou post-mitigation)]
    end
```

Ce diagramme montre que **tout accès à ce CLSID constitue une anomalie critique** sur un système corrigé ou correctement mitigé.

---

## Pourquoi une seule règle de détection ?

Microsoft identifie clairement **l’indicateur technique central** de cette vulnérabilité :

- Un **CLSID COM spécifique** `{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B}`
- Mentionné dans l’avis MSRC
- Utilisé dans les PoC publics
- Bloqué officiellement via un kill-bit COM Compatibility

Sur un système protégé, **ce CLSID ne doit jamais être sollicité**.

Il s’agit donc d’un cas rare où **une seule règle de détection est suffisante, robuste et défendable**.

---

## Références

- Avis de sécurité Microsoft : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-21509
- Fiche CVE : https://www.cve.org/CVERecord?id=CVE-2026-21509
- Preuve de concept publique : https://github.com/Ashwesker/Ashwesker-CVE-2026-21509

