# CVE-2026-20822 â€“ Windows Privilege Escalation Detection (Sigma)

ðŸ‘‰ðŸ¾ **French version here**: [README_FR.md](README_FR.md)

This directory provides a **behavior-based detection package** for identifying Windows privilege escalation (EoP) activity potentially associated with **CVE-2026-20822** and similar vulnerabilities.

The detection logic focuses on **observable outcomes and behaviors**, not on a specific exploit implementation.

---

## ðŸ“Š Technical Exploitation Flow

This diagram illustrates the exploitation path and where the Sigma rules (**BROAD vs STRICT**) trigger during the attack.

```mermaid
sequenceDiagram
    participant UserApp as User Process (Low Integrity)
    participant Exploit as Payload (Exploit CVE-2026-20822)
    participant Kernel as Windows Kernel / Win32k.sys
    participant System as NT AUTHORITY\\SYSTEM

    Note over UserApp: 1. Entry Vector
    UserApp->>Exploit: Malicious code execution in memory

    rect rgb(255, 243, 224)
    Note right of UserApp: SIGMA DETECTION: "BROAD"
    Note over Exploit: 2. Technical Preparation
    Exploit->>Exploit: Memory Allocation (Heap Spray / RW Primitive)
    end

    Note over Exploit, Kernel: 3. Triggering Vulnerability
    Exploit->>Kernel: Corrupted Syscall / Buffer Overflow
    Kernel-->>Exploit: Memory Violation or Pointer Corruption

    Note over Exploit, Kernel: 4. Token Manipulation
    Exploit->>Kernel: Arbitrary Write to Kernel Memory
    Note right of Kernel: Replaces Process Security Token<br/>with SYSTEM Token

    rect rgb(255, 204, 204)
    Note over Exploit, System: 5. Privileged Execution
    Exploit->>System: Spawns new Shell (cmd/powershell)
    Note right of System: SIGMA DETECTION: "STRICT"
    end

    System-->>UserApp: Full Machine Control
```

---

## ðŸŸ  Rule 1 - BROAD

- **File:** [process_creation_win_eop_cve_2026_20822_broad.yml](./rules/process_creation_win_eop_cve_2026_20822_broad.yml)
- **Objective:** Detects early-stage activity where common user applications spawn administrative or scripting binaries.

---

## ðŸ”´ Rule 2 - STRICT

- **File:** [process_creation_win_eop_cve_2026_20822_strict.yml](./rules/process_creation_win_eop_cve_2026_20822_strict.yml)
- **Objective:** Detects with a high level of confidence a successful exploitation where a user process spawns a child with SYSTEM privileges or high integrity.

---

## ðŸ§© Recommended SOC Usage

- **BROAD Rule:** Use for threat hunting and visibility. It may generate false positives from power users but catches exploitation attempts early.
- **STRICT Rule:** Use for high-priority alerting. If this rule triggers, it is highly likely that the system has been compromised with administrative rights.

![CVE-2026-20822_Windows_EoP_Detection_Overview.png](./CVE-2026-20822_Windows_EoP_Detection_Overview.png)

---

## ðŸ”— External Resources

- **NVD â€“ CVE-2026-20822 Details:** https://nvd.nist.gov/vuln/detail/CVE-2026-20822
- **Microsoft Security Update Guide:** https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20822

---

**Author**  
Adama ASSIONGBON â€“ SOC & CTI Analyst Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
