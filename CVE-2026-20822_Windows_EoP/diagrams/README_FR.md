üëâüèæ **English version available here**: [README.md](README.md)
# CVE-2026-20822 ‚Äì D√©tection d'√âl√©vation de Privil√®ges Windows (Sigma)

Ce r√©pertoire propose un **package de d√©tection bas√© sur le comportement** pour identifier les activit√©s d'√©l√©vation de privil√®ges (EoP) Windows potentiellement associ√©es √† la **CVE-2026-20822**.

---

## üìä Flux Technique de l'Exploitation

Ce diagramme illustre le chemin d'attaque et les points d'activation des r√®gles Sigma (BROAD vs STRICT).

```mermaid
sequenceDiagram
    participant UserApp as Processus Utilisateur (Int√©grit√© Moyenne)
    participant Exploit as Payload (Exploit CVE-2026-20822)
    participant Kernel as Windows Kernel / Win32k.sys
    participant System as NT AUTHORITY\SYSTEM

    Note over UserApp: 1. Vecteur d'entr√©e
    UserApp->>Exploit: Ex√©cution du code malveillant en m√©moire
    
    rect rgb(255, 243, 224)
    Note right of UserApp: D√âTECTION SIGMA : "BROAD"
    Note over Exploit: 2. Pr√©paration Technique
    Exploit->>Exploit: Allocation m√©moire (Heap Spray / Primitive RW)
    end

    Note over Exploit, Kernel: 3. D√©clenchement de la Faille
    Exploit->>Kernel: Appel Syst√®me (Syscall) corrompu
    Kernel-->>Exploit: Violation de m√©moire ou corruption de pointeur
    
    Note over Exploit, Kernel: 4. Manipulation de Token
    Exploit->>Kernel: √âcriture arbitraire en m√©moire Kernel
    Note right of Kernel: Remplace le Token de s√©curit√© du processus <br/>par un Token SYSTEM

    rect rgb(255, 204, 204)
    Note over Exploit, System: 5. Ex√©cution Privil√©gi√©e
    Exploit->>System: G√©n√®re un nouveau Shell (cmd/powershell)
    Note right of System: D√âTECTION SIGMA : "STRICT"
    end

    System-->>UserApp: Contr√¥le Total de la Machine ```
    
# üü† R√®gle 1 - BROAD (Large)

- **Fichier :** [process_creation_win_eop_cve_2026_20822_broad.yml](./rules/process_creation_win_eop_cve_2026_20822_broad.yml)
- **Objectif :** D√©tecte l'activit√© en phase initiale o√π des applications utilisateur courantes g√©n√®rent des outils d'administration ou de script.

# üî¥ R√®gle 2 - STRICT

- **Fichier :** [process_creation_win_eop_cve_2026_20822_strict.yml](./rules/process_creation_win_eop_cve_2026_20822_strict.yml) 
- **Objectif :** D√©tecte avec un haut niveau de confiance une exploitation r√©ussie o√π un processus utilisateur g√©n√®re un enfant avec des privil√®ges SYSTEM ou une int√©grit√© √©lev√©e.

# üß© Utilisation Recommand√©e pour le SOC

* **R√®gle BROAD :** √Ä utiliser pour le Threat Hunting et la visibilit√©. Elle peut g√©n√©rer des faux positifs chez les utilisateurs avanc√©s mais permet de d√©tecter les tentatives d'exploitation tr√®s t√¥t.
* **R√®gle STRICT :** √Ä utiliser pour l'Alerte Haute Priorit√©. Si cette r√®gle se d√©clenche, il est fort probable que le syst√®me soit compromis avec des droits administratifs.

![CVE-2026-20822_Windows_EoP_Detection_Overview.png](./CVE-2026-20822_Windows_EoP_Detection_Overview.png)

###üîó Liens Utiles

- NVD - D√©tails CVE-2026-20822 [NVD - D√©tails CVE-2026-20822](https://nvd.nist.gov/vuln/detail/CVE-2026-20822)
- Guide des mises √† jour de s√©curit√© Microsoft  [Microsoft Security Update Guide](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20822)

* **Auteur :** Adama ASSIONGBON ‚Äì Consultant Analyste SOC & CTI

[Profil LinkedIn](https://www.linkedin.com/in/adama-assiongbon-9029893a/)
