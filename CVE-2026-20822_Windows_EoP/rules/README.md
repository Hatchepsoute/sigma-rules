# CVE-2026-20822 â€“ Windows Privilege Escalation Detection (Sigma)

ğŸ‘‰ğŸ¾ **French version here**: [README_FR.md](README_FR.md)

This directory provides a **behavior-based detection package** for identifying Windows privilege escalation (EoP) activity potentially associated with **CVE-2026-20822** and similar vulnerabilities.

The detection logic focuses on **observable outcomes and behaviors**, not on a specific exploit implementation.

---

## ğŸ¯ Detection Objective
Windows privilege escalation vulnerabilities are typically exploited **after initial access** to elevate privileges to **NT AUTHORITY\SYSTEM**.
This package aims to:
- detect **early suspicious EoP-related behaviors** (BROAD)
- confirm a **successful privilege escalation** (STRICT). 

---

## ğŸ§  Covered Attack Scenario

1. **Initial Access**
   - Phishing
   - Malicious document
   - Malware loader
   - Compromised user account

2. **Suspicious Activity (BROAD Rule)** ğŸ‘‰ğŸ¾ [process_creation_win_eop_cve_2026_20822_broad.yml](./process_creation_win_eop_cve_2026_20822_broad.yml)
   - A user-context application spawns an administrative or scripting binary  
     Examples:  
     `winword.exe â†’ powershell.exe`  
     `explorer.exe â†’ cmd.exe`

3. **Privilege Escalation Confirmed (STRICT Rule)** ğŸ‘‰ğŸ¾ [process_creation_win_eop_cve_2026_20822_strict.yml](./process_creation_win_eop_cve_2026_20822_strict.yml)
   - A process spawned from a user context executes as:
     - `NT AUTHORITY\SYSTEM`
     - High Integrity

---

## ğŸŸ  Rule 1 â€“ BROAD
**File** : [process_creation_win_eop_cve_2026_20822_broad.yml](process_creation_win_eop_cve_2026_20822_broad.yml)
* **Objective** : Detects early-stage activity where common user applications spawn administrative or scripting binaries.
**Purpose**
- Increase visibility
- Support threat hunting
- Detect suspicious but non-conclusive behavior

**Characteristics**
- Medium confidence
- Potential noise
- Not sufficient alone for incident response

---

## ğŸ”´ Rule 2 â€“ STRICT
**File** : [process_creation_win_eop_cve_2026_20822_strict.yml](process_creation_win_eop_cve_2026_20822_strict.yml)
**Objective**: Detects with a high level of confidence a successful exploitation where a user process spawns a child with **SYSTEM** privileges or high integrity.
* **Purpose :**
- Confirm successful privilege escalation
- Trigger high-confidence SOC alerts

**Characteristics**
- High confidence
- Low false-positive rate after tuning
- Requires immediate investigation

---

## ğŸ§© Recommended SOC Usage

- Use **BROAD** for visibility and hunting
- Use **STRICT** for alerting and incident response
- Use both rules together for optimal coverage
---

### ğŸ”— External Resources
* [NVD - CVE-2026-20822 Details](https://nvd.nist.gov/vuln/detail/CVE-2026-20822)
* [Microsoft Security Update Guide](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20822)
**Author**  
Adama ASSIONGBON â€“ SOC & CTI Analyst Consultant
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)


