%% CVE-2026-20841 Attaque → Détection → Réponse (FR) | 2026-02-17
flowchart TD
  A0["CVE-2026-20841 : Lien Markdown Notepad → Exécution de commande potentielle"]

  subgraph ATTAQUE["Chaîne d'attaque"]
    A1["Livraison : fichier .md malveillant (phishing / web / partage)"]
    A2["Ouverture du fichier dans Notepad"]
    A3["Clic utilisateur sur un lien Markdown malveillant"]
    A4["Abus d'un handler de protocole / invocation URL"]
    A5["Exécution : Notepad lance un processus enfant"]
    A6["Actions : download / exécution / C2 / persistance"]
    A1 --> A2 --> A3 --> A4 --> A5 --> A6
  end

  subgraph DETECTION["Stratégie de détection"]
    D1["BROAD (Hunting) : Notepad → Interpréteur/LOLBIN (cmd, powershell, mshta, rundll32, regsvr32)"]
    D2["STRICT (Alerting) : BROAD + CommandLine suspecte (http/https, -enc, IEX, DownloadString, patterns url.dll)"]
    D3["Corrélation : Réseau + DNS/Proxy + comportements de suite"]
    D1 --> D2 --> D3
  end

  subgraph REPONSE["Réponse SOC"]
    R1["Triage : valider l'arbre de processus + contexte utilisateur"]
    R2["Investigation : origine du fichier (.md), timeline, hash, signatures"]
    R3["Confinement : isoler l'hôte si confirmé + stopper les processus"]
    R4["Éradication : supprimer artefacts + persistance ; reset comptes si besoin"]
    R5["Récupération : validation patch + monitoring renforcé"]
    R6["Retour d'expérience : tuner BROAD ; garder STRICT pour l'alerte"]
    R1 --> R2 --> R3 --> R4 --> R5 --> R6
  end

  A0 --> ATTAQUE
  A5 --> D1
  D2 --> R1
  D3 --> R2
