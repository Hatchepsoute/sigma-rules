%% CVE-2026-20841 Attack → Detection → Response (EN) | 2026-02-17
flowchart TD
  A0["CVE-2026-20841: Notepad Markdown Link → Potential Command Execution"]

  subgraph ATTACK["Attack Flow"]
    A1["Delivery: Malicious .md file (phishing / web / share)"]
    A2["User opens file in Notepad"]
    A3["User clicks malicious Markdown link"]
    A4["Protocol handler / URL invocation abused"]
    A5["Command execution: Notepad spawns child process"]
    A6["Payload actions: download / execute / C2 / persistence"]
    A1 --> A2 --> A3 --> A4 --> A5 --> A6
  end

  subgraph DETECTION["Detection Strategy"]
    D1["BROAD (Hunting): Notepad → Interpreter/LOLBIN (cmd, powershell, mshta, rundll32, regsvr32)"]
    D2["STRICT (Alerting): BROAD + suspicious CommandLine (http/https, -enc, IEX, DownloadString, url.dll patterns)"]
    D3["Correlation: Network + DNS/Proxy + follow-on behaviors"]
    D1 --> D2 --> D3
  end

  subgraph RESPONSE["SOC Response"]
    R1["Triage: Validate process tree + user context"]
    R2["Investigate: file origin (.md), timeline, hashes, signatures"]
    R3["Contain: isolate host if confirmed + terminate malicious processes"]
    R4["Eradicate: remove artifacts + persistence; reset credentials if needed"]
    R5["Recover: patch validation + monitoring"]
    R6["Lessons learned: tune BROAD filters; keep STRICT for alerting"]
    R1 --> R2 --> R3 --> R4 --> R5 --> R6
  end

  A0 --> ATTACK
  A5 --> D1
  D2 --> R1
  D3 --> R2
