# üìä Table de d√©cision ‚Äì CVE-2026-20841 (Notepad ‚Üí Ex√©cution de commande)

üëâüèæ **[English version available here](./DECISION_TABLE_CVE-2026-20841_EN_ALIGNED.md)**

Cette table aide un SOC √† d√©cider **quand alerter**, **quand hunter**, et **comment tuner** les deux r√®gles Sigma (**BROAD** vs **STRICT**).

## 1) Table de d√©cision de d√©tection

| Niveau | Usage | D√©clencheur (ce qui est d√©tect√©) | Confiance | Action SOC typique | Niveau recommand√© |
|---|---|---|---|---|---|
| **BROAD** | Hunting / early warning | `notepad.exe` lance des interpr√©teurs / LOLBins courants | Moyenne | Ajouter aux dashboards hunting ; pivoter sur user/host ; rechercher des signaux de suite | **Medium** |
| **STRICT** | Alerting / Incident | `notepad.exe` lance un interpr√©teur **ET** la `CommandLine` contient des indicateurs forts (`http/https`, `-enc`, `IEX`, `DownloadString`, patterns `url.dll`) | √âlev√©e | D√©clencher une alerte + triage ; confirmer l‚Äôaction utilisateur ; isoler l‚Äôh√¥te si signaux additionnels | **High** |

## 2) Sources de donn√©es & champs

| Source | Utilit√© | Champs cl√©s √† valider |
|---|---|---|
| Sysmon (Event ID 1) | Meilleure visibilit√© processus | `Image`, `ParentImage`, `CommandLine`, `OriginalFileName`, `User`, `ProcessGuid`, `ParentProcessGuid` |
| Windows Security (4688) | Disponible partout | `NewProcessName`/`Image`, `ParentProcessName`, `CommandLine`, `SubjectUserName` |
| T√©l√©m√©trie EDR | Enrichissement + r√©ponse | Lign√©e de processus, statut de signature, √©v√©nements r√©seau, √©v√©nements fichiers |
| Sysmon (Event ID 3) / R√©seau EDR | Corr√©lation | `DestinationIp`, `DestinationHostname`, `DestinationPort`, `Initiated` |
| DNS / Proxy | Confirmer la r√©cup√©ration distante | `Query`, `Url`, `User-Agent`, `Bytes` |

## 3) Playbook de triage (rapide)

| √âtape | V√©rifier | Pourquoi |
|---|---|---|
| 1 | Cha√Æne parent/enfant : Notepad ‚Üí processus enfant | Valide le d√©clenchement |
| 2 | `CommandLine` (STRICT) : `http`, `-enc`, `IEX`, `DownloadString`, `url.dll` | Indicateurs forts d‚Äôexploitation |
| 3 | Identifier le fichier ouvert (ex: `.md`) et son origine (email/web/partage) | Confirme la livraison initiale |
| 4 | Corr√©ler avec les sorties r√©seau juste apr√®s | Confirme r√©cup√©ration payload / C2 |
| 5 | Rechercher la suite (t√¢ches planifi√©es, service, persistance) | Post‚Äëexploitation |

## 4) Faux positifs & tuning

| Niveau | Faux positifs fr√©quents | Conseils de tuning |
|---|---|---|
| **BROAD** | Admin/dev lan√ßant des scripts ; red team | Ajouter `filter_*` sur users/hosts connus ; exclure jump-box dev ; cibler postes utilisateurs |
| **STRICT** | Rare : automation interne approuv√©e ; red team | Conserver indicateurs `CommandLine` ; allowlist domaines/URLs internes ; exclure scripts admin connus |

## 5) Alignement MITRE ATT&CK

- **T1204** ‚Äì User Execution  
- **T1059** ‚Äì Command and Scripting Interpreter  
- **T1218** ‚Äì Signed Binary Proxy Execution  

## R√©f√©rences

- MSRC : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841  
- NVD : https://nvd.nist.gov/vuln/detail/CVE-2026-20841  
- Threat Landscape : https://threatlandscape.io/blog/vulnerability-spotlight-cve-2026-20841#potential-exploitation-chain  

