# üìä Decision Table -- CVE-2026-20841 (Notepad ‚Üí Command Execution)

üëâüèæ [**French version available here**](DECISION_TABLE_CVE-2026-20841_FR.md)

This table helps SOC teams decide **when to alert**, **when to hunt** and **how to tune** the two Sigma rules (BROAD vs STRICT).

------------------------------------------------------------------------

## 1) Detection Decision Table

  -------------------------------------------------------------------------------------
  Layer        Intended   Trigger (What You   Confidence   Typical SOC    Recommended
               Use        Detect)                          Action         Level
  ------------ ---------- ------------------- ------------ -------------- -------------
  **BROAD**    Hunting /  `notepad.exe`       Medium       Add to hunting **Medium**
               Early      spawns common                    dashboards;    
               warning    interpreters /                   pivot on       
                          LOLBins                          user/host;     
                                                           look for       
                                                           follow-on      
                                                           activity       

  **STRICT**   Alerting / `notepad.exe`       High         Raise alert +  **High**
               Incident   spawns interpreter               triage;        
                          **AND**                          confirm user   
                          command-line shows               action;        
                          strong malicious                 isolate if     
                          indicators                       additional     
                          (http/https, -enc,               signals        
                          IEX,                             present        
                          DownloadString,                                 
                          url.dll handler                                 
                          patterns)                                       
  -------------------------------------------------------------------------------------

------------------------------------------------------------------------

## 2) Data Sources & Fields

  -----------------------------------------------------------------------
  Data Source       Needed For        Key Fields to Validate
  ----------------- ----------------- -----------------------------------
  Sysmon (EID 1)    Best process      `Image`, `ParentImage`,
                    visibility        `CommandLine`, `OriginalFileName`,
                                      `User`, `ProcessGuid`,
                                      `ParentProcessGuid`

  Windows Security  Baseline          `NewProcessName/Image`,
  (4688)            availability      `ParentProcessName`, `CommandLine`,
                                      `SubjectUserName`

  EDR Telemetry     Enrichment +      `Process lineage`, `Signed status`,
                    response          `Network events`, `File events`

  Sysmon (EID 3) /  Correlation       `DestinationIp`,
  EDR Network                         `DestinationHostname`,
                                      `DestinationPort`, `Initiated`

  DNS logs / Proxy  Confirm remote    `Query`, `Url`, `User-Agent`,
                    retrieval         `Bytes`
  -----------------------------------------------------------------------

------------------------------------------------------------------------

## 3) Triage Playbook (Quick)

  -----------------------------------------------------------------------------
  Step             What to Check                            Why
  ---------------- ---------------------------------------- -------------------
  1                Confirm parent-child chain: Notepad ‚Üí    Validates rule
                   child process                            trigger

  2                Inspect `CommandLine` (STRICT) for       Strong exploitation
                   `http`, `-enc`, `IEX`, `DownloadString`, indicators
                   `url.dll`                                

  3                Identify the opened file (`.md`) and     Confirms initial
                   origin (email/web/share)                 delivery

  4                Correlate with network events (outbound  Confirms payload
                   shortly after)                           retrieval / C2

  5                Check follow-on behaviors (new scheduled Post-exploitation
                   task, service, persistence)              detection
  -----------------------------------------------------------------------------

------------------------------------------------------------------------

## 4) False Positives & Tuning Guidance

  --------------------------------------------------------------------------
  Layer        Common False Positives                    Tuning Tips
  ------------ ----------------------------------------- -------------------
  **BROAD**    Admin/dev launching scripts manually; red Add `filter_*` for
               team                                      known tool
                                                         paths/users;
                                                         exclude dev
                                                         jump-boxes;
                                                         restrict to user
                                                         workstations

  **STRICT**   Rare: internal automation launching       Keep `CommandLine`
               remote script; red team                   indicators; add
                                                         allowlists for
                                                         approved internal
                                                         URLs/domains;
                                                         exclude known admin
                                                         scripts
  --------------------------------------------------------------------------

------------------------------------------------------------------------

## 5) MITRE ATT&CK Alignment

-   **T1204** -- User Execution\
-   **T1059** -- Command and Scripting Interpreter\
-   **T1218** -- Signed Binary Proxy Execution

------------------------------------------------------------------------

## References

-   MSRC:
    https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841\
-   NVD: https://nvd.nist.gov/vuln/detail/CVE-2026-20841\
-   Threat Landscape:
    https://threatlandscape.io/blog/vulnerability-spotlight-cve-2026-20841#potential-exploitation-chain
