# üìä Decision Table ‚Äì CVE-2026-20841 (Notepad ‚Üí Command Execution)

üëâüèæ **[French version available here](./DECISION_TABLE_CVE-2026-20841_FR_ALIGNED.md)**

This decision table helps SOC teams decide **when to alert**, **when to hunt**, and **how to tune** the two Sigma rules (**BROAD** vs **STRICT**).

## 1) Detection Decision Table

| Layer | Intended Use | Trigger (What You Detect) | Confidence | Typical SOC Action | Recommended Level |
|---|---|---|---|---|---|
| **BROAD** | Hunting / Early warning | `notepad.exe` spawns common interpreters / LOLBins | Medium | Add to hunting dashboards; pivot on user/host; look for follow‚Äëon activity | **Medium** |
| **STRICT** | Alerting / Incident | `notepad.exe` spawns interpreter **AND** `CommandLine` shows strong malicious indicators (`http/https`, `-enc`, `IEX`, `DownloadString`, `url.dll` handler patterns) | High | Raise alert + triage; confirm user action; isolate host if additional signals are present | **High** |

## 2) Data Sources & Fields

| Data Source | Needed For | Key Fields to Validate |
|---|---|---|
| Sysmon (Event ID 1) | Best process visibility | `Image`, `ParentImage`, `CommandLine`, `OriginalFileName`, `User`, `ProcessGuid`, `ParentProcessGuid` |
| Windows Security (4688) | Baseline availability | `NewProcessName`/`Image`, `ParentProcessName`, `CommandLine`, `SubjectUserName` |
| EDR Telemetry | Enrichment + response | Process lineage, signature status, network events, file events |
| Sysmon (Event ID 3) / EDR Network | Correlation | `DestinationIp`, `DestinationHostname`, `DestinationPort`, `Initiated` |
| DNS logs / Proxy | Confirm remote retrieval | `Query`, `Url`, `User-Agent`, `Bytes` |

## 3) Triage Playbook (Quick)

| Step | What to Check | Why |
|---|---|---|
| 1 | Confirm parent‚Äëchild chain: Notepad ‚Üí child process | Validates rule trigger |
| 2 | Inspect `CommandLine` (STRICT) for `http`, `-enc`, `IEX`, `DownloadString`, `url.dll` | Strong exploitation indicators |
| 3 | Identify the opened file (e.g., `.md`) and its origin (email/web/share) | Confirms initial delivery |
| 4 | Correlate with outbound network events shortly after | Confirms payload retrieval / C2 |
| 5 | Check follow‚Äëon behaviors (scheduled task, service, persistence) | Post‚Äëexploitation detection |

## 4) False Positives & Tuning Guidance

| Layer | Common False Positives | Tuning Tips |
|---|---|---|
| **BROAD** | Admin/dev launching scripts manually; red team | Add `filter_*` for known users/hosts; exclude dev jump boxes; scope to workstations |
| **STRICT** | Rare: approved internal automation; red team | Keep strong `CommandLine` indicators; allowlist approved internal domains/URLs; exclude known admin scripts |

## 5) MITRE ATT&CK Alignment

- **T1204** ‚Äì User Execution  
- **T1059** ‚Äì Command and Scripting Interpreter  
- **T1218** ‚Äì Signed Binary Proxy Execution  

## References

- MSRC: https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841  
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2026-20841  
- Threat Landscape: https://threatlandscape.io/blog/vulnerability-spotlight-cve-2026-20841#potential-exploitation-chain  

