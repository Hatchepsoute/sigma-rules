title: Notepad Triggering Suspicious Command Execution - CVE-2026-20841 (Strict Alert)
id: 2c5d6f39-5b6c-4a79-a4f1-6e7df9a2d901
status: experimental
description: >
  High-confidence detection of suspicious command execution spawned by Notepad, potentially linked to exploitation of CVE-2026-20841. Detects command-line indicators consistent with remote payload execution or encoded PowerShell usage.
  
   FR=> Détection à haut niveau de confiance d'exécutions de commandes suspectes issues du processus Notepad, potentiellement liées à l'exploitation de la CVE-2026-20841. Identifie les indicateurs en ligne de commande caractéristiques d'une exécution de payload à distance ou d'un usage de PowerShell obfusqué (encodé).
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2026-20841
  - https://nvd.nist.gov/vuln/detail/CVE-2026-20841
  - https://threatlandscape.io/blog/vulnerability-spotlight-cve-2026-20841#potential-exploitation-chain
author: Adama ASSIONGBON  - SOC & CTI  Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-02-17 
logsource:
  category: process_creation
  product: windows
detection:
  selection_parent:
    ParentImage|endswith:
      - '\notepad.exe'

  selection_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\mshta.exe'
      - '\rundll32.exe'

  selection_cli_suspicious:
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - '-enc'
      - 'EncodedCommand'
      - 'FromBase64String'
      - 'IEX'
      - 'DownloadString'
      - 'url.dll,FileProtocolHandler'
      - '.ps1'
      - '.hta'

  condition: selection_parent and selection_child and selection_cli_suspicious

falsepositives:
  - Extremely rare legitimate administrative use launching remote scripts from Notepad
  - Red team simulation
level: high
tags:
  - attack.execution
  - attack.t1204
  - attack.t1059
  - attack.t1218
  - attack.command-and-control
    - cve.2026-20841

