# Detection & Response Kit - CVE-2025-10230 (Samba WINS Hook)

## ðŸ“‹ Overview
This kit provides SOC-ready resources to **detect and respond** to exploitation attempts of **CVE-2025-10230**, a critical **remote command injection vulnerability** in Samba when configured with a WINS hook.

**CVSS 3.1 Score: 10.0 (CRITICAL)**

Targeted systems:
- Samba Active Directory Domain Controllers
- Linux servers with WINS enabled and `wins hook` configured

---

## ðŸŽ¯ Detection Strategy

This package intentionally relies on **only two Sigma rules** to ensure:
- Very low false positives
- Reliable detection during real attacks **and pentests**
- High-confidence, host-based evidence

| Rule | Role |
|---|---|
| **STRICT** | Proof of exploitation (RCE confirmed) |
| **SUPPORT** | Exposure & posture detection |

---

## ðŸ” Sigma Rules

### 1. STRICT - Samba spawning a shell
- Detects Samba daemons (`smbd`, `nmbd`, `winbindd`) spawning a shell
- Indicates **confirmed remote command execution**
- Severity: **Critical**
- SOC action: **Immediate Incident Response**

### 2. SUPPORT - Risky Samba configuration
- Detects `wins support = yes` combined with `wins hook`
- Indicates **exploitable configuration**
- Severity: **Medium**
- SOC action: **Preventive remediation**

---
## ðŸ“Š SOC Diagrams

This package includes visual SOC workflows to support analysts, incident responders,
and security leadership in understanding the detection and response logic.

Available diagrams (PNG & SVG):

- **SOC Detection Overview**: `diagrams/SOC.png`
- **SOC Response Flow (EN)**:  
  - `diagrams/SOC_Response_Flow_EN.png`  
  - `diagrams/SOC_Response_Flow_EN.svg`
- **SOC Response Flow (FR)**:  
  - `diagrams/SOC_Response_Flow_FR.png`  
  - `diagrams/SOC_Response_Flow_FR.svg`

These diagrams illustrate:
- The relationship between **STRICT** and **SUPPORT** Sigma rules
- SOC decision points (triage, escalation, incident confirmation)
- Incident response flow aligned with the provided playbooks


## ðŸš¨ TheHive Playbook

The package includes a **generic TheHive Incident Response playbook**, aligned with NIST IR phases:
1. Initial triage
2. Containment
3. Investigation
4. Eradication
5. Recovery & lessons learned

---

## ðŸ›¡ï¸ Mitigation Recommendations

- Patch Samba immediately (vendor security release)
- Disable WINS if not strictly required
- Remove `wins hook` configuration
- Restrict UDP/137 exposure
- Increase monitoring for 72 hours after remediation

---

## ðŸ“š References

- Samba Advisory: https://www.samba.org/samba/security/CVE-2025-10230.html
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2025-10230
- PoC (research only): https://github.com/dptsec/CVE-2025-10230
- MITRE ATT&CK: T1059.004, T1190

> âš ï¸ The referenced Proof of Concept (PoC) is provided **for research and detection validation purposes only**.  
> Detection logic does **not depend on the PoC implementation**.

---

**Author :** Adama ASSIONGBON â€“ SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

