name: "FR - Réponse à l'exploitation de CVE-2025-10230 (Samba WINS Hook)"
description: "Playbook générique pour répondre aux alertes liées à l'exploitation de CVE-2025-10230 (injection de commande via le hook WINS de Samba). Inclut vérification, confinement, éradication et restauration."
cortexId: "CORTEX-ID"
organization: "VOTRE-ORG"
createdBy: "Adama ASSIONGBON | SOC & CTI Analyst"
createdAt: 1739491200000
updatedAt: 1739577600000
data:
  - name: "1. TRIAGE INITIAL & CONFIRMATION"
    description: "Vérifier rapidement l'alerte et confirmer son authenticité."
    startDate: 1739577600000
    tasks:
      - title: "1.1 Examiner les logs de l'alerte"
        description: "Vérifier les logs source de l'alerte Sigma (process_creation ou file_event). Extraire les IPs, noms d'hôtes, commandes exécutées."
        flag: false
        order: 0
        status: "Waiting"
      - title: "1.2 Corréler avec les règles Sigma"
        description: "Identifier si l'alerte provient de la règle STRICT (shell spawn) ou SUPPORT (exposition). Une alerte STRICT est une priorité absolue."
        flag: false
        order: 1
        status: "Waiting"
      - title: "1.3 Vérifier la configuration Samba ciblée"
        description: "Sur le serveur suspecté, vérifier rapidement si 'wins support = yes' et 'wins hook' sont configurés dans /etc/samba/smb.conf."
        flag: false
        order: 2
        status: "Waiting"
      - title: "1.4 Notifier l'équipe d'intervention"
        description: "Si l'alerte est confirmée comme crédible, notifier immédiatement le responsable d'incident et l'équipe en charge des systèmes."
        flag: false
        order: 3
        status: "Waiting"
  - name: "2. CONTAINMENT IMMÉDIAT"
    description: "Actions rapides pour isoler la menace et empêcher sa propagation."
    startDate: 1739577600000
    tasks:
      - title: "2.1 Isoler le serveur compromis du réseau"
        description: "Sur le pare-feu ou le commutateur, bloquer toutes les connexions entrantes/sortantes vers l'IP du serveur Samba (sauf accès administrateur sécurisé)."
        flag: false
        order: 0
        status: "Waiting"
      - title: "2.2 Désactiver le service WINS/Samba"
        description: "Sur le serveur compromis, exécuter : 'systemctl stop smbd nmbd winbind' OU 'systemctl stop samba' (selon la distribution)."
        flag: false
        order: 1
        status: "Waiting"
      - title: "2.3 Capturer la mémoire et les artefacts volatils"
        description: "Si possible et sans compromettre la stabilité, capturer un dump mémoire avec 'LiME' ou 'avml' et une collecte rapide des processus avec 'ps auxf', connexions netstat."
        flag: false
        order: 2
        status: "Waiting"
  - name: "3. ÉRADICATION & ENQUÊTE FORENSIQUE"
    description: "Analyser l'étendue de la compromission, supprimer l'accès de l'attaquant et identifier la cause racine."
    startDate: 1739577600000
    tasks:
      - title: "3.1 Analyser les processus et connexions suspects"
        description: "Rechercher les processus enfants de samba/smbd persistants, connexions réseau inhabituelles, crontabs ou services nouvellement créés."
        flag: false
        order: 0
        status: "Waiting"
      - title: "3.2 Examiner les logs Samba et système"
        description: "Analyser /var/log/samba/*, auth.log, syslog autour de l'heure de l'alerte pour trouver la tentative d'injection et les commandes exécutées."
        flag: false
        order: 1
        status: "Waiting"
      - title: "3.3 Identifier et supprimer les artefacts malveillants"
        description: "Supprimer les fichiers déposés, les comptes utilisateurs non autorisés, les tâches cron ou systemd créées par l'attaquant."
        flag: false
        order: 2
        status: "Waiting"
      - title: "3.4 Changer tous les mots de passe de domaine"
        description: "Si le serveur est un contrôleur de domaine, considérer le changement des mots de passe des comptes privilégiés du domaine."
        flag: false
        order: 3
        status: "Waiting"
  - name: "4. RESTAURATION & RENFORCEMENT"
    description: "Remettre le système en production de manière sécurisée et appliquer les correctifs."
    startDate: 1739577600000
    tasks:
      - title: "4.1 Appliquer le correctif Samba"
        description: "Mettre à jour Samba vers la version sécurisée (>= 4.23.2, >= 4.22.5, >= 4.21.9) OU appliquer le correctif fourni par le distributeur."
        flag: false
        order: 0
        status: "Waiting"
      - title: "4.2 Réviser la configuration smb.conf"
        description: "Si le 'wins hook' n'est pas essentiel, le supprimer. Sinon, s'assurer qu'il appelle un script sécurisé et validé."
        flag: false
        order: 1
        status: "Waiting"
      - title: "4.3 Restaurer le système depuis une sauvegarde saine"
        description: "Si l'intégrité du système est douteuse, restaurer le serveur à partir d'une sauvegarde antérieure à l'incident, après avoir appliqué le correctif."
        flag: false
        order: 2
        status: "Waiting"
      - title: "4.4 Redémarrer les services et surveiller"
        description: "Redémarrer les services Samba et surveiller étroitement les logs pendant 24-48h pour détecter toute activité récurrente."
        flag: false
        order: 3
        status: "Waiting"
  - name: "5. CLÔTURE & RÉTROSPECTIVE"
    description: "Documenter l'incident, mettre à jour les procédures et partager les leçons apprises."
    startDate: 1739577600000
    tasks:
      - title: "5.1 Mettre à jour les règles de détection"
        description: "Si nécessaire, affiner les règles Sigma (filtres, whitelist) basées sur les faux positifs ou nouvelles IOCs découverts."
        flag: false
        order: 0
        status: "Waiting"
      - title: "5.2 Rédiger le rapport d'incident"
        description: "Documenter la chronologie, les actions entreprises, l'impact et les causes racines dans le format standard de l'organisation."
        flag: false
        order: 1
        status: "Waiting"
      - title: "5.3 Organiser une réunion rétrospective"
        description: "Discuter avec les équipes concernées (SOC, infra, sécurité) des améliorations à apporter aux processus."
        flag: false
        order: 2
        status: "Waiting"