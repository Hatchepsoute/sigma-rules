{
  "name": "EN - Response to CVE-2025-10230 Exploitation (Samba WINS Hook)",
  "description": "Generic playbook for responding to alerts related to the exploitation of CVE-2025-10230 (command injection via Samba WINS hook). Includes verification, containment, eradication, and recovery.",
  "cortexId": "CORTEX-ID",
  "organization": "YOUR-ORG",
  "createdBy": "Adama ASSIONGBON | SOC & CTI Analyst",
  "createdAt": 1739491200000,
  "updatedAt": 1739577600000,
  "data": [
    {
      "name": "1. INITIAL TRIAGE & CONFIRMATION",
      "description": "Quickly verify the alert and confirm its authenticity.",
      "startDate": 1739577600000,
      "tasks": [
        {
          "title": "1.1 Examine alert logs",
          "description": "Check the source logs of the Sigma alert (process_creation or file_event). Extract IPs, hostnames, executed commands.",
          "flag": false,
          "order": 0,
          "status": "Waiting"
        },
        {
          "title": "1.2 Correlate with Sigma rules",
          "description": "Identify if the alert comes from the STRICT (shell spawn) or SUPPORT (exposure) rule. A STRICT alert is a top priority.",
          "flag": false,
          "order": 1,
          "status": "Waiting"
        },
        {
          "title": "1.3 Check targeted Samba configuration",
          "description": "On the suspected server, quickly verify if 'wins support = yes' and 'wins hook' are configured in /etc/samba/smb.conf.",
          "flag": false,
          "order": 2,
          "status": "Waiting"
        },
        {
          "title": "1.4 Notify the response team",
          "description": "If the alert is confirmed as credible, immediately notify the incident manager and the systems team.",
          "flag": false,
          "order": 3,
          "status": "Waiting"
        }
      ]
    },
    {
      "name": "2. IMMEDIATE CONTAINMENT",
      "description": "Quick actions to isolate the threat and prevent its spread.",
      "startDate": 1739577600000,
      "tasks": [
        {
          "title": "2.1 Isolate the compromised server from the network",
          "description": "On the firewall or switch, block all incoming/outgoing connections to the Samba server IP (except secure admin access).",
          "flag": false,
          "order": 0,
          "status": "Waiting"
        },
        {
          "title": "2.2 Disable WINS/Samba service",
          "description": "On the compromised server, execute: 'systemctl stop smbd nmbd winbind' OR 'systemctl stop samba' (depending on distribution).",
          "flag": false,
          "order": 1,
          "status": "Waiting"
        },
        {
          "title": "2.3 Capture memory and volatile artefacts",
          "description": "If possible and without compromising stability, capture a memory dump with 'LiME' or 'avml' and a quick process collection with 'ps auxf', netstat connections.",
          "flag": false,
          "order": 2,
          "status": "Waiting"
        }
      ]
    },
    {
      "name": "3. ERADICATION & FORENSIC INVESTIGATION",
      "description": "Analyze the extent of the compromise, remove attacker access, and identify the root cause.",
      "startDate": 1739577600000,
      "tasks": [
        {
          "title": "3.1 Analyze suspicious processes and connections",
          "description": "Look for persistent child processes of samba/smbd, unusual network connections, newly created crontabs or services.",
          "flag": false,
          "order": 0,
          "status": "Waiting"
        },
        {
          "title": "3.2 Examine Samba and system logs",
          "description": "Analyze /var/log/samba/*, auth.log, syslog around the alert time to find the injection attempt and executed commands.",
          "flag": false,
          "order": 1,
          "status": "Waiting"
        },
        {
          "title": "3.3 Identify and remove malicious artefacts",
          "description": "Remove dropped files, unauthorized user accounts, cron or systemd tasks created by the attacker.",
          "flag": false,
          "order": 2,
          "status": "Waiting"
        },
        {
          "title": "3.4 Change all domain passwords",
          "description": "If the server is a domain controller, consider changing privileged domain account passwords.",
          "flag": false,
          "order": 3,
          "status": "Waiting"
        }
      ]
    },
    {
      "name": "4. RECOVERY & HARDENING",
      "description": "Return the system to production securely and apply patches.",
      "startDate": 1739577600000,
      "tasks": [
        {
          "title": "4.1 Apply the Samba patch",
          "description": "Update Samba to the secure version (>= 4.23.2, >= 4.22.5, >= 4.21.9) OR apply the patch provided by the distributor.",
          "flag": false,
          "order": 0,
          "status": "Waiting"
        },
        {
          "title": "4.2 Review smb.conf configuration",
          "description": "If the 'wins hook' is not essential, remove it. Otherwise, ensure it calls a secure and validated script.",
          "flag": false,
          "order": 1,
          "status": "Waiting"
        },
        {
          "title": "4.3 Restore system from a clean backup",
          "description": "If system integrity is in doubt, restore the server from a backup prior to the incident, after applying the patch.",
          "flag": false,
          "order": 2,
          "status": "Waiting"
        },
        {
          "title": "4.4 Restart services and monitor",
          "description": "Restart Samba services and closely monitor logs for 24-48h to detect any recurring activity.",
          "flag": false,
          "order": 3,
          "status": "Waiting"
        }
      ]
    },
    {
      "name": "5. CLOSURE & POST-INCIDENT REVIEW",
      "description": "Document the incident, update procedures, and share lessons learned.",
      "startDate": 1739577600000,
      "tasks": [
        {
          "title": "5.1 Update detection rules",
          "description": "If necessary, refine Sigma rules (filters, whitelist) based on false positives or new IOCs discovered.",
          "flag": false,
          "order": 0,
          "status": "Waiting"
        },
        {
          "title": "5.2 Write the incident report",
          "description": "Document the timeline, actions taken, impact, and root causes in the organization's standard format.",
          "flag": false,
          "order": 1,
          "status": "Waiting"
        },
        {
          "title": "5.3 Hold a retrospective meeting",
          "description": "Discuss with relevant teams (SOC, infra, security) improvements to be made to processes.",
          "flag": false,
          "order": 2,
          "status": "Waiting"
        }
      ]
    }
  ]
}