# Kit de D√©tection & R√©ponse - CVE-2025-10230 (Samba WINS Hook)
[üëâüèæ  **English version available here**](README.md)
## üìã Aper√ßu
Ce kit fournit des ressources SOC pr√™tes √† l‚Äôemploi pour **d√©tecter et r√©pondre** aux tentatives d‚Äôexploitation de **CVE-2025-10230**, une vuln√©rabilit√© critique d‚Äô**injection de commandes √† distance** dans Samba lorsqu‚Äôun hook WINS est configur√©.

**Score CVSS 3.1 : 10.0 (CRITIQUE)**

Syst√®mes concern√©s :
- Contr√¥leurs de domaine Active Directory Samba
- Serveurs Linux avec WINS activ√© et `wins hook` configur√©

---

## üéØ Strat√©gie de d√©tection

Ce package repose volontairement sur **deux r√®gles Sigma uniquement**, afin de garantir :
- Tr√®s peu de faux positifs
- Une d√©tection fiable en attaque r√©elle **comme en pentest**
- Des preuves syst√®me √† forte confiance

| R√®gle | R√¥le |
|---|---|
| **STRICT** | Preuve d‚Äôexploitation (RCE confirm√©) |
| **SUPPORT** | D√©tection d‚Äôexposition / posture √† risque |

---

## üîç R√®gles Sigma

### 1. STRICT - Samba lance un shell
- D√©tecte les d√©mons Samba (`smbd`, `nmbd`, `winbindd`) g√©n√©rant un shell
- Indique une **ex√©cution de commande distante confirm√©e**
- S√©v√©rit√© : **Critique**
- Action SOC : **R√©ponse √† incident imm√©diate**

### 2. SUPPORT ‚Äî Configuration Samba expos√©e
- D√©tecte `wins support = yes` combin√© √† `wins hook`
- Indique une **configuration exploitable**
- S√©v√©rit√© : **Moyenne**
- Action SOC : **Rem√©diation pr√©ventive**

---

## üìä Sch√©mas SOC

Ce package inclut des sch√©mas visuels destin√©s √† faciliter la compr√©hension des workflows SOC pour les analystes, les √©quipes IR et les RSSI.

Sch√©mas disponibles (PNG & SVG) :

- **Vue d‚Äôensemble SOC** : `diagrams/SOC.png`
- **Flux de r√©ponse SOC (EN)** :  
  - `diagrams/SOC_Response_Flow_EN.png`  
  - `diagrams/SOC_Response_Flow_EN.svg`
- **Flux de r√©ponse SOC (FR)** :  
  - `diagrams/SOC_Response_Flow_FR.png`  
  - `diagrams/SOC_Response_Flow_FR.svg`

Ces sch√©mas illustrent :
- La relation entre les r√®gles Sigma **STRICT** et **SUPPORT**
- Les points de d√©cision SOC (triage, escalade, confirmation d‚Äôincident)
- Le flux de r√©ponse √† incident align√© avec les playbooks fournis


## üö® Playbook TheHive

Le package inclut un **playbook de r√©ponse √† incident g√©n√©rique pour TheHive**, align√© sur les phases NIST :
1. Triage initial
2. Confinement
3. Investigation
4. √âradication
5. R√©tablissement et retour d‚Äôexp√©rience

---

## üõ°Ô∏è Recommandations de mitigation

- Appliquer imm√©diatement les correctifs Samba
- D√©sactiver WINS si non indispensable
- Supprimer toute configuration `wins hook`
- Restreindre l‚Äôexposition du port UDP/137
- Renforcer la surveillance pendant 72h apr√®s correction

---

## üìö R√©f√©rences

- Avis Samba : https://www.samba.org/samba/security/CVE-2025-10230.html
- NVD : https://nvd.nist.gov/vuln/detail/CVE-2025-10230
- PoC (recherche uniquement) : https://github.com/dptsec/CVE-2025-10230
- MITRE ATT&CK : T1059.004, T1190

> ‚ö†Ô∏è Le PoC r√©f√©renc√© est fourni **uniquement √† des fins de recherche et de validation de la d√©tection**.  
> La logique de d√©tection **ne d√©pend pas de l‚Äôimpl√©mentation du PoC**.

---

**Auteur :** Adama ASSIONGBON ‚Äì SOC & CTI Consultant  
**Contact:** [LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

