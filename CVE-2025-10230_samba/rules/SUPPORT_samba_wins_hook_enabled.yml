title: SUPPORT - Samba WINS Hook Enabled (CVE-2025-10230 Exposure)
id: 4c1d2f6e-7b8e-4f2b-b7d9-1a2b3c4d5e6f
status: stable
description: >
  Detects Samba configuration enabling both WINS support and 'wins hook', which exposes the host to   CVE-2025-10230 remote command injection.

   FR=> Détecte une configuration Samba activant simultanément le support WINS et le paramètre 'wins hook',  exposant l’hôte à une injection de commande distante via CVE-2025-10230.
references:
  - https://www.samba.org/samba/security/CVE-2025-10230.html
  - https://nvd.nist.gov/vuln/detail/CVE-2025-10230
  - https://github.com/dptsec/CVE-2025-10230/tree/main
author: Adama ASSIONGBON SOC & CTI Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2026-01-06
modified: 2026-01-31
tags:
  - attack.discovery
  - attack.defense-evasion
  - cve.2025-10230
logsource:
  product: linux
  category: file_event
detection:
  smb_conf:
    TargetFilename|endswith:
      - "/etc/samba/smb.conf"
      - "/usr/local/samba/etc/smb.conf"

  wins_support_yes:
    FileContent|re: "(?m)^\\s*wins\\s+support\\s*=\\s*yes\\s*$"

  wins_hook_set:
    FileContent|re: "(?m)^\\s*wins\\s+hook\\s*=\\s*[\"']?[^;#\\s]+"

  condition: smb_conf and wins_support_yes and wins_hook_set
falsepositives:
  - Configuration changes during authorized maintenance or testing
  - Note: Detection requires file-content capture/parsing by your logging agent
level: medium

