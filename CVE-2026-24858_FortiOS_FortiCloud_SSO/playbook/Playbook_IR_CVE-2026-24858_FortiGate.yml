# FortiGate Incident Response Playbook
# CVE-2026-24858 – FortiOS FortiCloud SSO Abuse
# Author: Adama ASSIONGBON – SOC & CTI Analyst Consultant

playbook:
  name: FortiGate_IR_CVE_2026_24858
  version: 1.0.0
  description: >
    Incident Response playbook for handling FortiOS FortiCloud SSO abuse
    related to CVE-2026-24858. This playbook is triggered by STRICT Sigma
    detection and guides SOC analysts through containment, eradication,
    and recovery steps.
  severity: CRITICAL

trigger:
  detection:
    - FortiOS Suspicious Super Admin Local Account Creation - CVE-2026-24858 (STRICT)

objectives:
  - Confirm compromise
  - Contain attacker access
  - Remove persistence
  - Restore trusted state
  - Document incident

phases:
  identification:
    steps:
      - Verify alert details (devid, user, srcip, eventtime)
      - Confirm local admin creation event (system.admin Add)
      - Check recent FortiCloud SSO login activity
  containment:
    steps:
      - Disable FortiCloud SSO login temporarily
      - Isolate FortiGate management interface if exposed
      - Restrict admin access to trusted IP ranges
  eradication:
    steps:
      - Identify and remove unauthorized local admin accounts
      - Rotate all administrator credentials
      - Revoke active admin sessions
  recovery:
    steps:
      - Re-enable FortiCloud SSO only after patch validation
      - Review firewall, VPN, and routing configuration
      - Restore configuration from last known good backup if required
  post_incident:
    steps:
      - Perform full admin account audit
      - Review logs for lateral movement or config tampering
      - Update detection rules and IoC lists
      - Document lessons learned

references:
  - https://www.fortiguard.com/psirt/FG-IR-26-060
  - https://www.fortinet.com/blog/psirt-blogs/analysis-of-sso-abuse-on-fortios
  - https://nvd.nist.gov/vuln/detail/CVE-2026-24858
