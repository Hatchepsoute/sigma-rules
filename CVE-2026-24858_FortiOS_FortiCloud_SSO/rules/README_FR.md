![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Fortinet](https://img.shields.io/badge/Fortinet-FortiOS-red)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
üëâüèæ Version anglaise ici: [README.md](./README.md)

# üõ°Ô∏è D√©tection d'Abus SSO FortiOS (CVE-2026-24858)

Ce d√©p√¥t propose des r√®gles Sigma sp√©cialis√©es pour contrer la vuln√©rabilit√© de contournement d'authentification **CVE-2026-24858** sur les √©quipements Fortinet.

## üéØ Strat√©gie de D√©tection : D√©fense en Profondeur

Pour une couverture maximale, la d√©tection est divis√©e en deux couches compl√©mentaires :

### 1. üîç La R√®gle "BROAD" (Signal Pr√©coce & Hunting)
* **Fichier** : `fortios_forticloud_sso_abuse_broad_cve_2026_24858.yml`
* **Niveau** : `medium`
* **R√¥le** : Sert de "filet large" pour capturer les √©checs d'authentification SSO anormaux (`logid: 0100032155`) ou des motifs suspects dans les messages SSO.
* **Usage** : Id√©al pour le **hunting proactif** afin d'identifier les phases de reconnaissance ou les tentatives d'exploitation √©chou√©es.

### 2. ‚ö° La R√®gle "STRICT" (Post-Exploitation & Persistance)
* **Fichier** : `fortios_forticloud_sso_abuse_strict_cve_2026_24858.yml`
* **Niveau** : `critical`
* **R√¥le** : Cible la cr√©ation de comptes administrateurs locaux avec privil√®ges `super_admin` utilisant des noms trompeurs (ex: `audit`, `support`, `itadmin`).
* **Usage** : D√©tection √† haute confiance pour une **alerte en temps r√©el** dans votre SIEM. Elle signale la persistance apr√®s un bypass r√©ussi.

---

## üïµÔ∏è Guide d'Investigation pour l'Analyste SOC (Hunting)

Le **Hunting** est la recherche proactive d'attaquants d√©j√† pr√©sents. Pour cette CVE, suivez cette m√©thodologie :

1. **Recherche R√©troactive** : Ex√©cutez la r√®gle **BROAD** sur les 30 derniers jours pour identifier les IP sources (`srcip`) g√©n√©rant des erreurs SSO r√©p√©t√©es.
2. **Corr√©lation** : Pivotez sur ces IPs pour voir si elles ont r√©ussi √† se connecter (`logid: 0100032102`) peu apr√®s les erreurs.
3. **V√©rification de Persistance** : Utilisez la logique de la r√®gle **STRICT** pour chercher tout changement de configuration `system.admin` (`action: Add`) li√© √† ces IPs.

## üìã Correspondance des Champs (FortiOS)

| Champ Sigma | Cl√© Log FortiOS | Description |
| :--- | :--- | :--- |
| **user** | `user` | Compte impliqu√© dans la session SSO ou admin. |
| **srcip** | `srcip` | Adresse IP source de l'attaquant potentiel. |
| **cfgobj** | `cfgobj` | Nom du compte admin nouvellement cr√©√©. |
| **cfgattr** | `cfgattr` | Privil√®ges assign√©s (cherchez `super_admin`). |
| **msg** | `msg` | D√©tail technique de l'erreur FortiCloud SSO. |

---

**Auteur :** Adama ASSIONGBON ‚Äì SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)


