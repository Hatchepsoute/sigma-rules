![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Fortinet](https://img.shields.io/badge/Fortinet-FortiOS-red)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
---
üëâüèæ French version available here: [French README](./README_FR.md)

# üõ°Ô∏è FortiOS FortiCloud SSO Abuse Detection (CVE-2026-24858)
### Author: Adama ASSIONGBON (SOC/CTI Consultant)

This repository provides specialized Sigma rules to counter the **CVE-2026-24858** authentication bypass vulnerability in Fortinet ecosystems.

## üéØ Detection Strategy: The "Defense in Depth" Approach

To provide maximum coverage, the detection is split into two complementary layers:

### 1. üîç The BROAD Rule (Early Warning & Hunting)
* **File**: `fortios_forticloud_sso_abuse_broad_cve_2026_24858.yml`
* **Level**: `medium`
* **Role**: Acts as a wide net to catch abnormal SSO authentication failures (`logid: 0100032155`) or suspicious patterns in SSO messages.
* **Usage**: Best used for **proactive threat hunting** to identify reconnaissance phases or failed exploitation attempts by external IPs.

### 2. ‚ö° The STRICT Rule (Post-Exploitation & Persistence)
* **File**: `fortios_forticloud_sso_abuse_strict_cve_2026_24858.yml`
* **Level**: `critical`
* **Role**: Targets the creation of local administrator accounts with `super_admin` privileges using deceptive names (e.g., `audit`, `support`, `itadmin`).
* **Usage**: High-confidence detection for **real-time alerting** in your SIEM. This flags the moment an attacker tries to establish persistence after a successful bypass.

---

## üïµÔ∏è SOC Analyst Investigation Guide (Hunting)

**Threat Hunting** is the proactive search for attackers already inside the network. For this CVE, follow this workflow:

1. **Retroactive Search**: Run the **BROAD** rule over the last 30 days to identify source IPs (`srcip`) generating multiple SSO errors.
2. **Correlation**: Pivot on these IPs to see if they successfully logged in (`logid: 0100032102`) shortly after the errors.
3. **Persistence Check**: Use the logic of the **STRICT** rule to search for any `system.admin` configuration changes (`action: Add`) linked to those IPs.

## üìã Field Mapping (FortiOS)

| Sigma Field | FortiOS Log Key | Description |
| :--- | :--- | :--- |
| **user** | `user` | Account involved in the SSO or admin session. |
| **srcip** | `srcip` | Source IP address of the potential attacker. |
| **cfgobj** | `cfgobj` | Name of the newly created admin account. |
| **cfgattr** | `cfgattr` | Privileges assigned (look for `super_admin`). |
| **msg** | `msg` | Technical error detail from FortiCloud SSO. |

---

**Author :** Adama ASSIONGBON ‚Äì SOC & CTI Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)


