title: CVE-2025-62550 Azure Monitor Agent Spawns LOLBin With Malicious CLI (STRICT)
id: 2d9c1d3b-0e6d-41e8-9a49-7f5d8d7f7c19
status: experimental
description: |
  High-confidence detection: Azure Monitor Agent spawns a LOLBin with command-line patterns
  consistent with download/execute, obfuscation, or remote script execution.
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-62550
  - https://nvd.nist.gov/vuln/detail/CVE-2025-62550
author: |-
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025/12/24
tags:
  - attack.execution
  - attack.t1059
  - attack.t1105
  - attack.t1071
logsource:
  product: windows
  category: process_creation
detection:
  ama_parent_path:
    ParentImage|contains:
      - '\Program Files\Azure Monitor Agent\'
      - '\Packages\Plugins\Microsoft.Azure.Monitor.AzureMonitorWindowsAgent\'
  lolbin_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\rundll32.exe'
      - '\mshta.exe'
      - '\regsvr32.exe'
      - '\bitsadmin.exe'
      - '\certutil.exe'
  suspicious_cli:
    CommandLine|contains:
      - ' -enc '
      - 'FromBase64String'
      - 'IEX'
      - 'Invoke-Expression'
      - 'Invoke-WebRequest'
      - ' iwr '
      - 'curl '
      - 'wget '
      - 'http://'
      - 'https://'
      - 'bitsadmin /transfer'
      - 'certutil -urlcache'
  condition: ama_parent_path and lolbin_child and suspicious_cli
falsepositives:
  - Very rare; investigate immediately if triggered.
level: high
