title: CVE-2025-62550 Azure Monitor Agent LOLBin with Malicious Patterns (STRICT)
id: 2d9c1d3b-0e6d-41e8-9a49-7f5d8d7f7c19
status: experimental
description: |
  High-confidence detection for suspected CVE-2025-62550 exploitation via Azure Monitor Agent spawning LOLBins with malicious command-line patterns indicating download/execute and/or obfuscation.

  Détection à haut niveau de confiance de l'exploitation supposée de la CVE-2025-62550 via l'agent Azure Monitor,  provoquant le lancement de LOLBins avec des schémas malveillants (download/execute / obfuscation).
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-62550
  - https://nvd.nist.gov/vuln/detail/CVE-2025-62550
author: |-
  Adama Assiongbon SOC/CTI Consultant | https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025-12-24
modified: 2026-02-06
tags:
  - attack.execution
  - attack.t1059.001
  - attack.t1059.003
  - attack.t1105
  - attack.t1027
  - cve.2025-62550
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  selection_parent_ama:
    ParentImage|re:
      - '^[A-Z]:\\Program Files\\Azure Monitor Agent\\[^\\]+\.exe$'
      - '^[A-Z]:\\Packages\\Plugins\\Microsoft\.Azure\.Monitor\.AzureMonitorWindowsAgent\\[^\\]+\\'

  selection_lolbin_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\rundll32.exe'
      - '\mshta.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'

  selection_malicious_cli:
    CommandLine|re:
      - '(?i)-enc[ =][A-Za-z0-9+/=]{20,}'
      - '(?i)FromBase64String\([^)]{20,}\)'
      - '(?i)\b(IEX|Invoke-Expression|Invoke-Command)\b.*https?://'
      - '(?i)\b(Start-Process|\.Invoke\(\)|\.CreateInstance\()\b'
      - '(?i)\b(iwr|curl|wget|Invoke-WebRequest)\b.*https?://'
      - '(?i)\bbitsadmin\b.*\/transfer.*https?://'
      - '(?i)\bcertutil\b.*-urlcache.*https?://'
      - '(?i)-WindowStyle\s+hidden\b'
      - '(?i)-ExecutionPolicy\s+bypass\b'
      - '(?i)\$ExecutionContext\.InvokeCommand\.NewScriptBlock'
      - '(?i)https?://(?!.*microsoft\.com|.*windows\.com|.*azure\.com)[^ ]+\.(exe|dll|ps1|vbs|js)\b'

  filter_legitimate_agent_admin:
    CommandLine|contains:
      - 'Get-AzMonitorLog'
      - 'Set-AzMonitorDiagnosticSetting'
      - 'AzureMonitorAgent'
      - 'Microsoft Monitoring Agent'
      - 'diagnostic'
      - 'troubleshoot'

  filter_simple_system_cmds:
    CommandLine|re:
      - '(?i)^cmd\.exe\s+/c\s+(dir|echo|ping|ipconfig)\b'

  filter_microsoft_signed_script_patterns:
    CommandLine|contains|all:
      - 'Microsoft.PowerShell'
      - '.psd1'

  condition: selection_parent_ama and selection_lolbin_child and selection_malicious_cli and not (filter_legitimate_agent_admin or filter_simple_system_cmds or filter_microsoft_signed_script_patterns)
fields:
  - ParentImage
  - ParentCommandLine
  - Image
  - CommandLine
  - User
  - CurrentDirectory
falsepositives:
  - Rare legitimate Azure troubleshooting that invokes script interpreters with encoded/obfuscated parameters
  - Authorized incident response scripts launched under SYSTEM by monitoring/management tooling (verify allow-list)
level: critical
