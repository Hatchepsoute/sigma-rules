title: CVE-2025-62550 Azure Monitor Agent Anomalous Child Process (BROAD)
id: 6a4d8d4f-6d5b-4e67-9e2a-3d2b2f9a1c50
status: experimental
description: |
  Detects anomalous child processes spawned from Azure Monitor Agent with contextual filtering.  Focuses on rare parent-child relationships that may indicate scanning, exploitation, or post-exploitation activity.

  Détecte les processus enfants anormaux générés par l'agent Azure Monitor avec un filtrage contextuel.  Cible des relations parent-enfant rares pouvant indiquer du scan, de l'exploitation ou du post-exploit.
references:
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-62550
  - https://nvd.nist.gov/vuln/detail/CVE-2025-62550
author: |-
  Adama Assiongbon (SOC/CTI Consultant) | LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025-12-24
modified: 2026-02-06
tags:
  - attack.execution
  - attack.t1059
  - attack.t1204.002
  - cve.2025-62550
logsource:
  product: windows
  category: process_creation
  service: sysmon
detection:
  selection_parent_ama:
    ParentImage|re:
      - '^[A-Z]:\\Program Files\\Azure Monitor Agent\\(AMA|Monitoring)\w*\.exe$'
      - '^[A-Z]:\\Packages\\Plugins\\Microsoft\.Azure\.Monitor\.AzureMonitorWindowsAgent\\[^\\]+\\(AMA|AzureMonitor)\w*\.exe$'

  selection_child_suspicious:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\rundll32.exe'
      - '\mshta.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\bitsadmin.exe'
      - '\certutil.exe'
      - '\curl.exe'
      - '\wget.exe'
      - '\ftp.exe'
      - '\tftp.exe'
      - '\ssh.exe'
      - '\sc.exe'
      - '\schtasks.exe'
      - '\reg.exe'

  selection_cli_slightly_suspicious:
    CommandLine|re:
      - '(?i)\.(ps1|vbs|js|jse|vbe|wsf|wsh|hta|bat|cmd)\b'
      - '(?i)(http|https|ftp)://'
      - '(?i)\b(net|net1)\.exe (user|localgroup)\b'
      - '(?i)schtasks\.exe\s+/create\b'
      - '(?i)reg\.exe\s+(add|delete)\b'

  filter_legit_paths:
    Image|startswith:
      - 'C:\Windows\System32\'
      - 'C:\Windows\SysWOW64\'
      - 'C:\Program Files\'
      - 'C:\Program Files (x86)\'

  filter_azure_maintenance_1:
    CommandLine|contains|all:
      - 'Azure'
      - 'Monitor'
      - 'Extension'

  filter_azure_maintenance_2:
    ParentCommandLine|contains:
      - 'Diagnostic'
      - 'Troubleshoot'
      - 'HealthService'
      - 'MonitoringHost'

  filter_system_commands:
    CommandLine|re:
      - '(?i)^(cmd|powershell)\.exe\s+/c\s+"(echo|dir|type|find)\b'
      - '(?i)/c\s+ping\s+(localhost|127\.0\.0\.1)\b'
      - '(?i)/c\s+ipconfig(\s+/all|\s+/displaydns)?\b'
      - '(?i)/c\s+netstat\s+-an\b'
      - '(?i)/c\s+tasklist(\s+/fi|\s+/svc)?\b'
      - '(?i)\b(Get-Process|Get-Service|Get-EventLog)\b'

  filter_normal_children:
    Image|endswith:
      - '\svchost.exe'
      - '\conhost.exe'
      - '\mmc.exe'
      - '\explorer.exe'

  condition: selection_parent_ama and selection_child_suspicious and selection_cli_slightly_suspicious and not (filter_legit_paths or filter_azure_maintenance_1 or filter_azure_maintenance_2 or filter_system_commands or filter_normal_children)
fields:
  - ParentImage
  - ParentCommandLine
  - Image
  - CommandLine
  - User
  - CurrentDirectory
falsepositives:
  - Scheduled Azure maintenance / diagnostic activity
  - Legitimate troubleshooting scripts executed by administrators
  - Rare but benign child process relationships depending on environment/agent extensions
level: high
