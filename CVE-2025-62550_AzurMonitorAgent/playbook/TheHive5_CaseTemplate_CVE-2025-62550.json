{
  "name": "CVE-2025-62550 – Azure Monitor Agent Suspicious Child Process",
  "displayName": "CVE-2025-62550 – AMA suspicious child process (AUTO/Manual)",
  "description": "TheHive v5 Case Template for investigating potential exploitation chains related to CVE-2025-62550 involving Azure Monitor Agent (AMA). Includes tasks, required observables, and automation hooks (Cortex analyzers/responders) to enrich and contain.",
  "severity": 3,
  "tlp": 2,
  "tags": [
    "cve-2025-62550",
    "azure-monitor-agent",
    "post-exploitation",
    "windows",
    "rce-suspected"
  ],
  "tasks": [
    {
      "title": "Triage (L1) – Validate AMA → child process chain",
      "description": "Confirm parent process belongs to Azure Monitor Agent (AMA) and identify child process, command line, user, host, and timestamp. Decide FP vs escalate.",
      "mandatory": true,
      "order": 10,
      "status": "Waiting"
    },
    {
      "title": "Enrichment (AUTO) – Process tree & context",
      "description": "Run analyzers to collect process tree and parent/child context. Attach results to case.",
      "mandatory": true,
      "order": 20,
      "status": "Waiting",
      "cortex": {
        "analyzers": [
          {
            "name": "ProcessTree",
            "on": "hostname"
          },
          {
            "name": "Yara_ProcMemScan",
            "on": "hostname"
          }
        ]
      }
    },
    {
      "title": "Enrichment (AUTO) – IOC reputation",
      "description": "Enrich hash/IP/domain with reputation (VT/OTX/etc). Add verdict into case.",
      "mandatory": false,
      "order": 30,
      "status": "Waiting",
      "cortex": {
        "analyzers": [
          {
            "name": "VirusTotal_GetReport",
            "on": "hash"
          },
          {
            "name": "VirusTotal_GetIPReport",
            "on": "ip"
          },
          {
            "name": "VirusTotal_GetDomainReport",
            "on": "domain"
          }
        ]
      }
    },
    {
      "title": "Scope (L2) – Look for additional affected hosts",
      "description": "Search SIEM for similar detections and for AMA spawning shells/LOLBins on other assets in last 7d. Identify blast radius.",
      "mandatory": true,
      "order": 40,
      "status": "Waiting"
    },
    {
      "title": "Containment (AUTO) – Isolate host / block outbound",
      "description": "If confirmed malicious (risk score ≥ 70 or STRICT rule hit), isolate endpoint and block destination IP/domain. Optional: disable user account.",
      "mandatory": false,
      "order": 50,
      "status": "Waiting",
      "cortex": {
        "responders": [
          {
            "name": "EDR_IsolateHost",
            "on": "hostname"
          },
          {
            "name": "Firewall_BlockIP",
            "on": "ip"
          },
          {
            "name": "Firewall_BlockDomain",
            "on": "domain"
          },
          {
            "name": "Disable_User_Account",
            "on": "user"
          }
        ]
      }
    },
    {
      "title": "Investigation (L3) – AMA integrity & persistence checks",
      "description": "Verify AMA version/config, check for tampering, persistence locations, scheduled tasks, services, and registry run keys. Collect artifacts for IR.",
      "mandatory": true,
      "order": 60,
      "status": "Waiting"
    },
    {
      "title": "Remediation – Patch/Update & credential hygiene",
      "description": "Update AMA, apply mitigations, rotate credentials/secrets if accessed. Validate system clean and close incident with lessons learned.",
      "mandatory": true,
      "order": 70,
      "status": "Waiting"
    }
  ],
  "customFields": {
    "cve": {
      "type": "string",
      "value": "CVE-2025-62550"
    },
    "detection_rule": {
      "type": "string",
      "value": "(BROAD/STRICT) AzureMonitorAgent child process"
    },
    "risk_score": {
      "type": "number",
      "value": 0
    },
    "ama_parent_process": {
      "type": "string",
      "value": ""
    },
    "child_process": {
      "type": "string",
      "value": ""
    },
    "command_line": {
      "type": "string",
      "value": ""
    },
    "dst_ip": {
      "type": "string",
      "value": ""
    },
    "dst_domain": {
      "type": "string",
      "value": ""
    },
    "sha256": {
      "type": "string",
      "value": ""
    }
  },
  "metrics": {
    "created": "2025-12-24",
    "version": "1.0"
  }
}