# CVE-2025-62550 ‚Äì D√©tection de l‚Äôexploitation d‚ÄôAzure Monitor Agent (R√®gles Sigma)

## Objectif

Ce r√©pertoire contient **deux r√®gles Sigma compl√©mentaires** permettant de d√©tecter des **cha√Ænes d‚Äôexploitation potentielles li√©es √† la CVE-2025-62550**, une vuln√©rabilit√© d‚Äô**ex√©cution de code √† distance (RCE)** affectant **Azure Monitor Agent (AMA)**.

En l‚Äôabsence de PoC public, ces r√®gles se basent sur des **indicateurs comportementaux post-exploitation**, ind√©pendants de la m√©thode exacte d‚Äôexploitation.

---

## Strat√©gie de d√©tection

La strat√©gie repose sur une **approche SOC en couches** :

- **R√®gle BROAD** : visibilit√© pr√©coce et threat hunting  
- **R√®gle STRICT** : d√©tection √† haute confiance, pr√™te incident  

Les deux r√®gles doivent √™tre **d√©ploy√©es ensemble**.

---

## R√®gle 1 ‚Äì BROAD (Comportement suspect)

### Nom
`CVE-2025-62550_AzureMonitorAgent_Suspicious_Child_Process_Spawn.yml`

### R√¥le
D√©tecte toute **cr√©ation de processus enfant suspecte depuis Azure Monitor Agent**.

### Ce que la r√®gle d√©tecte
- AMA comme processus parent
- Lancement de shells ou LOLBins
- Signaux pr√©coces post-exploitation

### Usage SOC
- Triage analyste SOC N1 / N2
- Threat hunting
- Visibilit√© tentative d‚Äôexploitation

---

## R√®gle 2 - STRICT (Exploitation confirm√©e)

### Nom
`CVE-2025-62550_AzureMonitorAgent_LOLBin_Download_Execute.yml`

### R√¥le
D√©tecte l‚Äôutilisation de **LOLbins avec des lignes de commande malveillantes** lanc√©es par Azure Monitor Agent.

### Ce que la r√®gle d√©tecte
- T√©l√©chargement et ex√©cution
- Commandes encod√©es ou obfusqu√©es
- Activit√© post-exploitation av√©r√©e

### Usage SOC
- Analyste SOC N2 / N3
- D√©claration d‚Äôincident
- R√©ponse SOAR

---

## Logique de corr√©lation (recommand√©e)

| R√®gle d√©clench√©e | Interpr√©tation SOC |
|----------------|-------------------|
| BROAD seule | Activit√© suspecte ‚Äì √† investiguer |
| STRICT seule | Activit√© malveillante confirm√©e |
| **BROAD + STRICT** | üö® **Cha√Æne d‚Äôexploitation confirm√©e** |

---

## Tableau comparatif SOC

| Crit√®re | R√®gle BROAD | R√®gle STRICT |
|--------|-------------|--------------|
| Phase | Pr√©coce / hunting | Post-exploitation |
| Faux positifs | Moyens | Faibles |
| Niveau de confiance | Moyen | √âlev√© |
| Pr√™te incident | ‚ùå | ‚úÖ |
| Niveau SOC | N1 / N2 | N2 / N3 |

---

## Pourquoi deux r√®gles ?

> Sans PoC public, la d√©tection doit reposer sur des **comportements invariants**, pas sur des signatures fragiles.

Cette approche :
- R√©duit le bruit
- Am√©liore la confiance SOC
- Assure une d√©tection robuste et durable

---

**CVE concern√©e :** CVE-2025-62550  
**Maintenu par :** Adama Assiongbon  
**R√¥le :** SOC & CTI Analyst  
**Derni√®re mise √† jour :** 2025-12-24
