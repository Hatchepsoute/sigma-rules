# ğŸ§­ Diagramme â€“ Cycle dâ€™attaque & dÃ©tection SOC  
 [ğŸ‘‰ğŸ¾ English version available here: ](./README.md)

**Ivanti EPMM â€“ CVE-2026-1281 / CVE-2026-1340**

```mermaid
graph TD
    %% Log ingestion
    A[Web / WAF / Reverse Proxy Logs] --> B{Request to /mifs/c/*store/fob/?}

    %% BROAD detection path
    B -- Yes --> C[Filter: Exclude localhost & link-local]
    C --> D{External Source?}
    D -- Yes --> E[BROAD Alert: Scan / Early Probing Detected]
    E --> E1[Severity: MEDIUM]

    %% STRICT detection path
    B -- Yes --> F[Analyze URL Query Parameters]
    F -- "Contains $(, $((, or backticks" --> G{HTTP Status 404 or 500?}
    G -- Yes --> H[STRICT Alert: Pre-Auth RCE Exploitation Attempt]
    H --> H1[Severity: CRITICAL]

    %% SOC actions
    E1 -.-> I[Threat Hunting \n IP Reputation \n Preventive Blocking]
    H1 -.-> J[Incident Response \n Isolate EPMM Appliance \n Forensics & Containment]

    %% Styling
    style E fill:#FFD966,stroke:#333,stroke-width:2px
    style H fill:#E06666,stroke:#333,stroke-width:4px,color:#fff
    style B fill:#CFE2F3,stroke:#333,stroke-width:2px
```
---
## Explication du flux :

### Point d'entrÃ©e commun : 

Les deux dÃ©tections commencent par identifier l'accÃ¨s aux rÃ©pertoires sensibles /mifs/c/appstore/fob/ (CVE-2026-1281) ou /mifs/c/aftstore/fob/ (CVE-2026-1340).

### La rÃ¨gle BROAD (Branche gauche) :
- Elle se contente de vÃ©rifier si l'accÃ¨s provient d'Internet (en filtrant les IPs locales).
- Elle sert de "radar" pour identifier les attaquants qui testent votre exposition.

### La rÃ¨gle STRICT (Branche droite) :
- Elle examine le contenu technique de la requÃªte (url.query) Ã  la recherche de l'expansion arithmÃ©tique Bash.
- Elle utilise le code de statut HTTP (404/500) comme confirmateur d'anomalie, augmentant radicalement la confiance dans l'alerte.

ğŸŸ¡ BROAD = Jaune Â· ğŸ”´ STRICT = Rouge

![ğŸ‘‰ğŸ¾](./ivanti_epmm_attack_flow_broad_strict.png)
