# ğŸ§­ SOC Attack & Detection Cycle Diagram

```mermaid
graph TD
    %% Log ingestion
    A[Web / WAF / Reverse Proxy Logs] --> B{Request to /mifs/c/*store/fob/?}

    %% BROAD detection path
    B -- Yes --> C[Filter: Exclude localhost & link-local]
    C --> D{External Source?}
    D -- Yes --> E[BROAD Alert: Scanning / Early Probing Detected]
    E --> E1[Severity: MEDIUM]

    %% STRICT detection path
    B -- Yes --> F[Analyze URL Query Parameters]
    F -- "Contains $(, $((, or backticks" --> G{HTTP Status 404 or 500?}
    G -- Yes --> H[STRICT Alert: Pre-Auth RCE Exploitation Attempt]
    H --> H1[Severity: CRITICAL]

    %% SOC actions
    E1 -.-> I[Threat Hunting \n IP Reputation \n Preventive Blocking]
    H1 -.-> J[Incident Response \n Isolate EPMM Appliance \n Forensics & Containment]

    %% Styling
    style E fill:#FFD966,stroke:#333,stroke-width:2px
    style H fill:#E06666,stroke:#333,stroke-width:4px,color:#fff
    style B fill:#CFE2F3,stroke:#333,stroke-width:2px
```
## Flow Explanation:

Common Entry Point: Both detections begin by identifying access to the sensitive directories /mifs/c/appstore/fob/ (CVE-2026-1281) or /mifs/c/aftstore/fob/ (CVE-2026-1340).

### The BROAD Rule (Left Branch):
- It simply verifies if the access originates from the Internet (by filtering out local/internal IPs).
- It serves as a "radar" to identify attackers scanning for exposure.

### The STRICT Rule (Right Branch):
- It inspects the technical content of the request (url.query) specifically looking for Bash arithmetic expansion.
- It uses the HTTP status codes (404/500) as an anomaly confirmer, radically increasing the confidence level of the alert.

Legend

ğŸŸ¡ BROAD = Yellow Â· ğŸ”´ STRICT = Red
[ğŸ‘‰ğŸ¾](./ivanti_epmm_attack_flow_broad_strict.png)
