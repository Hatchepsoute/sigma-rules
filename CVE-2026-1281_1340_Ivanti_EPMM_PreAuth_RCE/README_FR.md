![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Ivanti](https://img.shields.io/badge/Ivanti-Security%20RCE-critical)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
# Ivanti EPMM â€“ Pack de dÃ©tection RCE Pre-Auth (CVE-2026-1281 / CVE-2026-1340)
 â¡ï¸  **[Version anglaise disponible ici](README.md)**
Ce dÃ©pÃ´t fournit des **rÃ¨gles Sigma prÃªtes SOC** permettant de dÃ©tecter les tentatives dâ€™exploitation visant **Ivanti Endpoint Manager Mobile (EPMM)**, affectÃ© par les vulnÃ©rabilitÃ©s critiques **CVE-2026-1281** et **CVE-2026-1340**.

Ces failles permettent Ã  un attaquant **non authentifiÃ©** dâ€™exÃ©cuter du code Ã  distance en abusant de **lâ€™expansion arithmÃ©tique Bash** dans des composants EPMM exposÃ©s via HTTP.

---

## ğŸš¨ PrÃ©sentation des vulnÃ©rabilitÃ©s

- **Produit** : Ivanti Endpoint Manager Mobile (EPMM)
- **Impact** : ExÃ©cution de code Ã  distance sans authentification (RCE)
- **SÃ©vÃ©ritÃ©** : Critique (CVSS 9.8)
- **Vecteur dâ€™attaque** : RÃ©seau (HTTP)
- **Authentification requise** : Aucune

### Composants affectÃ©s

- Distribution dâ€™applications internes (`/mifs/c/appstore/fob/`) â€“ CVE-2026-1281
- Android File Transfer (AFT) (`/mifs/c/aftstore/fob/`) â€“ CVE-2026-1340

### Cause racine

Mauvaise gestion des entrÃ©es utilisateur dans des **scripts Bash utilisÃ©s par Apache RewriteMap**, permettant lâ€™exÃ©cution de commandes via **lâ€™expansion arithmÃ©tique Bash**.

---

## ğŸ›¡ï¸ StratÃ©gie de dÃ©tection

Ce pack adopte une **approche en couches**, conforme aux bonnes pratiques en Detection Engineering :

| Type de rÃ¨gle | Objectif | Usage SOC |
|-------------|----------|-----------|
| **BROAD** | DÃ©tection de scans et dâ€™accÃ¨s suspects | Threat hunting / Alerte prÃ©coce |
| **STRICT** | DÃ©tection dâ€™exploitation avÃ©rÃ©e | Alerte SOC / RÃ©ponse Ã  incident |

Lâ€™utilisation conjointe des deux rÃ¨gles permet une **visibilitÃ© complÃ¨te du cycle dâ€™attaque**.

---

## ğŸ“‚ Structure du dÃ©pÃ´t

```
CVE-2026-1281_1340_Ivanti_EPMM_PreAuth_RCE/
â”œâ”€â”€ rules/
â”‚   â”œâ”€â”€ ivanti_epmm_preauth_rce_fob_CVE_2026_1281_1340_broad.yml
â”‚   â””â”€â”€ ivanti_epmm_preauth_rce_2026-1281_1340_strict.yml
â”œâ”€â”€ README.md
â””â”€â”€ README_FR.md
```

---

## ğŸ“œ RÃ¨gles Sigma

### ğŸ”¹ BROAD â€“ AccÃ¨s suspect aux endpoints vulnÃ©rables

- DÃ©tecte **tout accÃ¨s non local** aux endpoints EPMM vulnÃ©rables
- ConÃ§ue pour le **hunting** et lâ€™alerte prÃ©coce
- Peut gÃ©nÃ©rer du bruit (par design)

**Cas dâ€™usage** :
- DÃ©tection de scans
- Identification dâ€™une exposition Internet
- Analyse de surface dâ€™attaque

---

### ğŸ”¹ STRICT â€“ Tentative dâ€™exploitation RCE Pre-Auth Ã  haute confiance

- DÃ©tecte des **tentatives dâ€™exploitation rÃ©elles**
- Combine :
  - AccÃ¨s aux endpoints vulnÃ©rables
  - Motifs dâ€™injection Bash
  - Codes HTTP anormaux (404/500)
- RÃ¨gle **hautement fiable**, niveau incident

**Cas dâ€™usage** :
- Confirmation dâ€™exploitation active
- DÃ©clenchement dâ€™un incident SOC
- CorrÃ©lation avec des logs hÃ´te / EDR

---

## ğŸ§  Mapping MITRE ATT&CK

- **T1190** â€“ Exploitation dâ€™application exposÃ©e
- **T1059.004** â€“ InterprÃ©teur de commandes Unix (Bash)

---

## âš ï¸ Faux positifs & ajustements

- Scanners de vulnÃ©rabilitÃ©s (Nessus, Qualys, ASM)
- Tests de sÃ©curitÃ© autorisÃ©s

**Recommandations** :
- Mettre en liste blanche les IP de scanners connus
- CorrÃ©ler les alertes BROAD avec la rÃ¨gle STRICT
- Croiser avec la tÃ©lÃ©mÃ©trie hÃ´te lorsque disponible

---

## ğŸ”§ Recommandations de remÃ©diation

La dÃ©tection **ne remplace pas la correction**. Ivanti recommande :

- Application immÃ©diate des correctifs officiels
- Mise Ã  jour vers les versions EPMM corrigÃ©es
- Restriction de lâ€™exposition rÃ©seau des interfaces EPMM
- Analyse rÃ©trospective des logs HTTP

---

## âœï¸ Auteur

**Adama ASSIONGBON**  
Consultant SOC & Cyber Threat Intelligence  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)


