![Sigma](https://img.shields.io/badge/Sigma-Compatible-blue)
![Ivanti](https://img.shields.io/badge/Ivanti-Security%20RCE-critical)
![SOC](https://img.shields.io/badge/SOC-Ready-green)
# Ivanti EPMM ‚Äì Pre-Auth RCE Detection Pack (CVE-2026-1281 / CVE-2026-1340)

 ‚û°Ô∏è **[French version available here](./README_FR.md)** 
 
 
This repository provides **SOC-ready Sigma detection rules** for identifying exploitation attempts against **Ivanti Endpoint Manager Mobile (EPMM)** affected by the critical pre-authentication remote code execution vulnerabilities **CVE-2026-1281** and **CVE-2026-1340**.

These vulnerabilities allow **unauthenticated attackers** to achieve **remote code execution** by abusing **Bash arithmetic expansion** in vulnerable EPMM components exposed via HTTP endpoints.

---

## üö® Vulnerability Overview

- **Product**: Ivanti Endpoint Manager Mobile (EPMM)
- **Impact**: Pre-authentication Remote Code Execution (RCE)
- **Severity**: Critical (CVSS 9.8)
- **Attack Vector**: Network (HTTP)
- **Authentication Required**: No

### Affected Components

- In-House Application Distribution (`/mifs/c/appstore/fob/`) ‚Äì CVE-2026-1281
- Android File Transfer (AFT) (`/mifs/c/aftstore/fob/`) ‚Äì CVE-2026-1340

### Root Cause

Improper handling of user-supplied input inside **Apache RewriteMap Bash scripts**, allowing **command execution via Bash arithmetic expansion**.

---

## üõ°Ô∏è Detection Strategy

This pack follows a **layered detection approach** aligned with detection engineering best practices:

| Rule Type | Purpose | SOC Usage |
|---------|--------|-----------|
| **BROAD** | Detects scanning and early-stage probing of vulnerable endpoints | Threat hunting / Early warning |
| **STRICT** | Detects high-confidence exploitation attempts (bash injection patterns + errors) | Alerting / Incident response |

Using both rules together provides **visibility before, during, and at exploitation time**.

---

## üìÇ Repository Structure

```
CVE-2026-1281_1340_Ivanti_EPMM_PreAuth_RCE/
‚îú‚îÄ‚îÄ rules/
‚îÇ   ‚îú‚îÄ‚îÄ ivanti_epmm_preauth_rce_fob_CVE_2026_1281_1340_broad.yml
‚îÇ   ‚îî‚îÄ‚îÄ ivanti_epmm_preauth_rce_2026-1281_1340_strict.yml
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ README_FR.md
```

---

## üìú Sigma Rules

### üîπ BROAD - Suspicious Access to Vulnerable Endpoints

- Detects **any non-local access** to known vulnerable EPMM endpoints
- Designed for **hunting and early warning**
- Low confidence by design, may generate noise

[ivanti_epmm_preauth_rce_fob_CVE_2026_1281_1340_broad.yml](./rules/ivanti_epmm_preauth_rce_fob_CVE_2026_1281_1340_broad.yml)

**Use cases**:
- Identify scanning activity
- Detect exposure of EPMM services
- Baseline normal vs abnormal access

---

### üîπ STRICT ‚Äì High-Confidence Pre-Auth RCE Attempt

- Detects **clear exploitation attempts**
- Combines:
  - Access to vulnerable endpoints
  - Bash command injection patterns
  - HTTP error responses (404/500)
- High confidence, **incident-grade alerts**

[ivanti_epmm_preauth_rce_2026-1281_1340_strict.yml](./rules/ivanti_epmm_preauth_rce_2026-1281_1340_strict.yml)

**Use cases**:
- Confirm active exploitation
- Trigger incident response
- Correlate with host-based telemetry

---

## üß† MITRE ATT&CK Mapping

- **T1190** ‚Äì Exploit Public-Facing Application
- **T1059.004** ‚Äì Command and Scripting Interpreter: Unix Shell

---

## ‚ö†Ô∏è False Positives & Tuning

- Vulnerability scanners (Nessus, Qualys, ASM tools)
- Authorized penetration tests

**Recommendations**:
- Allowlist known scanner IPs
- Correlate BROAD hits with STRICT hits
- Correlate with EDR / Linux process telemetry when available

---

## üîß Remediation Guidance

Detection does **not replace remediation**. Ivanti recommends:

- Immediate application of Ivanti-provided patches
- Upgrade to fixed EPMM versions when available
- Restrict network exposure of EPMM interfaces
- Review historical HTTP logs for prior exploitation

---

## ‚úçÔ∏è Author

**Adama ASSIONGBON**  
SOC & Cyber Threat Intelligence Consultant  
[LinkedIn Profile](https://www.linkedin.com/in/adama-assiongbon-9029893a/)

