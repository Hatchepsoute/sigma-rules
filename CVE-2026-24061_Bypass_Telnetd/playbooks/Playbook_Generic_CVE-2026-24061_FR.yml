# Playbook générique IR (YAML) — CVE-2026-24061 (Telnetd Authentication Bypass)
# Usage: modèle SOC agnostique (peut être adapté à TheHive/Cortex, SOAR, ou runbooks internes)
# Auteur: Adama ASSIONGBON | SOC & CTI Analyst Consultant
# Date: 2026-01-27
# Sévérité: CRITIQUE (STRICT) / ÉLEVÉE (BROAD)

playbook:
  id: "PB-CVE-2026-24061-FR"
  title: "Réponse à incident - CVE-2026-24061 (Contournement Telnetd)"
  version: "1.0.0"
  status: "ready"
  scope:
    platforms: ["linux"]
    detection_sources:
      sigma_rules:
        - name: "STRICT"
          file: "rules/remote_authentication_bypass_telnetd_cve_2026_24061.yml"
          severity: "CRITIQUE"
          intent: "Détection directe de l’exploitation (login -f root depuis telnetd)"
        - name: "BROAD"
          file: "rules/process_creation_linux_telnet_cve_2026_24061_broad.yml"
          severity: "ÉLEVÉE"
          intent: "Hunting / post-exploitation / variantes"
      network:
        - "Trafic entrant TCP/23 (Telnet) vers l’actif"
      endpoint:
        - "Création de processus (EDR/auditd/sysmon-for-linux)"
        - "Logs auth (auth.log / secure / journalctl)"
  references:
    - "https://nvd.nist.gov/vuln/detail/CVE-2026-24061"
    - "https://github.com/SafeBreach-Labs/CVE-2026-24061"
    - "https://www.safebreach.com/blog/safebreach-labs-root-cause-analysis-and-poc-exploit-for-cve-2026-24061/"

  severity_logic:
    rules:
      STRICT: "CRITIQUE"
      BROAD: "ÉLEVÉE"
    escalation:
      - when: "STRICT déclenchée"
        then: "Incident CRITIQUE immédiat"
      - when: "BROAD déclenchée + contexte réseau (TCP/23) ou répétitions"
        then: "Escalade IR (ÉLEVÉE)"
      - when: "BROAD suivie de STRICT"
        then: "Compromission confirmée (CRITIQUE)"

  objectives:
    - "Confirmer rapidement l’exploitation et l’impact"
    - "Confinement immédiat pour limiter la propagation"
    - "Collecter les preuves (forensic) sans détruire les artefacts"
    - "Éradiquer l’accès illégitime et restaurer un état sain"
    - "Réduire la surface d’attaque (désactivation Telnet / restrictions réseau)"

  workflow:
    - phase: "1. Triage (0–30 min)"
      goals:
        - "Qualifier l’alerte (STRICT vs BROAD)"
        - "Évaluer criticité de l’actif et exposition Telnet"
        - "Déterminer si l’incident est en cours"
      tasks:
        - id: "T1"
          name: "Identifier le signal"
          actions:
            - "Récupérer l’évènement SIEM/EDR déclencheur (horodatage, hôte, utilisateur, commande)."
            - "Noter la règle: STRICT ou BROAD."
          evidence:
            - "Event raw / fields: ParentImage, Image, CommandLine, User, Hostname"
        - id: "T2"
          name: "Vérifier exposition Telnet"
          actions:
            - "Confirmer si le port Telnet est exposé (TCP/23) : pare-feu, ACL, NAT, VPN."
            - "Lister les IP sources, ASN/pays si disponible."
          evidence:
            - "Logs FW/IDS/Netflow: src_ip, dst_ip, dst_port=23, action"
        - id: "T3"
          name: "Décision initiale"
          decision:
            - if: "STRICT"
              then: "Passer immédiatement en Confinement (phase 2) + escalade IR."
            - elif: "BROAD"
              then: "Vérifier contexte (réseau + répétition + commande). Si suspect -> phase 2; sinon -> hunting contrôlé."
    - phase: "2. Confinement (0–2 h)"
      goals:
        - "Stopper l’accès root non autorisé"
        - "Empêcher la propagation et le C2"
      tasks:
        - id: "C1"
          name: "Isoler l’hôte"
          actions:
            - "Isoler au niveau EDR si possible (network containment)."
            - "Sinon appliquer une ACL/segmentation temporaire (bloquer entrants/sortants non essentiels)."
          notes:
            - "Priorité absolue si STRICT."
        - id: "C2"
          name: "Bloquer sources suspectes"
          actions:
            - "Bloquer IP sources observées sur Telnet (temporaire 24–72h) au FW."
            - "Mettre en watchlist les IP si blocage impossible."
        - id: "C3"
          name: "Désactiver Telnet (si opérationnellement possible)"
          actions:
            - "Arrêter et désactiver le service telnetd."
            - "Restreindre à un réseau d’admin si Telnet ne peut pas être supprimé."
          caution:
            - "Coordonner avec l’équipe système pour éviter l’impact production."

    - phase: "3. Investigation / Forensic (2–24 h)"
      goals:
        - "Confirmer exploitation et déterminer périmètre"
        - "Identifier post-exploitation (payloads, persistance, latéral)"
      tasks:
        - id: "I1"
          name: "Analyse arbre de processus"
          actions:
            - "Reconstituer: telnetd → login → shell / outils."
            - "Rechercher commandes: curl/wget/nc/python -c, /dev/tcp, | sh."
          evidence:
            - "Process tree / timeline"
        - id: "I2"
          name: "Logs d’authentification"
          actions:
            - "Examiner /var/log/auth.log ou /var/log/secure ou journalctl."
            - "Chercher connexions telnet, sessions root, anomalies de login."
        - id: "I3"
          name: "Recherche de persistance"
          actions:
            - "Vérifier crontab, systemd services, rc.local, ssh keys, comptes ajoutés."
            - "Lister nouveaux binaires/artefacts dans /tmp, /var/tmp, /dev/shm."
        - id: "I4"
          name: "Recherche de C2 / exfiltration"
          actions:
            - "Contrôler connexions sortantes anormales après la session Telnet."
            - "Vérifier DNS, HTTP(S), ports non standards, connexions vers IP rares."
        - id: "I5"
          name: "Évaluation du périmètre"
          actions:
            - "Identifier autres hôtes exposés Telnet."
            - "Rechercher la même séquence de détection sur 7–30 jours."

    - phase: "4. Éradication & Restauration (24–72 h)"
      goals:
        - "Supprimer l’accès non autorisé"
        - "Restaurer un état de confiance"
      tasks:
        - id: "E1"
          name: "Suppression accès malveillants"
          actions:
            - "Supprimer comptes/clefs SSH ajoutés."
            - "Révoquer tokens/credentials compromis."
        - id: "E2"
          name: "Correction / Patch / Hardening"
          actions:
            - "Mettre à jour les composants affectés si correctif disponible."
            - "Sinon appliquer mitigations (désactivation Telnet, restriction réseau)."
        - id: "E3"
          name: "Rotation des identifiants"
          actions:
            - "Rotation des mots de passe admin/root et comptes de service impactés."
            - "Rotation des clés SSH si suspicion."
        - id: "E4"
          name: "Restauration"
          actions:
            - "Restaurer depuis sauvegarde saine si compromission confirmée."
            - "Revalider intégrité (hash, baseline, EDR scan)."

    - phase: "5. Post-Incident (72 h+)"
      goals:
        - "Capitaliser et renforcer"
      tasks:
        - id: "P1"
          name: "Rapport & timeline"
          actions:
            - "Construire timeline (début, exploitation, actions, containment, recovery)."
            - "Identifier IOC internes (IPs, commandes, comptes, fichiers)."
        - id: "P2"
          name: "Amélioration détection"
          actions:
            - "Ajuster BROAD (réduire FP) selon le retour terrain."
            - "Ajouter corrélations réseau+endpoint si possible."
        - id: "P3"
          name: "Réduction surface d’attaque"
          actions:
            - "Plan de décommission Telnet."
            - "Contrôles compensatoires: bastion, MFA, segmentation, allowlist admin."

  outputs:
    expected_artifacts:
      - "Ticket incident (résumé, impact, actions prises)"
      - "Timeline d’évènements"
      - "Liste d’IOC internes (si observés)"
      - "Recommandations correctives (patch/hardening)"
