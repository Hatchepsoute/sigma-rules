# Generic IR Playbook (YAML) — CVE-2026-24061 (Telnetd Authentication Bypass)
# Usage: SOC-agnostic model (adaptable to TheHive/Cortex, SOAR platforms, or internal runbooks)
# Author: Adama ASSIONGBON | SOC & CTI Analyst Consultant
# Date: 2026-01-27
# Severity: CRITICAL (STRICT) / HIGH (BROAD)

playbook:
  id: "PB-CVE-2026-24061-EN"
  title: "Incident Response — CVE-2026-24061 (Telnetd Authentication Bypass)"
  version: "1.0.0"
  status: "ready"
  scope:
    platforms: ["linux"]
    detection_sources:
      sigma_rules:
        - name: "STRICT"
          file: "rules/remote_authentication_bypass_telnetd_cve_2026_24061.yml"
          severity: "CRITICAL"
          intent: "Direct exploit detection (login -f root spawned by telnetd)"
        - name: "BROAD"
          file: "rules/process_creation_linux_telnet_cve_2026_24061_broad.yml"
          severity: "HIGH"
          intent: "Hunting / post-exploitation / exploit variants"
      network:
        - "Inbound Telnet traffic TCP/23 to the asset"
      endpoint:
        - "Process creation telemetry (EDR/auditd/sysmon-for-linux)"
        - "Authentication logs (auth.log / secure / journalctl)"
  references:
    - "https://nvd.nist.gov/vuln/detail/CVE-2026-24061"
    - "https://github.com/SafeBreach-Labs/CVE-2026-24061"
    - "https://www.safebreach.com/blog/safebreach-labs-root-cause-analysis-and-poc-exploit-for-cve-2026-24061/"

  severity_logic:
    rules:
      STRICT: "CRITICAL"
      BROAD: "HIGH"
    escalation:
      - when: "STRICT triggered"
        then: "Immediate CRITICAL incident"
      - when: "BROAD triggered with network context (TCP/23) or repetition"
        then: "Escalate to Incident Response (HIGH)"
      - when: "BROAD followed by STRICT"
        then: "Confirmed compromise (CRITICAL)"

  objectives:
    - "Rapidly confirm exploitation and impact"
    - "Immediate containment to limit spread"
    - "Collect forensic evidence without destroying artifacts"
    - "Eradicate unauthorized access and restore a trusted state"
    - "Reduce attack surface (disable Telnet / restrict network exposure)"

  workflow:
    - phase: "1. Triage (0–30 min)"
      goals:
        - "Qualify the alert (STRICT vs BROAD)"
        - "Assess asset criticality and Telnet exposure"
        - "Determine if the incident is ongoing"
      tasks:
        - id: "T1"
          name: "Identify detection signal"
          actions:
            - "Collect triggering SIEM/EDR event (timestamp, host, user, command)."
            - "Record which rule fired: STRICT or BROAD."
          evidence:
            - "Raw event fields: ParentImage, Image, CommandLine, User, Hostname"
        - id: "T2"
          name: "Verify Telnet exposure"
          actions:
            - "Confirm Telnet exposure (TCP/23): firewall, ACL, NAT, VPN."
            - "List source IPs and enrichment (ASN / geo if available)."
          evidence:
            - "Firewall/IDS/Netflow logs: src_ip, dst_ip, dst_port=23"
        - id: "T3"
          name: "Initial decision"
          decision:
            - if: "STRICT"
              then: "Immediately move to Containment (phase 2) and escalate IR."
            - elif: "BROAD"
              then: "Validate context (network + repetition + command). If suspicious → phase 2; else → controlled hunting."
    - phase: "2. Containment (0–2 h)"
      goals:
        - "Stop unauthorized root access"
        - "Prevent propagation and C2"
      tasks:
        - id: "C1"
          name: "Isolate host"
          actions:
            - "Isolate host via EDR (network containment) if available."
            - "Otherwise apply temporary ACL/segmentation (block non-essential traffic)."
          notes:
            - "Top priority if STRICT."
        - id: "C2"
          name: "Block suspicious sources"
          actions:
            - "Block observed Telnet source IPs (temporary 24–72h) at firewall."
            - "Add to watchlist if blocking is not possible."
        - id: "C3"
          name: "Disable Telnet (if operationally possible)"
          actions:
            - "Stop and disable the telnetd service."
            - "Restrict to admin network if Telnet cannot be fully removed."
          caution:
            - "Coordinate with system owners to avoid production impact."

    - phase: "3. Investigation / Forensics (2–24 h)"
      goals:
        - "Confirm exploitation and determine scope"
        - "Identify post-exploitation (payloads, persistence, lateral movement)"
      tasks:
        - id: "I1"
          name: "Process tree analysis"
          actions:
            - "Reconstruct: telnetd → login → shell / tools."
            - "Search for commands: curl/wget/nc/python -c, /dev/tcp, | sh."
          evidence:
            - "Process tree / timeline"
        - id: "I2"
          name: "Authentication logs review"
          actions:
            - "Review /var/log/auth.log or /var/log/secure or journalctl."
            - "Look for Telnet sessions, root logins, abnormal login behavior."
        - id: "I3"
          name: "Persistence hunting"
          actions:
            - "Check crontab, systemd services, rc.local, SSH keys, added accounts."
            - "List new binaries/artifacts in /tmp, /var/tmp, /dev/shm."
        - id: "I4"
          name: "C2 / exfiltration review"
          actions:
            - "Inspect abnormal outbound connections after Telnet session."
            - "Check DNS, HTTP(S), uncommon ports, rare IPs."
        - id: "I5"
          name: "Scope assessment"
          actions:
            - "Identify other hosts exposed to Telnet."
            - "Search for the same detection sequence over the last 7–30 days."

    - phase: "4. Eradication & Recovery (24–72 h)"
      goals:
        - "Remove unauthorized access"
        - "Restore a trusted state"
      tasks:
        - id: "E1"
          name: "Remove malicious access"
          actions:
            - "Remove added accounts or SSH keys."
            - "Revoke compromised credentials/tokens."
        - id: "E2"
          name: "Patch / Hardening"
          actions:
            - "Apply security patches if available."
            - "Otherwise enforce mitigations (disable Telnet, network restrictions)."
        - id: "E3"
          name: "Credential rotation"
          actions:
            - "Rotate admin/root passwords and impacted service accounts."
            - "Rotate SSH keys if suspected."
        - id: "E4"
          name: "Recovery"
          actions:
            - "Restore from trusted backups if compromise is confirmed."
            - "Validate integrity (hashes, baseline, EDR scan)."

    - phase: "5. Post-Incident (72 h+)"
      goals:
        - "Capture lessons learned and strengthen controls"
      tasks:
        - id: "P1"
          name: "Reporting & timeline"
          actions:
            - "Build a timeline (initial access, exploitation, actions, containment, recovery)."
            - "Document internal IOCs (IPs, commands, accounts, files)."
        - id: "P2"
          name: "Detection improvement"
          actions:
            - "Tune BROAD rule (reduce false positives) based on findings."
            - "Add network+endpoint correlations if possible."
        - id: "P3"
          name: "Attack surface reduction"
          actions:
            - "Plan Telnet decommissioning."
            - "Implement compensating controls (bastion, MFA, segmentation, admin allowlists)."

  outputs:
    expected_artifacts:
      - "Incident ticket (summary, impact, actions taken)"
      - "Event timeline"
      - "Internal IOC list (if observed)"
      - "Remediation recommendations (patch/hardening)"
