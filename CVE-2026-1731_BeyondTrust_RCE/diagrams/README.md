# Diagram

ðŸ‘‰ðŸ¾ [ **French version available here** ](./README_FR.md)

## Detection Strategy

```mermaid
flowchart TB
  classDef broad fill:#e8f3ff,stroke:#1e78ff,stroke-width:1px,color:#0b2e63;
  classDef strict fill:#ffe9e9,stroke:#ff3b30,stroke-width:1px,color:#6b0b0b;
  classDef note fill:#f7f7f7,stroke:#999,stroke-dasharray: 3 3,color:#222;

  subgraph KC["CVE-2026-1731 BeyondTrust Kill Chain"]
    direction TB
    A["Recon: GET /get_portal_info"]:::broad
    B["Channel: WebSocket to /nw"]:::broad
    C["Exploit: remoteVersion injection (a[$(cmd)]0)"]:::strict
    D["Execution on Appliance: sh/bash + tool transfer"]:::broad
    E["Persistence: webshell-like PHP drop"]:::strict
    F["Post-Exploitation: C2, discovery, lateral movement"]:::note
  end

  subgraph RULES["Sigma Rules Coverage"]
    direction TB
    R1["WEB Recon to WS (BROAD)"]:::broad
    R2["WEB remoteVersion Injection (STRICT)"]:::strict
    R3["LINUX Suspicious Shell + Tooling (BROAD)"]:::broad
    R4["LINUX Webshell PHP Create (STRICT)"]:::strict
  end

  A --> B --> C --> D --> E --> F

  R1 -. detects .-> A
  R1 -. detects .-> B
  R2 -. confirms .-> C
  R3 -. indicates .-> D
  R4 -. confirms .-> E

  N1["Tip: Correlate same source IP for /get_portal_info then /nw within 1-5 minutes"]:::note
  A -.-> N1
