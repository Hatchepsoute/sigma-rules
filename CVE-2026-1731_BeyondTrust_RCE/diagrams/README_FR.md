# Diagramme

ðŸ‘‰ðŸ¾ [ **English version available here** ](./README.md)

## StratÃ©gie de dÃ©tection

```mermaid
flowchart TB
  classDef broad fill:#e8f3ff,stroke:#1e78ff,stroke-width:1px,color:#0b2e63;
  classDef strict fill:#ffe9e9,stroke:#ff3b30,stroke-width:1px,color:#6b0b0b;
  classDef note fill:#f7f7f7,stroke:#999,stroke-dasharray: 3 3,color:#222;

  subgraph KC["Kill Chain BeyondTrust CVE-2026-1731"]
    direction TB
    A["Recon: GET /get_portal_info"]:::broad
    B["Canal: WebSocket vers /nw"]:::broad
    C["Exploit: injection remoteVersion (a[$(cmd)]0)"]:::strict
    D["ExÃ©cution sur l'appliance: sh/bash + transfert d'outils"]:::broad
    E["Persistance: dÃ©pÃ´t de webshell PHP"]:::strict
    F["Post-exploitation: C2, discovery, mouvement latÃ©ral"]:::note
  end

  subgraph RULES["Couverture Sigma"]
    direction TB
    R1["WEB Recon vers WS (BROAD)"]:::broad
    R2["WEB Injection remoteVersion (STRICT)"]:::strict
    R3["LINUX Shell suspect + outils (BROAD)"]:::broad
    R4["LINUX CrÃ©ation webshell PHP (STRICT)"]:::strict
  end

  A --> B --> C --> D --> E --> F

  R1 -. dÃ©tecte .-> A
  R1 -. dÃ©tecte .-> B
  R2 -. confirme .-> C
  R3 -. indique .-> D
  R4 -. confirme .-> E

  N1["Astuce: corrÃ©ler la mÃªme IP source pour /get_portal_info puis /nw dans une fenÃªtre de 1 Ã  5 minutes"]:::note
  A -.-> N1
