# CVE-2026-1731 - Pack de dÃ©tection BeyondTrust RCE

ğŸ‘‰ğŸ¾ [**English version available here**](README.md)

Ce dÃ©pÃ´t contient un pack Sigma communautaire pour dÃ©tecter lâ€™exploitation de la vulnÃ©rabilitÃ© CVE-2026-1731 affectant BeyondTrust Remote Support / PRA.

La vulnÃ©rabilitÃ© permet une exÃ©cution de code Ã  distance prÃ©-authentifiÃ©e via une mauvaise gestion du paramÃ¨tre `remoteVersion` sur lâ€™endpoint WebSocket `/nw`.

PoC public :
https://github.com/win3zz/CVE-2026-1731

---

# ğŸ¯ StratÃ©gie de dÃ©tection

Le pack couvre toute la chaÃ®ne dâ€™attaque :

Reconnaissance â†’ WebSocket â†’ Injection â†’ ExÃ©cution â†’ Persistance

Il repose sur une approche BROAD / STRICT.

---

# ğŸ“‚ RÃ¨gles incluses

---

## 1ï¸âƒ£ WEB - Reconnaissance vers WebSocket (BROAD)

### DÃ©tecte :
- RequÃªtes GET vers `/get_portal_info`
- RequÃªtes GET vers `/nw`

### IntÃ©rÃªt :
Les attaquants interrogent `/get_portal_info` avant dâ€™Ã©tablir un canal WebSocket malveillant.

### Objectif :
Alerte prÃ©coce / hunting.

---

## 2ï¸âƒ£ WEB - Injection remoteVersion (STRICT)

### DÃ©tecte :
- Cible `/nw`
- ParamÃ¨tre `remoteVersion`
- Pattern dâ€™injection `a[$(`

AlignÃ© avec le PoC public.

### Objectif :
Confirmation dâ€™exploitation.

---

## 3ï¸âƒ£ LINUX - Shell suspect + outils (BROAD)

### DÃ©tecte :
- Lancement de bash / sh
- Usage de curl, wget, nc, python, bash -c

### IntÃ©rÃªt :
Indique une exÃ©cution de commande rÃ©ussie sur lâ€™appliance.

---

## 4ï¸âƒ£ LINUX - CrÃ©ation Webshell PHP (STRICT)

### DÃ©tecte :
- CrÃ©ation de fichiers `.php`
- Dans des rÃ©pertoires web

### IntÃ©rÃªt :
DÃ©tection de persistance post-exploitation.

---

# ğŸ§  Philosophie

BROAD :
- Indicateurs prÃ©coces
- Hunting
- Risque FP plus Ã©levÃ©

STRICT :
- Indicateurs forts
- Haute confiance
- Escalade immÃ©diate recommandÃ©e

---

# âš ï¸ Recommandations SOC

Avant mise en production :

- VÃ©rifier le mapping des champs logs
- Exclure les tests sÃ©curitÃ© autorisÃ©s
- CorrÃ©ler Web + Linux si possible

---

# ğŸ“Š MaturitÃ©

| RÃ¨gle | Statut |
|--------|--------|
| WEB Recon | experimental |
| WEB Injection | testing |
| LINUX Shell | experimental |
| LINUX Webshell | testing |

---

# ğŸš€ Workflow recommandÃ©

1. DÃ©clenchement rÃ¨gle STRICT Web â†’ investigation immÃ©diate.
2. VÃ©rification activitÃ© shell appliance.
3. Recherche webshell.
4. Analyse connexions sortantes.
5. Rotation des identifiants et isolement.

---

Pack communautaire orientÃ© dÃ©tection SOC.
Les retours et amÃ©liorations sont les bienvenus.
