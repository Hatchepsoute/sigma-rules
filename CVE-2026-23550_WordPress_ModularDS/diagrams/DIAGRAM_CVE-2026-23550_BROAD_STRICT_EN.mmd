%% CVE-2026-23550 - Mermaid Attack & Detection Flow (EN)
flowchart TB
  %% Styles (GitHub compatible)
  classDef broad fill:#fff3cd,stroke:#b8860b,stroke-width:1px,color:#111;
  classDef strict fill:#f8d7da,stroke:#b02a37,stroke-width:1px,color:#111;
  classDef action fill:#e2e3e5,stroke:#6c757d,stroke-width:1px,color:#111;
  classDef data fill:#d1ecf1,stroke:#0c5460,stroke-width:1px,color:#111;

  A[Internet attacker] --> B[Probe WordPress REST]
  B --> C[GET /?rest_route=/]
  B --> D[GET /wp-content/plugins/modular-connector/readme.txt]
  B --> E[POST /?rest_route=/api/modular-connector/login&origin=mo]
  E --> F{HTTP 200/302?}
  F -->|Yes| G[Admin session cookie issued]
  F -->|No| H[Failed / blocked]

  %% Detections
  C --> DB1[BROAD: REST enumeration]:::broad
  D --> DB2[BROAD: Plugin readme.txt reconnaissance]:::broad
  E --> DS1[STRICT: POST + endpoint + origin=mo + success status]:::strict
  E --> DB3[BROAD: Targeted endpoint probing]:::broad

  %% Response guidance
  DS1 --> R1[IR: Contain + disable/patch plugin]:::action
  R1 --> R2[Investigate: users, wp-admin access, file integrity]:::action
  DB1 --> H1[Hunting: look for scan waves, abusive IPs]:::action
  DB2 --> H2[Validate exposure: is plugin installed?]:::action
  DB3 --> H3[Escalate if repeated or paired with wp-admin access]:::action

  %% Data sources
  subgraph Logs
    L1[Webserver logs (Apache/Nginx/IIS)]:::data
    L2[WAF/Reverse proxy logs]:::data
  end
  L1 -. supports .-> DB1
  L1 -. supports .-> DB2
  L1 -. supports .-> DB3
  L1 -. supports .-> DS1
  L2 -. supports .-> DS1
