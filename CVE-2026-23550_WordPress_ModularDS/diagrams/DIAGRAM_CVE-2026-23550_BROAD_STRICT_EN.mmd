%% CVE-2026-23550 - Mermaid Attack & Detection Flow (EN) - GitHub Safe
flowchart TB
  classDef broad fill:#fff3cd,stroke:#b8860b,stroke-width:1px,color:#111
  classDef strict fill:#f8d7da,stroke:#b02a37,stroke-width:1px,color:#111
  classDef action fill:#e2e3e5,stroke:#6c757d,stroke-width:1px,color:#111
  classDef data fill:#d1ecf1,stroke:#0c5460,stroke-width:1px,color:#111

  A[Internet attacker] --> B[Probe WordPress REST]
  B --> C[GET rest_route root]
  B --> D[GET plugin readme.txt]
  B --> E[POST vulnerable login route with origin=mo]
  E --> F{HTTP 200 or 302}
  F -->|Yes| G[Admin session cookie issued]
  F -->|No| H[Failed or blocked]

  C --> DB1[BROAD: REST enumeration]
  D --> DB2[BROAD: Plugin reconnaissance]
  E --> DB3[BROAD: Targeted endpoint probing]
  E --> DS1[STRICT: Exploit pattern - POST, endpoint, origin=mo, success]

  DS1 --> R1[IR: Contain and patch or disable plugin]
  R1 --> R2[Investigate: users, wp-admin access, file integrity]
  DB1 --> H1[Hunting: scan waves, abusive IPs]
  DB2 --> H2[Validate exposure: plugin installed]
  DB3 --> H3[Escalate if repeated or paired with wp-admin access]

  subgraph "Logs"
    L1[Webserver logs: Apache, Nginx, IIS]
    L2[WAF or reverse proxy logs]
  end

  L1 -. supports .-> DB1
  L1 -. supports .-> DB2
  L1 -. supports .-> DB3
  L1 -. supports .-> DS1
  L2 -. supports .-> DS1

  class DB1,DB2,DB3 broad
  class DS1 strict
  class R1,R2,H1,H2,H3 action
  class L1,L2 data
