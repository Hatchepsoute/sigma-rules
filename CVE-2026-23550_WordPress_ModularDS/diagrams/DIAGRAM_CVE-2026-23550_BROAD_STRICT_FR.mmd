%% CVE-2026-23550 - Mermaid Flux Attaque & Détection (FR)
flowchart TB
  %% Styles (GitHub compatible)
  classDef broad fill:#fff3cd,stroke:#b8860b,stroke-width:1px,color:#111;
  classDef strict fill:#f8d7da,stroke:#b02a37,stroke-width:1px,color:#111;
  classDef action fill:#e2e3e5,stroke:#6c757d,stroke-width:1px,color:#111;
  classDef data fill:#d1ecf1,stroke:#0c5460,stroke-width:1px,color:#111;

  A[Attaquant Internet] --> B[Scan REST WordPress]
  B --> C[GET /?rest_route=/]
  B --> D[GET /wp-content/plugins/modular-connector/readme.txt]
  B --> E[POST /?rest_route=/api/modular-connector/login&origin=mo]
  E --> F{HTTP 200/302 ?}
  F -->|Oui| G[Cookie session admin émis]
  F -->|Non| H[Echec / bloqué]

  %% Détections
  C --> DB1[BROAD: Enumeration REST]:::broad
  D --> DB2[BROAD: Reconnaissance readme.txt plugin]:::broad
  E --> DS1[STRICT: POST + endpoint + origin=mo + statut succès]:::strict
  E --> DB3[BROAD: Probing ciblé endpoint vulnérable]:::broad

  %% Réponse
  DS1 --> R1[RI: Confinement + désactivation/patch plugin]:::action
  R1 --> R2[Investigation: comptes, accès wp-admin, intégrité fichiers]:::action
  DB1 --> H1[Hunting: vagues de scan, IP abusives]:::action
  DB2 --> H2[Valider exposition: plugin installé ?]:::action
  DB3 --> H3[Escalader si répétitions ou corrélation avec wp-admin]:::action

  %% Sources de logs
  subgraph Logs
    L1[Logs web (Apache/Nginx/IIS)]:::data
    L2[Logs WAF / Reverse proxy]:::data
  end
  L1 -. supporte .-> DB1
  L1 -. supporte .-> DB2
  L1 -. supporte .-> DB3
  L1 -. supporte .-> DS1
  L2 -. supporte .-> DS1
