# Playbook TheHive (YAML) - CVE-2026-23550 - WordPress Modular DS
# Objectif : Workflow de triage + confinement pour alertes BROAD/STRICT issues des règles Sigma.
# Note : Modèle générique à adapter aux mappings de votre instance TheHive.

playbook:
  name: "CVE-2026-23550 - WordPress Modular DS - Playbook de Réponse"
  version: "1.0"
  description: "Workflow de triage et réponse pour suspicion d'exploitation CVE-2026-23550 (session admin non authentifiée via endpoint REST)."
  severity_mapping:
    BROAD: "Medium"
    STRICT: "High"

case_template:
  title: "[CVE-2026-23550] WordPress Modular DS - Suspicion d'Exploitation"
  description: |
    Les alertes indiquent une possible exploitation de CVE-2026-23550 affectant le plugin WordPress Modular DS (Modular Connector). Signaux clés : POST vers ?rest_route=/api/modular-connector/login avec origin=mo et statut succès.
  tlp: 2
  pap: 2
  tags:
    - "cve-2026-23550"
    - "wordpress"
    - "modulards"
    - "web"
    - "t1190"
  tasks:
    - title: "Triage - Valider le contexte de l’alerte"
      description: |
        - Confirmer la règle déclenchée (BROAD vs STRICT)
        - Capturer : IP source, user-agent, URL, méthode, statut, timestamps
        - Vérifier si le trafic est externe et non lié à un scanner connu
      owner: "SOC"
    - title: "Scope - Identifier les actifs impactés"
      description: |
        - Identifier le site WordPress / vhost et l’environnement d’hébergement
        - Vérifier si le plugin Modular DS est installé
        - Vérifier la version (<=2.5.1 vulnérable)
      owner: "SOC"
    - title: "Confinement - Réduire l’exposition"
      description: |
        - Si STRICT ou BROAD répété : bloquer l’IP source au WAF/reverse proxy
        - Désactiver temporairement le plugin Modular DS (si installé)
        - Restreindre l’accès public aux routes REST si possible
      owner: "IR"
    - title: "Investigation - Rechercher des preuves de takeover"
      description: |
        - Examiner les logs d’accès /wp-admin autour de la fenêtre de l’alerte
        - Auditer les utilisateurs WordPress (admins non autorisés)
        - Vérifier changements plugins/thèmes et uploads récents
        - Contrôler l’intégrité des fichiers dans wp-content (plugins, themes, uploads)
      owner: "IR"
    - title: "Éradication & Restauration"
      description: |
        - Patcher/mettre à jour vers 2.5.2+ (ou supprimer le plugin)
        - Rotation des identifiants admin, clés API, mots de passe DB si risque confirmé
        - Invalidation des sessions (forcer reconnexion)
        - Restaurer un backup sain si compromission confirmée
      owner: "IR"
    - title: "Hunting - Étendre la recherche"
      description: |
        - Rechercher d’autres hôtes recevant des requêtes similaires :
          - rest_route=/api/modular-connector/login
          - origin=mo
          - modular-connector/readme.txt
        - Identifier vagues de scan et patterns IOC (IP/UA)
      owner: "ThreatHunting"
    - title: "Retour d’expérience / Reporting"
      description: |
        - Documenter la timeline et les actions
        - Ajouter des notes de tuning (faux positifs)
        - Partager les améliorations de détection avec la communauté (GitHub PR)
      owner: "SOC"

observables_suggestions:
  - type: "ip"
    description: "Adresse IP source depuis les logs web"
  - type: "url"
    description: "URL / query contenant rest_route et origin"
  - type: "other"
    description: "Chaîne User-Agent"
  - type: "hostname"
    description: "Hostname / vhost WordPress impacté"
