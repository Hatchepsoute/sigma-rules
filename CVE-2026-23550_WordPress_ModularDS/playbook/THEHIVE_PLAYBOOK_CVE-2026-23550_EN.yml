# TheHive Playbook (YAML) - CVE-2026-23550 - WordPress Modular DS
# Purpose: Triage + containment workflow for alerts raised by Sigma BROAD/STRICT rules.
# Note: This is a generic playbook template. Adapt fields/mappings to your TheHive instance.

playbook:
  name: "CVE-2026-23550 - WordPress Modular DS - Response Playbook"
  version: "1.0"
  description: "Triage and response workflow for suspected CVE-2026-23550 exploitation (unauthenticated admin session via REST endpoint)."
  severity_mapping:
    BROAD: "Medium"
    STRICT: "High"

case_template:
  title: "[CVE-2026-23550] WordPress Modular DS - Suspected Exploitation"
  description: |
    Alerts indicate potential exploitation of CVE-2026-23550 affecting the WordPress Modular DS (Modular Connector) plugin.  Key signals: POST to ?rest_route=/api/modular-connector/login with origin=mo and success status.
  tlp: 2
  pap: 2
  tags:
    - "cve-2026-23550"
    - "wordpress"
    - "modulards"
    - "web"
    - "t1190"
  tasks:
    - title: "Triage - Validate alert context"
      description: |
        - Confirm the triggering rule (BROAD vs STRICT)
        - Capture: source IP, user-agent, URL, method, status, timestamps
        - Check if traffic is external and not from known scanners
      owner: "SOC"
    - title: "Scope - Identify impacted assets"
      description: |
        - Identify the WordPress site / vhost and hosting environment
        - Verify whether Modular DS plugin is installed
        - Check plugin version (<=2.5.1 is vulnerable)
      owner: "SOC"
    - title: "Containment - Reduce exposure"
      description: |
        - If STRICT or repeated BROAD: block source IP at WAF/reverse proxy
        - Temporarily disable the Modular DS plugin (if installed)
        - Restrict public access to REST routes if feasible
      owner: "IR"
    - title: "Investigation - Look for takeover evidence"
      description: |
        - Review /wp-admin access logs around the alert timeframe
        - Audit WordPress users for unauthorized admin accounts
        - Check plugin/theme changes and recent uploads
        - Review file integrity on wp-content (plugins, themes, uploads)
      owner: "IR"
    - title: "Eradication & Recovery"
      description: |
        - Patch/upgrade plugin to 2.5.2+ (or remove)
        - Rotate admin credentials, API keys, DB passwords if risk confirmed
        - Invalidate sessions (force re-login)
        - Restore from clean backup if compromise is confirmed
      owner: "IR"
    - title: "Hunting - Expand search"
      description: |
        - Search for other hosts receiving similar requests:
          - rest_route=/api/modular-connector/login
          - origin=mo
          - modular-connector/readme.txt
        - Identify scan waves and related IOCs (IP/UA patterns)
      owner: "ThreatHunting"
    - title: "Lessons learned / Reporting"
      description: |
        - Document timeline and actions taken
        - Add tuning notes for false positives
        - Share detection improvements with the community (GitHub PR)
      owner: "SOC"

observables_suggestions:
  - type: "ip"
    description: "Source IP address from web logs"
  - type: "url"
    description: "Requested URL / query containing rest_route and origin"
  - type: "other"
    description: "User-Agent string"
  - type: "hostname"
    description: "Impacted WordPress hostname / vhost"
