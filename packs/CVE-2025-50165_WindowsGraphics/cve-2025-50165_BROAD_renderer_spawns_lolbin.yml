title: CVE-2025-50165 (BROAD) - Renderer Spawns Suspicious Non-Graphical Process
id: 6c9e3f21-3a0e-4a1b-9f2a-9a7f6b7d1c02
status: experimental
description: |-
  [EN] Broad detection for CVE-2025-50165-related client-side exploitation patterns.
  Detects any suspicious non-graphical child process spawned by a document or image rendering context
  (Office applications, PDF readers, email clients, or Windows preview).
  This rule focuses on maximum coverage and is suitable for threat hunting or high-risk environments.

  [FR] Détection large pour des scénarios d’exploitation côté client liés à CVE-2025-50165.
  Détecte tout processus enfant non graphique lancé par un contexte de rendu de document ou d’image
  (applications Office, lecteurs PDF, clients mail ou prévisualisation Windows).
  Cette règle vise une couverture maximale et est adaptée au threat hunting ou aux environnements à haut risque.
author: |
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025/12/18
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-50165
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-50165
  - https://www.zscaler.com/blogs/security-research/cve-2025-50165-critical-flaw-windows-graphics-component
  - https://github.com/encrypter15/CVE-2025-50165-x64-Exploit
tags:
  - cve.2025.50165
  - attack.execution
  - attack.t1203
  - attack.t1059
logsource:
  product: windows
  category: process_creation
detection:
  parent_renderers:
    ParentImage|endswith:
      - '\explorer.exe'
      - '\dllhost.exe'
      - '\prevhost.exe'
      - '\outlook.exe'
      - '\thunderbird.exe'
      - '\winword.exe'
      - '\excel.exe'
      - '\powerpnt.exe'
      - '\msaccess.exe'
      - '\onenote.exe'
      - '\acrord32.exe'
      - '\acrobat.exe'
      - '\sumatrapdf.exe'
      - '\foxitpdfreader.exe'
      - '\pdfxcview.exe'
      - '\microsoft.photos.exe'

  suspicious_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\schtasks.exe'
      - '\bitsadmin.exe'
      - '\certutil.exe'
      - '\wmic.exe'
      - '\curl.exe'
      - '\wget.exe'
      - '\calc.exe'

  condition: parent_renderers and suspicious_child
falsepositives:
  - "Legitimate document automation, OCR, RPA, DLP or eDiscovery workflows spawning system utilities."
  - "Rare enterprise add-ins for Office or PDF processing."
  - "[FR] Automatisation documentaire légitime (OCR, RPA, DLP, eDiscovery) lançant des utilitaires système."
  - "Add-ins Office ou PDF spécifiques à l’entreprise."
level: medium
