title: CVE-2025-50165 (STRICT) - Renderer Spawns LOLBin with Suspicious CommandLine
id: 8d8b3a25-6a34-4c8c-9a36-2b0e5f0c1f6c
status: experimental
description: |-
  [EN] Strict detection for CVE-2025-50165-related client-side exploitation patterns: a document/image rendering context spawns a LOLBin
  AND the child process command line contains suspicious execution patterns (encoded PowerShell, IEX, remote script, rundll32 DLL call, mshta URL, etc.).
  This reduces false positives compared to broad parent->child detections.

  [FR] Détection stricte pour des patterns d’exploitation côté client liés à CVE-2025-50165 : un contexte de rendu document/image lance un LOLBin
  ET la ligne de commande du processus enfant contient des motifs suspects (PowerShell encodé, IEX, script distant, rundll32 avec DLL, mshta avec URL, etc.).
  Cette approche réduit les faux positifs par rapport à une détection large parent->child.
author: |
  Adama Assiongbon (SOC/CTI Analyst Consultant)
  LinkedIn: https://www.linkedin.com/in/adama-assiongbon-9029893a/
date: 2025/12/18
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-50165
  - https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-50165
  - https://www.zscaler.com/blogs/security-research/cve-2025-50165-critical-flaw-windows-graphics-component
  - https://github.com/encrypter15/CVE-2025-50165-x64-Exploit
tags:
  - cve.2025.50165
  - attack.execution
  - attack.t1203
  - attack.t1059
logsource:
  product: windows
  category: process_creation
detection:
  parent_renderers:
    ParentImage|endswith:
      - '\explorer.exe'
      - '\dllhost.exe'
      - '\prevhost.exe'
      - '\outlook.exe'
      - '\thunderbird.exe'
      - '\winword.exe'
      - '\excel.exe'
      - '\powerpnt.exe'
      - '\msaccess.exe'
      - '\onenote.exe'
      - '\acrord32.exe'
      - '\acrobat.exe'
      - '\sumatrapdf.exe'
      - '\foxitpdfreader.exe'
      - '\pdfxcview.exe'
      - '\microsoft.photos.exe'

  lolbin_child:
    Image|endswith:
      - '\powershell.exe'
      - '\pwsh.exe'
      - '\cmd.exe'
      - '\mshta.exe'
      - '\rundll32.exe'
      - '\regsvr32.exe'
      - '\wscript.exe'
      - '\cscript.exe'
      - '\schtasks.exe'
      - '\bitsadmin.exe'
      - '\certutil.exe'
      - '\wmic.exe'
      - '\curl.exe'
      - '\wget.exe'

  suspicious_cli:
    CommandLine|contains:
      # PowerShell encoded / common in-memory patterns
      - ' -enc '
      - ' -encodedcommand '
      - 'FromBase64String'
      - 'IEX'
      - 'Invoke-Expression'
      - 'DownloadString'
      - 'Invoke-WebRequest'
      - 'iwr '
      - 'New-Object Net.WebClient'
      # mshta remote execution
      - 'mshta http'
      - 'mshta https'
      # rundll32 DLL execution
      - 'rundll32 '
      - '.dll'
      # regsvr32 squiblydoo style
      - 'regsvr32 '
      - '/i:'
      - 'scrobj.dll'
      # scripting engines calling remote content
      - 'wscript '
      - 'cscript '

  condition: parent_renderers and lolbin_child and suspicious_cli
falsepositives:
  - "Some IT scripts or enterprise automation tools may use PowerShell with encoded commands (rare; tune by signer/path/parent command line)."
  - "Legitimate admin automation launched from Office/PDF is uncommon; validate in your baseline before excluding."
  - "[FR] Certains scripts IT ou outils d’automatisation d’entreprise peuvent utiliser PowerShell avec des commandes encodées (cas rare ; affiner la détection via le signataire, le chemin ou la ligne de commande parente)."
  - "L’automatisation administrative légitime lancée depuis Office ou un PDF est peu courante ; valider ce comportement dans votre référentiel/baseline avant toute exclusion."
level: high
