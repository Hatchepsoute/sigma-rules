![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)
![Windows](https://img.shields.io/badge/Platform-Windows-informational)
![CVE](https://img.shields.io/badge/CVE-2025--50165-critical)
![Detection](https://img.shields.io/badge/Detection-Behavioral-orange)
![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)
![License](https://img.shields.io/badge/License-MIT-green)
[![Sigma](https://img.shields.io/badge/Sigma-Rules-blue)](https://github.com/SigmaHQ/sigma)
[![CVE](https://img.shields.io/badge/CVE-2025--50165-critical)](https://nvd.nist.gov/vuln/detail/CVE-2025-50165)
[![SOC](https://img.shields.io/badge/Use--case-SOC%20%7C%20CTI-blueviolet)](https://attack.mitre.org/)


# ğŸ›‘ CVE-2025-50165 â€“ Behavioral Detection of Weaponized Image Exploitation (Sigma Rules)

## ğŸ¯ Goal
This repository provides **two complementary Sigma rules** to detect successful exploitation of **CVE-2025-50165**, a critical vulnerability in the Windows Graphics Component (`windowscodecs.dll`).

The vulnerability allows **remote code execution (RCE)** when a **weaponized JPEG image is rendered**, even without macros or executables.

---

## ğŸ§  Detection Philosophy

> âŒ We do not detect the image  
> âœ… We detect **postâ€‘exploitation behavior**

Key signal:
ğŸ‘‰ A document/image renderer spawning a **nonâ€‘graphical process (LOLBin)**.

---

## ğŸ§¬ Attack Scenario

1. Attacker delivers a weaponized JPEG (standalone or embedded).
2. Victim opens or previews the file.
3. Windows renders the image via `windowscodecs.dll`.
4. CVEâ€‘2025â€‘50165 is exploited.
5. Arbitrary code execution occurs.
6. Renderer spawns `powershell.exe`, `cmd.exe`, `mshta.exe`, etc.
7. ğŸš¨ Sigma rule triggers.

---

## ğŸ›¡ï¸ The Two Sigma Rules

### ğŸ”¹ BROAD Rule
**Purpose:** maximum coverage (hunting)

**Logic:**
Renderer â†’ LOLBin

**Pros:**
- Detects silent exploits
- Ideal for threat hunting

**Cons:**
- More noise

---

### ğŸ”¹ STRICT Rule
**Purpose:** highâ€‘fidelity detection (production)

**Logic:**
Renderer â†’ LOLBin **AND** malicious command line

**Pros:**
- Low false positives
- Actionable alerts

**Cons:**
- May miss minimal payloads

---

## ğŸ“Š BROAD vs STRICT

| Criteria | BROAD | STRICT |
|--------|-------|--------|
| Coverage | High | Medium |
| Noise | Medium | Low |
| Production | âš ï¸ | âœ… |
| Hunting | âœ… | âš ï¸ |

---

## ğŸ” Sigma to SIEM Conversion

### Recommended Tool
```bash
pip install sigma-cli
```

### Examples
```bash
sigma convert -t splunk rule.yml
sigma convert -t elasticsearch rule.yml
sigma convert -t sentinel rule.yml
```

### EDR / Wazuh
- Based on Parent Process, Child Process, CommandLine
- Implemented as behavioral rules

---

## ğŸ“Œ SOC Recommendation
- Use STRICT for production alerts
- Use BROAD for hunting
