# ğŸ›‘ CVE-2025-50165 â€“ DÃ©tection comportementale dâ€™images piÃ©gÃ©es (Sigma Rules)

## ğŸ¯ Objectif
Ce dÃ©pÃ´t fournit **deux rÃ¨gles Sigma complÃ©mentaires** permettant de dÃ©tecter lâ€™exploitation rÃ©ussie de la vulnÃ©rabilitÃ© critique **CVE-2025-50165**, affectant le composant graphique Windows (`windowscodecs.dll`).

Cette vulnÃ©rabilitÃ© permet lâ€™**exÃ©cution de code arbitraire (RCE)** lors du **rendu dâ€™une image JPEG piÃ©gÃ©e**, mÃªme sans clic explicite, macro ou exÃ©cutable.

---

## ğŸ§  Principe de dÃ©tection (approche Blue Team)

> âŒ On ne dÃ©tecte pas lâ€™image  
> âœ… On dÃ©tecte **le comportement postâ€‘exploitation**

Signal clÃ© :
ğŸ‘‰ Un moteur de rendu (Word, PDF, Outlook, Preview Windows) qui lance un **binaire non graphique (LOLBin)**.

---

## ğŸ§¬ ScÃ©nario dâ€™attaque (simplifiÃ©)

1. Lâ€™attaquant envoie une **image JPEG piÃ©gÃ©e** (seule ou intÃ©grÃ©e dans Word/PDF).
2. La victime ouvre ou prÃ©visualise le fichier.
3. Windows rend lâ€™image via `windowscodecs.dll`.
4. Exploitation de CVEâ€‘2025â€‘50165 (corruption mÃ©moire).
5. ExÃ©cution de code arbitraire.
6. Le processus de rendu lance `powershell.exe`, `cmd.exe`, `mshta.exe`, etc.
7. ğŸš¨ DÃ©clenchement de la rÃ¨gle Sigma.

---

## ğŸ›¡ï¸ Les deux rÃ¨gles Sigma

### ğŸ”¹ RÃ¨gle BROAD
**Objectif :** couverture maximale (hunting)

**Logique :**
Renderer â†’ LOLBin

**Avantages :**
- DÃ©tecte exploits silencieux et payloads minimalistes
- IdÃ©ale pour threat hunting

**Limites :**
- Plus de faux positifs

---

### ğŸ”¹ RÃ¨gle STRICT
**Objectif :** dÃ©tection haute fidÃ©litÃ© (production)

**Logique :**
Renderer â†’ LOLBin **ET** ligne de commande malveillante

**Avantages :**
- TrÃ¨s faible bruit
- Alerte immÃ©diatement exploitable

**Limites :**
- Peut manquer certains payloads trÃ¨s simples

---

## ğŸ“Š DiffÃ©rence BROAD vs STRICT

| CritÃ¨re | BROAD | STRICT |
|-------|-------|--------|
| Couverture | Ã‰levÃ©e | Moyenne |
| Bruit | Moyen | Faible |
| Production SOC | âš ï¸ | âœ… |
| Hunting | âœ… | âš ï¸ |

---

## ğŸ” Conversion Sigma vers SIEM

### Outil recommandÃ©
```bash
pip install sigma-cli
```

### Exemples
```bash
sigma convert -t splunk rule.yml
sigma convert -t elasticsearch rule.yml
sigma convert -t sentinel rule.yml
```

### EDR / Wazuh
- BasÃ© sur Parent Process, Child Process et CommandLine
- ImplÃ©mentation via rÃ¨gles comportementales

---

## ğŸ“Œ Recommandation SOC
- STRICT â†’ alertes production
- BROAD â†’ hunting avancÃ©
