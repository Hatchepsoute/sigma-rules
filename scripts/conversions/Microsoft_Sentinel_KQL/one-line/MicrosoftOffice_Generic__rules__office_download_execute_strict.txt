EventID == 1 and ((ParentImage endswith "\\WINWORD.EXE" or ParentImage endswith "\\EXCEL.EXE" or ParentImage endswith "\\POWERPNT.EXE" or ParentImage endswith "\\OUTLOOK.EXE" or ParentImage endswith "\\MSACCESS.EXE" or ParentImage endswith "\\VISIO.EXE" or ParentImage endswith "\\ONENOTE.EXE") and (Image endswith "\\powershell.exe" or Image endswith "\\pwsh.exe" or Image endswith "\\cmd.exe" or Image endswith "\\mshta.exe" or Image endswith "\\rundll32.exe" or Image endswith "\\wscript.exe" or Image endswith "\\cscript.exe" or Image endswith "\\regsvr32.exe" or Image endswith "\\bitsadmin.exe" or Image endswith "\\certutil.exe") and ((CommandLine contains "http://" or CommandLine contains "https://" or CommandLine contains "Invoke-WebRequest" or CommandLine contains "Invoke-RestMethod" or CommandLine contains " iwr " or CommandLine contains " irm " or CommandLine contains "curl " or CommandLine contains "wget " or CommandLine contains "Start-BitsTransfer" or CommandLine contains "bitsadmin" or CommandLine contains "certutil" or CommandLine contains " -urlcache" or CommandLine contains " -split" or CommandLine contains " /transfer") or (CommandLine contains " -enc" or CommandLine contains " -e " or CommandLine contains "EncodedCommand" or CommandLine contains "FromBase64String" or CommandLine contains " IEX" or CommandLine contains "Invoke-Expression" or CommandLine contains "DownloadString" or CommandLine contains "DownloadFile")))
