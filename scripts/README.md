# ğŸ“˜ Sigma Rules Repository - SOC & CTI Automation

# ğŸ› ï¸ Sigma Automation Scripts - SOC Usage Guide 

This repository provides **two Bash scripts** designed for SOC / CTI teams to **validate** and **convert Sigma rules** across multiple SIEM platforms in a controlled and repeatable way.

These scripts are intended to be executed from the `scripts/` directory.

---

## ğŸ“„ Scripts Overview

### 1ï¸âƒ£ `validate_all_rules.sh` - Sigma Quality Gate

**Purpose**
- Validate all Sigma rules in the repository
- Detect:
  - syntax errors
  - invalid detection conditions
  - invalid tags (MITRE ATT&CK, custom tags, etc.)

**What it does**
- Recursively scans all `**/rules/*.yml`
- Runs `sigma check`
- Can be used as a **CI quality gate**
- Returns a non-zero exit code if issues are detected (CI fail)

---

### 2ï¸âƒ£ `convert_all_rules.sh` â€“ Multiâ€‘SIEM Rule Conversion

**Purpose**
- Convert validated Sigma rules into **SIEMâ€‘specific query languages**
- Generate copy/pasteâ€‘ready queries for SOC analysts

**Supported targets**
- OpenSearch / Lucene
- Splunk
- Elastic / ElastAlert
- Elastic EQL
- RSA NetWitness
- Microsoft Sentinel (KQL)

**Output**
```
scripts/conversions/<SIEM>/{raw,one-line}
```

---

## â–¶ï¸ How to Execute

```bash
cd scripts
chmod +x validate_all_rules.sh convert_all_rules.sh
./validate_all_rules.sh
./convert_all_rules.sh
```

---

## ğŸ’» Supported Environments

- Linux (Ubuntu, Debian, Kali)
- macOS (limited support)
- Windows via WSL

**Requirements**
- Bash 4+
- Python 3.9+
- sigma-cli



---

# ğŸ› ï¸ Sigma Automation Scripts â€“ SOC Usage Guide (EN)

This repository provides **two Bash scripts** designed for SOC / CTI teams to **validate** and **convert Sigma rules** across multiple SIEM platforms in a controlled and repeatable way.

These scripts are intended to be executed from the `scripts/` directory.

---

## ğŸ“„ Scripts Overview

### 1ï¸âƒ£ `validate_all_rules.sh` â€“ Sigma Quality Gate

**Purpose**
- Validate all Sigma rules in the repository
- Detect:
  - syntax errors
  - invalid detection conditions
  - invalid tags (MITRE ATT&CK, custom tags, etc.)

**What it does**
- Recursively scans all `**/rules/*.yml`
- Runs `sigma check`
- Can be used as a **CI quality gate**
- Returns a non-zero exit code if issues are detected (CI fail)

---

### 2ï¸âƒ£ `convert_all_rules.sh` â€“ Multiâ€‘SIEM Rule Conversion

**Purpose**
- Convert validated Sigma rules into **SIEMâ€‘specific query languages**
- Generate copy/pasteâ€‘ready queries for SOC analysts

**Supported targets**
- OpenSearch / Lucene
- Splunk
- Elastic / ElastAlert
- Elastic EQL
- RSA NetWitness
- Microsoft Sentinel (KQL)

**Output**
```
scripts/conversions/<SIEM>/{raw,one-line}
```

---

## â–¶ï¸ How to Execute

```bash
cd scripts
chmod +x validate_all_rules.sh convert_all_rules.sh
./validate_all_rules.sh
./convert_all_rules.sh
```

---

## ğŸ’» Supported Environments

- Linux (Ubuntu, Debian, Kali)
- macOS (limited support)
- Windows via WSL

**Requirements**
- Bash 4+
- Python 3.9+
- sigma-cli

---

## ğŸ“‚ Understanding `raw/` vs `one-line/` Directories

When running `convert_all_rules.sh`, two output directories may be generated for each SIEM target:

### ğŸ”¹ `raw/` â€“ Native Sigma Output (Default)
- Exact output produced by `sigma convert`
- Preserves original formatting
- Often already **single-line**, depending on the backend
- Recommended for:
  - Splunk
  - Microsoft Sentinel (KQL)
  - Elastic EQL
  - RSA NetWitness

### ğŸ”¹ `one-line/` â€“ Single-Line Safety Variant
- Generated by collapsing all line breaks into spaces
- Intended for engines that **require a single-line query string**
- Typical use cases:
  - OpenSearch / Elasticsearch `query_string`
  - Lucene-only engines
  - Custom / legacy SIEM parsers

### â„¹ï¸ Important Note
For many Sigma backends (Splunk, KQL, Lucene), the `raw/` output is **already single-line**.  
In these cases, `raw/` and `one-line/` files may appear **identical**. This is expected and normal.

The `one-line/` directory exists as a **defensive design choice** to ensure future compatibility with backends or pipelines that emit multi-line queries.

**Rule of thumb for SOC analysts:**
- If your SIEM accepts multi-line queries â†’ use `raw/`
- If your SIEM requires a strict single-line query â†’ use `one-line/`

